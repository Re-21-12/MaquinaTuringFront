import{b as Ab,c as Nb,g as kb}from"./chunk-2NTHAA6U.js";import{a as fb,b as mb,c as pb,d as us,f as gb,g as wb,h as bb,i as Cb,j as si,l as vb,m as yb,n as Sb,o as Rb,p as Tb,q as xb,r as Eb,s as _b,t as Ob,u as Mb,v as Fh,w as Ib,x as Hb}from"./chunk-D4I6RR77.js";import{c as Pb,e as Db,h as Lb,i as Fb}from"./chunk-FZWX4IFG.js";import{a as xc}from"./chunk-TPWMYLWP.js";import{a as Dh}from"./chunk-HLIJYPCT.js";import{D as Sa,I as Lh,M as ub,N as db,O as hb,c as ab,p as lb,z as cb}from"./chunk-UKYACQUO.js";import{d as nb,j as sb,q as Vh,r as Wh,t as Ra,u as Ta,v as Bh}from"./chunk-JTWP7N5S.js";import{$ as Ei,$a as Zw,Bb as ii,C as qw,Cb as rb,D as wa,Eb as Nr,Fa as ba,Gb as Ve,Hb as ya,Ib as ni,J as Gw,Jb as Ii,Kb as ob,Lb as Io,Mb as so,Nb as ao,Qb as ib,Rb as lt,Sb as Hi,Ta as Ee,Tb as cs,U as $w,Ua as De,Wa as Qw,Xb as Ho,Yb as mn,Z as Kw,_ as Nh,a as pe,b as je,ba as _i,c as jw,d as kt,db as Ph,e as H,ea as kh,f as wI,fb as hn,fc as pn,g as S,ga as ti,h as zw,ha as Oi,hc as Br,i as Cc,ia as as,ib as oi,ic as Tc,mb as ls,n as Ah,na as ri,nb as Le,oa as wr,ob as Jw,p as Yw,pa as br,pb as fn,qa as vc,qb as eb,ra as Xw,rb as Mi,ta as yc,tb,ub as Ca,vb as va,wa as Tr,wb as ce,xa as Sc,xb as we,yb as zt,za as Rc}from"./chunk-M7DIKWBA.js";var Pt=H((Yh,eC)=>{"use strict";var xa=function(r){return r&&r.Math===Math&&r};eC.exports=xa(typeof globalThis=="object"&&globalThis)||xa(typeof window=="object"&&window)||xa(typeof self=="object"&&self)||xa(typeof global=="object"&&global)||xa(typeof Yh=="object"&&Yh)||function(){return this}()||Function("return this")()});var Cr=H((hj,tC)=>{"use strict";tC.exports=function(r){try{return!!r()}catch{return!0}}});var lo=H((fj,rC)=>{"use strict";var WI=Cr();rC.exports=!WI(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var Ea=H((mj,oC)=>{"use strict";var BI=Cr();oC.exports=!BI(function(){var r=function(){}.bind();return typeof r!="function"||r.hasOwnProperty("prototype")})});var Ao=H((pj,iC)=>{"use strict";var UI=Ea(),Oc=Function.prototype.call;iC.exports=UI?Oc.bind(Oc):function(){return Oc.apply(Oc,arguments)}});var lC=H(aC=>{"use strict";var nC={}.propertyIsEnumerable,sC=Object.getOwnPropertyDescriptor,jI=sC&&!nC.call({1:2},1);aC.f=jI?function(e){var t=sC(this,e);return!!t&&t.enumerable}:nC});var Mc=H((wj,cC)=>{"use strict";cC.exports=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}}});var ft=H((bj,hC)=>{"use strict";var uC=Ea(),dC=Function.prototype,qh=dC.call,zI=uC&&dC.bind.bind(qh,qh);hC.exports=uC?zI:function(r){return function(){return qh.apply(r,arguments)}}});var Ai=H((Cj,mC)=>{"use strict";var fC=ft(),YI=fC({}.toString),qI=fC("".slice);mC.exports=function(r){return qI(YI(r),8,-1)}});var gC=H((vj,pC)=>{"use strict";var GI=ft(),$I=Cr(),KI=Ai(),Gh=Object,XI=GI("".split);pC.exports=$I(function(){return!Gh("z").propertyIsEnumerable(0)})?function(r){return KI(r)==="String"?XI(r,""):Gh(r)}:Gh});var Ic=H((yj,wC)=>{"use strict";wC.exports=function(r){return r==null}});var ds=H((Sj,bC)=>{"use strict";var QI=Ic(),ZI=TypeError;bC.exports=function(r){if(QI(r))throw new ZI("Can't call method on "+r);return r}});var _a=H((Rj,CC)=>{"use strict";var JI=gC(),eH=ds();CC.exports=function(r){return JI(eH(r))}});var Dt=H((Tj,vC)=>{"use strict";var $h=typeof document=="object"&&document.all;vC.exports=typeof $h>"u"&&$h!==void 0?function(r){return typeof r=="function"||r===$h}:function(r){return typeof r=="function"}});var co=H((xj,yC)=>{"use strict";var tH=Dt();yC.exports=function(r){return typeof r=="object"?r!==null:tH(r)}});var gn=H((Ej,SC)=>{"use strict";var Kh=Pt(),rH=Dt(),oH=function(r){return rH(r)?r:void 0};SC.exports=function(r,e){return arguments.length<2?oH(Kh[r]):Kh[r]&&Kh[r][e]}});var Hc=H((_j,RC)=>{"use strict";var iH=ft();RC.exports=iH({}.isPrototypeOf)});var Oa=H((Oj,EC)=>{"use strict";var nH=Pt(),TC=nH.navigator,xC=TC&&TC.userAgent;EC.exports=xC?String(xC):""});var NC=H((Mj,AC)=>{"use strict";var HC=Pt(),Xh=Oa(),_C=HC.process,OC=HC.Deno,MC=_C&&_C.versions||OC&&OC.version,IC=MC&&MC.v8,uo,Ac;IC&&(uo=IC.split("."),Ac=uo[0]>0&&uo[0]<4?1:+(uo[0]+uo[1]));!Ac&&Xh&&(uo=Xh.match(/Edge\/(\d+)/),(!uo||uo[1]>=74)&&(uo=Xh.match(/Chrome\/(\d+)/),uo&&(Ac=+uo[1])));AC.exports=Ac});var Nc=H((Ij,PC)=>{"use strict";var kC=NC(),sH=Cr(),aH=Pt(),lH=aH.String;PC.exports=!!Object.getOwnPropertySymbols&&!sH(function(){var r=Symbol("symbol detection");return!lH(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&kC&&kC<41})});var Qh=H((Hj,DC)=>{"use strict";var cH=Nc();DC.exports=cH&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var kc=H((Aj,LC)=>{"use strict";var uH=gn(),dH=Dt(),hH=Hc(),fH=Qh(),mH=Object;LC.exports=fH?function(r){return typeof r=="symbol"}:function(r){var e=uH("Symbol");return dH(e)&&hH(e.prototype,mH(r))}});var VC=H((Nj,FC)=>{"use strict";var pH=String;FC.exports=function(r){try{return pH(r)}catch{return"Object"}}});var Ma=H((kj,WC)=>{"use strict";var gH=Dt(),wH=VC(),bH=TypeError;WC.exports=function(r){if(gH(r))return r;throw new bH(wH(r)+" is not a function")}});var Pc=H((Pj,BC)=>{"use strict";var CH=Ma(),vH=Ic();BC.exports=function(r,e){var t=r[e];return vH(t)?void 0:CH(t)}});var jC=H((Dj,UC)=>{"use strict";var Zh=Ao(),Jh=Dt(),ef=co(),yH=TypeError;UC.exports=function(r,e){var t,o;if(e==="string"&&Jh(t=r.toString)&&!ef(o=Zh(t,r))||Jh(t=r.valueOf)&&!ef(o=Zh(t,r))||e!=="string"&&Jh(t=r.toString)&&!ef(o=Zh(t,r)))return o;throw new yH("Can't convert object to primitive value")}});var Dc=H((Lj,zC)=>{"use strict";zC.exports=!1});var Lc=H((Fj,qC)=>{"use strict";var YC=Pt(),SH=Object.defineProperty;qC.exports=function(r,e){try{SH(YC,r,{value:e,configurable:!0,writable:!0})}catch{YC[r]=e}return e}});var Fc=H((Vj,KC)=>{"use strict";var RH=Dc(),TH=Pt(),xH=Lc(),GC="__core-js_shared__",$C=KC.exports=TH[GC]||xH(GC,{});($C.versions||($C.versions=[])).push({version:"3.38.1",mode:RH?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var tf=H((Wj,QC)=>{"use strict";var XC=Fc();QC.exports=function(r,e){return XC[r]||(XC[r]=e||{})}});var Ia=H((Bj,ZC)=>{"use strict";var EH=ds(),_H=Object;ZC.exports=function(r){return _H(EH(r))}});var ho=H((Uj,JC)=>{"use strict";var OH=ft(),MH=Ia(),IH=OH({}.hasOwnProperty);JC.exports=Object.hasOwn||function(e,t){return IH(MH(e),t)}});var rf=H((jj,ev)=>{"use strict";var HH=ft(),AH=0,NH=Math.random(),kH=HH(1 .toString);ev.exports=function(r){return"Symbol("+(r===void 0?"":r)+")_"+kH(++AH+NH,36)}});var wn=H((zj,rv)=>{"use strict";var PH=Pt(),DH=tf(),tv=ho(),LH=rf(),FH=Nc(),VH=Qh(),hs=PH.Symbol,of=DH("wks"),WH=VH?hs.for||hs:hs&&hs.withoutSetter||LH;rv.exports=function(r){return tv(of,r)||(of[r]=FH&&tv(hs,r)?hs[r]:WH("Symbol."+r)),of[r]}});var sv=H((Yj,nv)=>{"use strict";var BH=Ao(),ov=co(),iv=kc(),UH=Pc(),jH=jC(),zH=wn(),YH=TypeError,qH=zH("toPrimitive");nv.exports=function(r,e){if(!ov(r)||iv(r))return r;var t=UH(r,qH),o;if(t){if(e===void 0&&(e="default"),o=BH(t,r,e),!ov(o)||iv(o))return o;throw new YH("Can't convert object to primitive value")}return e===void 0&&(e="number"),jH(r,e)}});var nf=H((qj,av)=>{"use strict";var GH=sv(),$H=kc();av.exports=function(r){var e=GH(r,"string");return $H(e)?e:e+""}});var Vc=H((Gj,cv)=>{"use strict";var KH=Pt(),lv=co(),sf=KH.document,XH=lv(sf)&&lv(sf.createElement);cv.exports=function(r){return XH?sf.createElement(r):{}}});var af=H(($j,uv)=>{"use strict";var QH=lo(),ZH=Cr(),JH=Vc();uv.exports=!QH&&!ZH(function(){return Object.defineProperty(JH("div"),"a",{get:function(){return 7}}).a!==7})});var lf=H(hv=>{"use strict";var eA=lo(),tA=Ao(),rA=lC(),oA=Mc(),iA=_a(),nA=nf(),sA=ho(),aA=af(),dv=Object.getOwnPropertyDescriptor;hv.f=eA?dv:function(e,t){if(e=iA(e),t=nA(t),aA)try{return dv(e,t)}catch{}if(sA(e,t))return oA(!tA(rA.f,e,t),e[t])}});var cf=H((Xj,fv)=>{"use strict";var lA=lo(),cA=Cr();fv.exports=lA&&cA(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var Ni=H((Qj,mv)=>{"use strict";var uA=co(),dA=String,hA=TypeError;mv.exports=function(r){if(uA(r))return r;throw new hA(dA(r)+" is not an object")}});var bn=H(gv=>{"use strict";var fA=lo(),mA=af(),pA=cf(),Wc=Ni(),pv=nf(),gA=TypeError,uf=Object.defineProperty,wA=Object.getOwnPropertyDescriptor,df="enumerable",hf="configurable",ff="writable";gv.f=fA?pA?function(e,t,o){if(Wc(e),t=pv(t),Wc(o),typeof e=="function"&&t==="prototype"&&"value"in o&&ff in o&&!o[ff]){var n=wA(e,t);n&&n[ff]&&(e[t]=o.value,o={configurable:hf in o?o[hf]:n[hf],enumerable:df in o?o[df]:n[df],writable:!1})}return uf(e,t,o)}:uf:function(e,t,o){if(Wc(e),t=pv(t),Wc(o),mA)try{return uf(e,t,o)}catch{}if("get"in o||"set"in o)throw new gA("Accessors not supported");return"value"in o&&(e[t]=o.value),e}});var fs=H((Jj,wv)=>{"use strict";var bA=lo(),CA=bn(),vA=Mc();wv.exports=bA?function(r,e,t){return CA.f(r,e,vA(1,t))}:function(r,e,t){return r[e]=t,r}});var vv=H((ez,Cv)=>{"use strict";var mf=lo(),yA=ho(),bv=Function.prototype,SA=mf&&Object.getOwnPropertyDescriptor,pf=yA(bv,"name"),RA=pf&&function(){}.name==="something",TA=pf&&(!mf||mf&&SA(bv,"name").configurable);Cv.exports={EXISTS:pf,PROPER:RA,CONFIGURABLE:TA}});var Sv=H((tz,yv)=>{"use strict";var xA=ft(),EA=Dt(),gf=Fc(),_A=xA(Function.toString);EA(gf.inspectSource)||(gf.inspectSource=function(r){return _A(r)});yv.exports=gf.inspectSource});var xv=H((rz,Tv)=>{"use strict";var OA=Pt(),MA=Dt(),Rv=OA.WeakMap;Tv.exports=MA(Rv)&&/native code/.test(String(Rv))});var wf=H((oz,_v)=>{"use strict";var IA=tf(),HA=rf(),Ev=IA("keys");_v.exports=function(r){return Ev[r]||(Ev[r]=HA(r))}});var Bc=H((iz,Ov)=>{"use strict";Ov.exports={}});var Av=H((nz,Hv)=>{"use strict";var AA=xv(),Iv=Pt(),NA=co(),kA=fs(),bf=ho(),Cf=Fc(),PA=wf(),DA=Bc(),Mv="Object already initialized",vf=Iv.TypeError,LA=Iv.WeakMap,Uc,Ha,jc,FA=function(r){return jc(r)?Ha(r):Uc(r,{})},VA=function(r){return function(e){var t;if(!NA(e)||(t=Ha(e)).type!==r)throw new vf("Incompatible receiver, "+r+" required");return t}};AA||Cf.state?(fo=Cf.state||(Cf.state=new LA),fo.get=fo.get,fo.has=fo.has,fo.set=fo.set,Uc=function(r,e){if(fo.has(r))throw new vf(Mv);return e.facade=r,fo.set(r,e),e},Ha=function(r){return fo.get(r)||{}},jc=function(r){return fo.has(r)}):(Cn=PA("state"),DA[Cn]=!0,Uc=function(r,e){if(bf(r,Cn))throw new vf(Mv);return e.facade=r,kA(r,Cn,e),e},Ha=function(r){return bf(r,Cn)?r[Cn]:{}},jc=function(r){return bf(r,Cn)});var fo,Cn;Hv.exports={set:Uc,get:Ha,has:jc,enforce:FA,getterFor:VA}});var Dv=H((sz,Pv)=>{"use strict";var Sf=ft(),WA=Cr(),BA=Dt(),zc=ho(),yf=lo(),UA=vv().CONFIGURABLE,jA=Sv(),kv=Av(),zA=kv.enforce,YA=kv.get,Nv=String,Yc=Object.defineProperty,qA=Sf("".slice),GA=Sf("".replace),$A=Sf([].join),KA=yf&&!WA(function(){return Yc(function(){},"length",{value:8}).length!==8}),XA=String(String).split("String"),QA=Pv.exports=function(r,e,t){qA(Nv(e),0,7)==="Symbol("&&(e="["+GA(Nv(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!zc(r,"name")||UA&&r.name!==e)&&(yf?Yc(r,"name",{value:e,configurable:!0}):r.name=e),KA&&t&&zc(t,"arity")&&r.length!==t.arity&&Yc(r,"length",{value:t.arity});try{t&&zc(t,"constructor")&&t.constructor?yf&&Yc(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var o=zA(r);return zc(o,"source")||(o.source=$A(XA,typeof e=="string"?e:"")),r};Function.prototype.toString=QA(function(){return BA(this)&&YA(this).source||jA(this)},"toString")});var Fv=H((az,Lv)=>{"use strict";var ZA=Dt(),JA=bn(),eN=Dv(),tN=Lc();Lv.exports=function(r,e,t,o){o||(o={});var n=o.enumerable,i=o.name!==void 0?o.name:e;if(ZA(t)&&eN(t,i,o),o.global)n?r[e]=t:tN(e,t);else{try{o.unsafe?r[e]&&(n=!0):delete r[e]}catch{}n?r[e]=t:JA.f(r,e,{value:t,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return r}});var Wv=H((lz,Vv)=>{"use strict";var rN=Math.ceil,oN=Math.floor;Vv.exports=Math.trunc||function(e){var t=+e;return(t>0?oN:rN)(t)}});var ms=H((cz,Bv)=>{"use strict";var iN=Wv();Bv.exports=function(r){var e=+r;return e!==e||e===0?0:iN(e)}});var jv=H((uz,Uv)=>{"use strict";var nN=ms(),sN=Math.max,aN=Math.min;Uv.exports=function(r,e){var t=nN(r);return t<0?sN(t+e,0):aN(t,e)}});var Yv=H((dz,zv)=>{"use strict";var lN=ms(),cN=Math.min;zv.exports=function(r){var e=lN(r);return e>0?cN(e,9007199254740991):0}});var qc=H((hz,qv)=>{"use strict";var uN=Yv();qv.exports=function(r){return uN(r.length)}});var Kv=H((fz,$v)=>{"use strict";var dN=_a(),hN=jv(),fN=qc(),Gv=function(r){return function(e,t,o){var n=dN(e),i=fN(n);if(i===0)return!r&&-1;var a=hN(o,i),c;if(r&&t!==t){for(;i>a;)if(c=n[a++],c!==c)return!0}else for(;i>a;a++)if((r||a in n)&&n[a]===t)return r||a||0;return!r&&-1}};$v.exports={includes:Gv(!0),indexOf:Gv(!1)}});var Tf=H((mz,Qv)=>{"use strict";var mN=ft(),Rf=ho(),pN=_a(),gN=Kv().indexOf,wN=Bc(),Xv=mN([].push);Qv.exports=function(r,e){var t=pN(r),o=0,n=[],i;for(i in t)!Rf(wN,i)&&Rf(t,i)&&Xv(n,i);for(;e.length>o;)Rf(t,i=e[o++])&&(~gN(n,i)||Xv(n,i));return n}});var Gc=H((pz,Zv)=>{"use strict";Zv.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var ey=H(Jv=>{"use strict";var bN=Tf(),CN=Gc(),vN=CN.concat("length","prototype");Jv.f=Object.getOwnPropertyNames||function(e){return bN(e,vN)}});var ry=H(ty=>{"use strict";ty.f=Object.getOwnPropertySymbols});var iy=H((bz,oy)=>{"use strict";var yN=gn(),SN=ft(),RN=ey(),TN=ry(),xN=Ni(),EN=SN([].concat);oy.exports=yN("Reflect","ownKeys")||function(e){var t=RN.f(xN(e)),o=TN.f;return o?EN(t,o(e)):t}});var xf=H((Cz,sy)=>{"use strict";var ny=ho(),_N=iy(),ON=lf(),MN=bn();sy.exports=function(r,e,t){for(var o=_N(e),n=MN.f,i=ON.f,a=0;a<o.length;a++){var c=o[a];!ny(r,c)&&!(t&&ny(t,c))&&n(r,c,i(e,c))}}});var ly=H((vz,ay)=>{"use strict";var IN=Cr(),HN=Dt(),AN=/#|\.prototype\./,Aa=function(r,e){var t=kN[NN(r)];return t===DN?!0:t===PN?!1:HN(e)?IN(e):!!e},NN=Aa.normalize=function(r){return String(r).replace(AN,".").toLowerCase()},kN=Aa.data={},PN=Aa.NATIVE="N",DN=Aa.POLYFILL="P";ay.exports=Aa});var er=H((yz,cy)=>{"use strict";var $c=Pt(),LN=lf().f,FN=fs(),VN=Fv(),WN=Lc(),BN=xf(),UN=ly();cy.exports=function(r,e){var t=r.target,o=r.global,n=r.stat,i,a,c,u,m,g;if(o?a=$c:n?a=$c[t]||WN(t,{}):a=$c[t]&&$c[t].prototype,a)for(c in e){if(m=e[c],r.dontCallGetSet?(g=LN(a,c),u=g&&g.value):u=a[c],i=UN(o?c:t+(n?".":"#")+c,r.forced),!i&&u!==void 0){if(typeof m==typeof u)continue;BN(m,u)}(r.sham||u&&u.sham)&&FN(m,"sham",!0),VN(a,c,m,r)}}});var Na=H((Sz,fy)=>{"use strict";var jN=Ea(),hy=Function.prototype,uy=hy.apply,dy=hy.call;fy.exports=typeof Reflect=="object"&&Reflect.apply||(jN?dy.bind(uy):function(){return dy.apply(uy,arguments)})});var Ef=H((Rz,my)=>{"use strict";var zN=ft(),YN=Ma();my.exports=function(r,e,t){try{return zN(YN(Object.getOwnPropertyDescriptor(r,e)[t]))}catch{}}});var gy=H((Tz,py)=>{"use strict";var qN=co();py.exports=function(r){return qN(r)||r===null}});var by=H((xz,wy)=>{"use strict";var GN=gy(),$N=String,KN=TypeError;wy.exports=function(r){if(GN(r))return r;throw new KN("Can't set "+$N(r)+" as a prototype")}});var _f=H((Ez,Cy)=>{"use strict";var XN=Ef(),QN=co(),ZN=ds(),JN=by();Cy.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,e={},t;try{t=XN(Object.prototype,"__proto__","set"),t(e,[]),r=e instanceof Array}catch{}return function(n,i){return ZN(n),JN(i),QN(n)&&(r?t(n,i):n.__proto__=i),n}}():void 0)});var yy=H((_z,vy)=>{"use strict";var ek=bn().f;vy.exports=function(r,e,t){t in r||ek(r,t,{configurable:!0,get:function(){return e[t]},set:function(o){e[t]=o}})}});var Ty=H((Oz,Ry)=>{"use strict";var tk=Dt(),rk=co(),Sy=_f();Ry.exports=function(r,e,t){var o,n;return Sy&&tk(o=e.constructor)&&o!==t&&rk(n=o.prototype)&&n!==t.prototype&&Sy(r,n),r}});var _y=H((Mz,Ey)=>{"use strict";var ok=wn(),ik=ok("toStringTag"),xy={};xy[ik]="z";Ey.exports=String(xy)==="[object z]"});var My=H((Iz,Oy)=>{"use strict";var nk=_y(),sk=Dt(),Kc=Ai(),ak=wn(),lk=ak("toStringTag"),ck=Object,uk=Kc(function(){return arguments}())==="Arguments",dk=function(r,e){try{return r[e]}catch{}};Oy.exports=nk?Kc:function(r){var e,t,o;return r===void 0?"Undefined":r===null?"Null":typeof(t=dk(e=ck(r),lk))=="string"?t:uk?Kc(e):(o=Kc(e))==="Object"&&sk(e.callee)?"Arguments":o}});var ka=H((Hz,Iy)=>{"use strict";var hk=My(),fk=String;Iy.exports=function(r){if(hk(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return fk(r)}});var Ay=H((Az,Hy)=>{"use strict";var mk=ka();Hy.exports=function(r,e){return r===void 0?arguments.length<2?"":e:mk(r)}});var ky=H((Nz,Ny)=>{"use strict";var pk=co(),gk=fs();Ny.exports=function(r,e){pk(e)&&"cause"in e&&gk(r,"cause",e.cause)}});var Fy=H((kz,Ly)=>{"use strict";var wk=ft(),Py=Error,bk=wk("".replace),Ck=function(r){return String(new Py(r).stack)}("zxcasd"),Dy=/\n\s*at [^:]*:[^\n]*/,vk=Dy.test(Ck);Ly.exports=function(r,e){if(vk&&typeof r=="string"&&!Py.prepareStackTrace)for(;e--;)r=bk(r,Dy,"");return r}});var Wy=H((Pz,Vy)=>{"use strict";var yk=Cr(),Sk=Mc();Vy.exports=!yk(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",Sk(1,7)),r.stack!==7):!0})});var jy=H((Dz,Uy)=>{"use strict";var Rk=fs(),Tk=Fy(),xk=Wy(),By=Error.captureStackTrace;Uy.exports=function(r,e,t,o){xk&&(By?By(r,e):Rk(r,"stack",Tk(t,o)))}});var Qy=H((Lz,Xy)=>{"use strict";var zy=gn(),Ek=ho(),Yy=fs(),_k=Hc(),qy=_f(),Gy=xf(),$y=yy(),Ok=Ty(),Mk=Ay(),Ik=ky(),Hk=jy(),Ak=lo(),Ky=Dc();Xy.exports=function(r,e,t,o){var n="stackTraceLimit",i=o?2:1,a=r.split("."),c=a[a.length-1],u=zy.apply(null,a);if(u){var m=u.prototype;if(!Ky&&Ek(m,"cause")&&delete m.cause,!t)return u;var g=zy("Error"),C=e(function(v,y){var R=Mk(o?y:v,void 0),O=o?new u(v):new u;return R!==void 0&&Yy(O,"message",R),Hk(O,C,O.stack,2),this&&_k(m,this)&&Ok(O,this,C),arguments.length>i&&Ik(O,arguments[i]),O});if(C.prototype=m,c!=="Error"?qy?qy(C,g):Gy(C,g,{name:!0}):Ak&&n in u&&($y(C,u,n),$y(C,u,"prepareStackTrace")),Gy(C,u),!Ky)try{m.name!==c&&Yy(m,"name",c),m.constructor=C}catch{}return C}}});var V=H(()=>{"use strict";var Jy=er(),Nk=Pt(),No=Na(),eS=Qy(),Of="WebAssembly",Zy=Nk[Of],Xc=new Error("e",{cause:7}).cause!==7,vn=function(r,e){var t={};t[r]=eS(r,e,Xc),Jy({global:!0,constructor:!0,arity:1,forced:Xc},t)},Mf=function(r,e){if(Zy&&Zy[r]){var t={};t[r]=eS(Of+"."+r,e,Xc),Jy({target:Of,stat:!0,constructor:!0,arity:1,forced:Xc},t)}};vn("Error",function(r){return function(t){return No(r,this,arguments)}});vn("EvalError",function(r){return function(t){return No(r,this,arguments)}});vn("RangeError",function(r){return function(t){return No(r,this,arguments)}});vn("ReferenceError",function(r){return function(t){return No(r,this,arguments)}});vn("SyntaxError",function(r){return function(t){return No(r,this,arguments)}});vn("TypeError",function(r){return function(t){return No(r,this,arguments)}});vn("URIError",function(r){return function(t){return No(r,this,arguments)}});Mf("CompileError",function(r){return function(t){return No(r,this,arguments)}});Mf("LinkError",function(r){return function(t){return No(r,this,arguments)}});Mf("RuntimeError",function(r){return function(t){return No(r,this,arguments)}})});var If=H((Wz,tS)=>{"use strict";var kk=Ai();tS.exports=Array.isArray||function(e){return kk(e)==="Array"}});var oS=H((Bz,rS)=>{"use strict";var Pk=lo(),Dk=If(),Lk=TypeError,Fk=Object.getOwnPropertyDescriptor,Vk=Pk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(r){return r instanceof TypeError}}();rS.exports=Vk?function(r,e){if(Dk(r)&&!Fk(r,"length").writable)throw new Lk("Cannot set read only .length");return r.length=e}:function(r,e){return r.length=e}});var nS=H((Uz,iS)=>{"use strict";var Wk=TypeError,Bk=9007199254740991;iS.exports=function(r){if(r>Bk)throw Wk("Maximum allowed index exceeded");return r}});var me=H(()=>{"use strict";var Uk=er(),jk=Ia(),zk=qc(),Yk=oS(),qk=nS(),Gk=Cr(),$k=Gk(function(){return[].push.call({length:4294967296},1)!==4294967297}),Kk=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(r){return r instanceof TypeError}},Xk=$k||!Kk();Uk({target:"Array",proto:!0,arity:1,forced:Xk},{push:function(e){var t=jk(this),o=zk(t),n=arguments.length;qk(o+n);for(var i=0;i<n;i++)t[o]=arguments[i],o++;return Yk(t,o),o}})});var mo=H((Yz,sS)=>{"use strict";var Hf=ft(),Qc=Set.prototype;sS.exports={Set,add:Hf(Qc.add),has:Hf(Qc.has),remove:Hf(Qc.delete),proto:Qc}});var ki=H((qz,aS)=>{"use strict";var Qk=mo().has;aS.exports=function(r){return Qk(r),r}});var Pi=H((Gz,lS)=>{"use strict";var Zk=Ao();lS.exports=function(r,e,t){for(var o=t?r:r.iterator,n=r.next,i,a;!(i=Zk(n,o)).done;)if(a=e(i.value),a!==void 0)return a}});var ps=H(($z,fS)=>{"use strict";var cS=ft(),Jk=Pi(),uS=mo(),eP=uS.Set,dS=uS.proto,tP=cS(dS.forEach),hS=cS(dS.keys),rP=hS(new eP).next;fS.exports=function(r,e,t){return t?Jk({iterator:hS(r),next:rP},e):tP(r,e)}});var Zc=H((Kz,pS)=>{"use strict";var mS=mo(),oP=ps(),iP=mS.Set,nP=mS.add;pS.exports=function(r){var e=new iP;return oP(r,function(t){nP(e,t)}),e}});var gs=H((Xz,gS)=>{"use strict";var sP=Ef(),aP=mo();gS.exports=sP(aP.proto,"size","get")||function(r){return r.size}});var bS=H((Qz,wS)=>{"use strict";wS.exports=function(r){return{iterator:r,next:r.next,done:!1}}});var Di=H((Zz,TS)=>{"use strict";var CS=Ma(),SS=Ni(),vS=Ao(),lP=ms(),cP=bS(),yS="Invalid size",uP=RangeError,dP=TypeError,hP=Math.max,RS=function(r,e){this.set=r,this.size=hP(e,0),this.has=CS(r.has),this.keys=CS(r.keys)};RS.prototype={getIterator:function(){return cP(SS(vS(this.keys,this.set)))},includes:function(r){return vS(this.has,this.set,r)}};TS.exports=function(r){SS(r);var e=+r.size;if(e!==e)throw new dP(yS);var t=lP(e);if(t<0)throw new uP(yS);return new RS(r,t)}});var OS=H((Jz,_S)=>{"use strict";var fP=ki(),ES=mo(),mP=Zc(),pP=gs(),gP=Di(),wP=ps(),bP=Pi(),CP=ES.has,xS=ES.remove;_S.exports=function(e){var t=fP(this),o=gP(e),n=mP(t);return pP(t)<=o.size?wP(t,function(i){o.includes(i)&&xS(n,i)}):bP(o.getIterator(),function(i){CP(t,i)&&xS(n,i)}),n}});var Li=H((e2,IS)=>{"use strict";var vP=gn(),MS=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};IS.exports=function(r){var e=vP("Set");try{new e()[r](MS(0));try{return new e()[r](MS(-1)),!1}catch{return!0}}catch{return!1}}});var tr=H(()=>{"use strict";var yP=er(),SP=OS(),RP=Li();yP({target:"Set",proto:!0,real:!0,forced:!RP("difference")},{difference:SP})});var NS=H((o2,AS)=>{"use strict";var TP=ki(),Af=mo(),xP=gs(),EP=Di(),_P=ps(),OP=Pi(),MP=Af.Set,HS=Af.add,IP=Af.has;AS.exports=function(e){var t=TP(this),o=EP(e),n=new MP;return xP(t)>o.size?OP(o.getIterator(),function(i){IP(t,i)&&HS(n,i)}):_P(t,function(i){o.includes(i)&&HS(n,i)}),n}});var rr=H(()=>{"use strict";var HP=er(),AP=Cr(),NP=NS(),kP=Li(),PP=!kP("intersection")||AP(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});HP({target:"Set",proto:!0,real:!0,forced:PP},{intersection:NP})});var Nf=H((s2,PS)=>{"use strict";var DP=Ao(),kS=Ni(),LP=Pc();PS.exports=function(r,e,t){var o,n;kS(r);try{if(o=LP(r,"return"),!o){if(e==="throw")throw t;return t}o=DP(o,r)}catch(i){n=!0,o=i}if(e==="throw")throw t;if(n)throw o;return kS(o),t}});var LS=H((a2,DS)=>{"use strict";var FP=ki(),VP=mo().has,WP=gs(),BP=Di(),UP=ps(),jP=Pi(),zP=Nf();DS.exports=function(e){var t=FP(this),o=BP(e);if(WP(t)<=o.size)return UP(t,function(i){if(o.includes(i))return!1},!0)!==!1;var n=o.getIterator();return jP(n,function(i){if(VP(t,i))return zP(n,"normal",!1)})!==!1}});var or=H(()=>{"use strict";var YP=er(),qP=LS(),GP=Li();YP({target:"Set",proto:!0,real:!0,forced:!GP("isDisjointFrom")},{isDisjointFrom:qP})});var VS=H((u2,FS)=>{"use strict";var $P=ki(),KP=gs(),XP=ps(),QP=Di();FS.exports=function(e){var t=$P(this),o=QP(e);return KP(t)>o.size?!1:XP(t,function(n){if(!o.includes(n))return!1},!0)!==!1}});var ir=H(()=>{"use strict";var ZP=er(),JP=VS(),e1=Li();ZP({target:"Set",proto:!0,real:!0,forced:!e1("isSubsetOf")},{isSubsetOf:JP})});var BS=H((f2,WS)=>{"use strict";var t1=ki(),r1=mo().has,o1=gs(),i1=Di(),n1=Pi(),s1=Nf();WS.exports=function(e){var t=t1(this),o=i1(e);if(o1(t)<o.size)return!1;var n=o.getIterator();return n1(n,function(i){if(!r1(t,i))return s1(n,"normal",!1)})!==!1}});var nr=H(()=>{"use strict";var a1=er(),l1=BS(),c1=Li();a1({target:"Set",proto:!0,real:!0,forced:!c1("isSupersetOf")},{isSupersetOf:l1})});var jS=H((g2,US)=>{"use strict";var u1=ki(),kf=mo(),d1=Zc(),h1=Di(),f1=Pi(),m1=kf.add,p1=kf.has,g1=kf.remove;US.exports=function(e){var t=u1(this),o=h1(e).getIterator(),n=d1(t);return f1(o,function(i){p1(t,i)?g1(n,i):m1(n,i)}),n}});var sr=H(()=>{"use strict";var w1=er(),b1=jS(),C1=Li();w1({target:"Set",proto:!0,real:!0,forced:!C1("symmetricDifference")},{symmetricDifference:b1})});var YS=H((C2,zS)=>{"use strict";var v1=ki(),y1=mo().add,S1=Zc(),R1=Di(),T1=Pi();zS.exports=function(e){var t=v1(this),o=R1(e).getIterator(),n=S1(t);return T1(o,function(i){y1(n,i)}),n}});var ar=H(()=>{"use strict";var x1=er(),E1=YS(),_1=Li();x1({target:"Set",proto:!0,real:!0,forced:!_1("union")},{union:E1})});var GS=H((S2,qS)=>{"use strict";var O1=Ai(),M1=ft();qS.exports=function(r){if(O1(r)==="Function")return M1(r)}});var XS=H((R2,KS)=>{"use strict";var $S=GS(),I1=Ma(),H1=Ea(),A1=$S($S.bind);KS.exports=function(r,e){return I1(r),e===void 0?r:H1?A1(r,e):function(){return r.apply(e,arguments)}}});var Pf=H((T2,QS)=>{"use strict";var N1=gn();QS.exports=N1("document","documentElement")});var Jc=H((x2,ZS)=>{"use strict";var k1=ft();ZS.exports=k1([].slice)});var Df=H((E2,JS)=>{"use strict";var P1=TypeError;JS.exports=function(r,e){if(r<e)throw new P1("Not enough arguments");return r}});var tR=H((_2,eR)=>{"use strict";var D1=Oa();eR.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(D1)});var Lf=H((O2,rR)=>{"use strict";var Pa=Pt(),L1=Oa(),F1=Ai(),eu=function(r){return L1.slice(0,r.length)===r};rR.exports=function(){return eu("Bun/")?"BUN":eu("Cloudflare-Workers")?"CLOUDFLARE":eu("Deno/")?"DENO":eu("Node.js/")?"NODE":Pa.Bun&&typeof Bun.version=="string"?"BUN":Pa.Deno&&typeof Deno.version=="object"?"DENO":F1(Pa.process)==="process"?"NODE":Pa.window&&Pa.document?"BROWSER":"REST"}()});var iR=H((M2,oR)=>{"use strict";var V1=Lf();oR.exports=V1==="NODE"});var qf=H((I2,fR)=>{"use strict";var kr=Pt(),W1=Na(),B1=XS(),nR=Dt(),U1=ho(),hR=Cr(),sR=Pf(),j1=Jc(),aR=Vc(),z1=Df(),Y1=tR(),q1=iR(),jf=kr.setImmediate,zf=kr.clearImmediate,G1=kr.process,Ff=kr.Dispatch,$1=kr.Function,lR=kr.MessageChannel,K1=kr.String,Vf=0,Da={},cR="onreadystatechange",La,yn,Wf,Bf;hR(function(){La=kr.location});var Yf=function(r){if(U1(Da,r)){var e=Da[r];delete Da[r],e()}},Uf=function(r){return function(){Yf(r)}},uR=function(r){Yf(r.data)},dR=function(r){kr.postMessage(K1(r),La.protocol+"//"+La.host)};(!jf||!zf)&&(jf=function(e){z1(arguments.length,1);var t=nR(e)?e:$1(e),o=j1(arguments,1);return Da[++Vf]=function(){W1(t,void 0,o)},yn(Vf),Vf},zf=function(e){delete Da[e]},q1?yn=function(r){G1.nextTick(Uf(r))}:Ff&&Ff.now?yn=function(r){Ff.now(Uf(r))}:lR&&!Y1?(Wf=new lR,Bf=Wf.port2,Wf.port1.onmessage=uR,yn=B1(Bf.postMessage,Bf)):kr.addEventListener&&nR(kr.postMessage)&&!kr.importScripts&&La&&La.protocol!=="file:"&&!hR(dR)?(yn=dR,kr.addEventListener("message",uR,!1)):cR in aR("script")?yn=function(r){sR.appendChild(aR("script"))[cR]=function(){sR.removeChild(this),Yf(r)}}:yn=function(r){setTimeout(Uf(r),0)});fR.exports={set:jf,clear:zf}});var pR=H(()=>{"use strict";var X1=er(),Q1=Pt(),mR=qf().clear;X1({global:!0,bind:!0,enumerable:!0,forced:Q1.clearImmediate!==mR},{clearImmediate:mR})});var bR=H((N2,wR)=>{"use strict";var gR=Pt(),Z1=Na(),J1=Dt(),eD=Lf(),tD=Oa(),rD=Jc(),oD=Df(),iD=gR.Function,nD=/MSIE .\./.test(tD)||eD==="BUN"&&function(){var r=gR.Bun.version.split(".");return r.length<3||r[0]==="0"&&(r[1]<3||r[1]==="3"&&r[2]==="0")}();wR.exports=function(r,e){var t=e?2:1;return nD?function(o,n){var i=oD(arguments.length,1)>t,a=J1(o)?o:iD(o),c=i?rD(arguments,t):[],u=i?function(){Z1(a,this,c)}:a;return e?r(u,n):r(u)}:r}});var SR=H(()=>{"use strict";var sD=er(),yR=Pt(),CR=qf().set,aD=bR(),vR=yR.setImmediate?aD(CR,!1):CR;sD({global:!0,bind:!0,enumerable:!0,forced:yR.setImmediate!==vR},{setImmediate:vR})});var RR=H(()=>{"use strict";pR();SR()});var TR=H((Gf,$f)=>{"use strict";(function(r,e){typeof Gf=="object"&&typeof $f<"u"?$f.exports=e():typeof define=="function"&&define.amd?define(e):(r=typeof globalThis<"u"?globalThis:r||self,r.DOMPurify=e())})(Gf,function(){"use strict";function r(B){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},r(B)}function e(B,W){return e=Object.setPrototypeOf||function(he,Ye){return he.__proto__=Ye,he},e(B,W)}function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function o(B,W,U){return t()?o=Reflect.construct:o=function(Ye,ut,Ue){var Ct=[null];Ct.push.apply(Ct,ut);var dt=Function.bind.apply(Ye,Ct),Xt=new dt;return Ue&&e(Xt,Ue.prototype),Xt},o.apply(null,arguments)}function n(B){return i(B)||a(B)||c(B)||m()}function i(B){if(Array.isArray(B))return u(B)}function a(B){if(typeof Symbol<"u"&&B[Symbol.iterator]!=null||B["@@iterator"]!=null)return Array.from(B)}function c(B,W){if(B){if(typeof B=="string")return u(B,W);var U=Object.prototype.toString.call(B).slice(8,-1);if(U==="Object"&&B.constructor&&(U=B.constructor.name),U==="Map"||U==="Set")return Array.from(B);if(U==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U))return u(B,W)}}function u(B,W){(W==null||W>B.length)&&(W=B.length);for(var U=0,he=new Array(W);U<W;U++)he[U]=B[U];return he}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=Object.hasOwnProperty,C=Object.setPrototypeOf,v=Object.isFrozen,y=Object.getPrototypeOf,R=Object.getOwnPropertyDescriptor,O=Object.freeze,N=Object.seal,I=Object.create,j=typeof Reflect<"u"&&Reflect,ie=j.apply,ue=j.construct;ie||(ie=function(W,U,he){return W.apply(U,he)}),O||(O=function(W){return W}),N||(N=function(W){return W}),ue||(ue=function(W,U){return o(W,n(U))});var de=Ge(Array.prototype.forEach),J=Ge(Array.prototype.pop),te=Ge(Array.prototype.push),q=Ge(String.prototype.toLowerCase),at=Ge(String.prototype.toString),rt=Ge(String.prototype.match),Ne=Ge(String.prototype.replace),Kt=Ge(String.prototype.indexOf),Ir=Ge(String.prototype.trim),Me=Ge(RegExp.prototype.test),At=Bt(TypeError);function Ge(B){return function(W){for(var U=arguments.length,he=new Array(U>1?U-1:0),Ye=1;Ye<U;Ye++)he[Ye-1]=arguments[Ye];return ie(B,W,he)}}function Bt(B){return function(){for(var W=arguments.length,U=new Array(W),he=0;he<W;he++)U[he]=arguments[he];return ue(B,U)}}function F(B,W,U){var he;U=(he=U)!==null&&he!==void 0?he:q,C&&C(B,null);for(var Ye=W.length;Ye--;){var ut=W[Ye];if(typeof ut=="string"){var Ue=U(ut);Ue!==ut&&(v(W)||(W[Ye]=Ue),ut=Ue)}B[ut]=!0}return B}function ae(B){var W=I(null),U;for(U in B)ie(g,B,[U])===!0&&(W[U]=B[U]);return W}function Nt(B,W){for(;B!==null;){var U=R(B,W);if(U){if(U.get)return Ge(U.get);if(typeof U.value=="function")return Ge(U.value)}B=y(B)}function he(Ye){return console.warn("fallback value for",Ye),null}return he}var f=O(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),p=O(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),w=O(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),E=O(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_=O(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),M=O(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),P=O(["#text"]),L=O(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),K=O(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q=O(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=O(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ce=N(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ke=N(/<%[\w\W]*|[\w\W]*%>/gm),ve=N(/\${[\w\W]*}/gm),ze=N(/^data-[\-\w.\u00B7-\uFFFF]/),xt=N(/^aria-[\-\w]+$/),Et=N(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wt=N(/^(?:\w+script|data):/i),Ae=N(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ut=N(/^html$/i),We=N(/^[a-z][.\w]*(-[.\w]+)+$/i),bt=function(){return typeof window>"u"?null:window},mr=function(W,U){if(r(W)!=="object"||typeof W.createPolicy!="function")return null;var he=null,Ye="data-tt-policy-suffix";U.currentScript&&U.currentScript.hasAttribute(Ye)&&(he=U.currentScript.getAttribute(Ye));var ut="dompurify"+(he?"#"+he:"");try{return W.createPolicy(ut,{createHTML:function(Ct){return Ct},createScriptURL:function(Ct){return Ct}})}catch{return console.warn("TrustedTypes policy "+ut+" could not be created."),null}};function Be(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bt(),W=function(x){return Be(x)};if(W.version="2.5.7",W.removed=[],!B||!B.document||B.document.nodeType!==9)return W.isSupported=!1,W;var U=B.document,he=B.document,Ye=B.DocumentFragment,ut=B.HTMLTemplateElement,Ue=B.Node,Ct=B.Element,dt=B.NodeFilter,Xt=B.NamedNodeMap,yr=Xt===void 0?B.NamedNodeMap||B.MozNamedAttrMap:Xt,jt=B.HTMLFormElement,Yn=B.DOMParser,Hr=B.trustedTypes,eo=Ct.prototype,Zs=Nt(eo,"cloneNode"),qn=Nt(eo,"nextSibling"),G=Nt(eo,"childNodes"),Js=Nt(eo,"parentNode");if(typeof ut=="function"){var ea=he.createElement("template");ea.content&&ea.content.ownerDocument&&(he=ea.content.ownerDocument)}var ht=mr(Hr,U),Qt=ht?ht.createHTML(""):"",fe=he,rn=fe.implementation,Pe=fe.createNodeIterator,on=fe.createDocumentFragment,uh=fe.getElementsByTagName,Gn=U.importNode,_t={};try{_t=ae(he).documentMode?he.documentMode:{}}catch{}var vt={};W.isSupported=typeof Js=="function"&&rn&&rn.createHTMLDocument!==void 0&&_t!==9;var Sr=Ce,ot=ke,pr=ve,to=ze,zo=xt,dh=wt,Zl=Ae,nn=We,$n=Et,yt=null,Yo=F({},[].concat(n(f),n(p),n(w),n(_),n(P))),Ze=null,ta=F({},[].concat(n(L),n(K),n(Q),n(z))),it=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),sn=null,ra=null,Je=!0,an=!0,Jl=!1,oa=!0,qo=!1,ia=!0,Go=!1,na=!1,sa=!1,bi=!1,Kn=!1,ln=!1,aa=!0,ec=!1,hh="user-content-",la=!0,Ci=!1,vi={},Vr=null,cn=F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ca=null,yi=F({},["audio","video","img","source","image","track"]),Ar=null,tc=F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xn="http://www.w3.org/1998/Math/MathML",Qn="http://www.w3.org/2000/svg",ro="http://www.w3.org/1999/xhtml",Si=ro,ua=!1,da=null,fh=F({},[Xn,Qn,ro],at),oo,mh=["application/xhtml+xml","text/html"],rc="text/html",St,Ri=null,ph=he.createElement("form"),oc=function(x){return x instanceof RegExp||x instanceof Function},ha=function(x){Ri&&Ri===x||((!x||r(x)!=="object")&&(x={}),x=ae(x),oo=mh.indexOf(x.PARSER_MEDIA_TYPE)===-1?oo=rc:oo=x.PARSER_MEDIA_TYPE,St=oo==="application/xhtml+xml"?at:q,yt="ALLOWED_TAGS"in x?F({},x.ALLOWED_TAGS,St):Yo,Ze="ALLOWED_ATTR"in x?F({},x.ALLOWED_ATTR,St):ta,da="ALLOWED_NAMESPACES"in x?F({},x.ALLOWED_NAMESPACES,at):fh,Ar="ADD_URI_SAFE_ATTR"in x?F(ae(tc),x.ADD_URI_SAFE_ATTR,St):tc,ca="ADD_DATA_URI_TAGS"in x?F(ae(yi),x.ADD_DATA_URI_TAGS,St):yi,Vr="FORBID_CONTENTS"in x?F({},x.FORBID_CONTENTS,St):cn,sn="FORBID_TAGS"in x?F({},x.FORBID_TAGS,St):{},ra="FORBID_ATTR"in x?F({},x.FORBID_ATTR,St):{},vi="USE_PROFILES"in x?x.USE_PROFILES:!1,Je=x.ALLOW_ARIA_ATTR!==!1,an=x.ALLOW_DATA_ATTR!==!1,Jl=x.ALLOW_UNKNOWN_PROTOCOLS||!1,oa=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,qo=x.SAFE_FOR_TEMPLATES||!1,ia=x.SAFE_FOR_XML!==!1,Go=x.WHOLE_DOCUMENT||!1,bi=x.RETURN_DOM||!1,Kn=x.RETURN_DOM_FRAGMENT||!1,ln=x.RETURN_TRUSTED_TYPE||!1,sa=x.FORCE_BODY||!1,aa=x.SANITIZE_DOM!==!1,ec=x.SANITIZE_NAMED_PROPS||!1,la=x.KEEP_CONTENT!==!1,Ci=x.IN_PLACE||!1,$n=x.ALLOWED_URI_REGEXP||$n,Si=x.NAMESPACE||ro,it=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&oc(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(it.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&oc(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(it.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(it.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),qo&&(an=!1),Kn&&(bi=!0),vi&&(yt=F({},n(P)),Ze=[],vi.html===!0&&(F(yt,f),F(Ze,L)),vi.svg===!0&&(F(yt,p),F(Ze,K),F(Ze,z)),vi.svgFilters===!0&&(F(yt,w),F(Ze,K),F(Ze,z)),vi.mathMl===!0&&(F(yt,_),F(Ze,Q),F(Ze,z))),x.ADD_TAGS&&(yt===Yo&&(yt=ae(yt)),F(yt,x.ADD_TAGS,St)),x.ADD_ATTR&&(Ze===ta&&(Ze=ae(Ze)),F(Ze,x.ADD_ATTR,St)),x.ADD_URI_SAFE_ATTR&&F(Ar,x.ADD_URI_SAFE_ATTR,St),x.FORBID_CONTENTS&&(Vr===cn&&(Vr=ae(Vr)),F(Vr,x.FORBID_CONTENTS,St)),la&&(yt["#text"]=!0),Go&&F(yt,["html","head","body"]),yt.table&&(F(yt,["tbody"]),delete sn.tbody),O&&O(x),Ri=x)},ic=F({},["mi","mo","mn","ms","mtext"]),nc=F({},["annotation-xml"]),gh=F({},["title","style","font","a","script"]),Zn=F({},p);F(Zn,w),F(Zn,E);var fa=F({},_);F(fa,M);var wh=function(x){var k=Js(x);(!k||!k.tagName)&&(k={namespaceURI:Si,tagName:"template"});var Y=q(x.tagName),ye=q(k.tagName);return da[x.namespaceURI]?x.namespaceURI===Qn?k.namespaceURI===ro?Y==="svg":k.namespaceURI===Xn?Y==="svg"&&(ye==="annotation-xml"||ic[ye]):!!Zn[Y]:x.namespaceURI===Xn?k.namespaceURI===ro?Y==="math":k.namespaceURI===Qn?Y==="math"&&nc[ye]:!!fa[Y]:x.namespaceURI===ro?k.namespaceURI===Qn&&!nc[ye]||k.namespaceURI===Xn&&!ic[ye]?!1:!fa[Y]&&(gh[Y]||!Zn[Y]):!!(oo==="application/xhtml+xml"&&da[x.namespaceURI]):!1},Rr=function(x){te(W.removed,{element:x});try{x.parentNode.removeChild(x)}catch{try{x.outerHTML=Qt}catch{x.remove()}}},Jn=function(x,k){try{te(W.removed,{attribute:k.getAttributeNode(x),from:k})}catch{te(W.removed,{attribute:null,from:k})}if(k.removeAttribute(x),x==="is"&&!Ze[x])if(bi||Kn)try{Rr(k)}catch{}else try{k.setAttribute(x,"")}catch{}},sc=function(x){var k,Y;if(sa)x="<remove></remove>"+x;else{var ye=rt(x,/^[\r\n\t ]+/);Y=ye&&ye[0]}oo==="application/xhtml+xml"&&Si===ro&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");var Zt=ht?ht.createHTML(x):x;if(Si===ro)try{k=new Yn().parseFromString(Zt,oo)}catch{}if(!k||!k.documentElement){k=rn.createDocument(Si,"template",null);try{k.documentElement.innerHTML=ua?Qt:Zt}catch{}}var Ot=k.body||k.documentElement;return x&&Y&&Ot.insertBefore(he.createTextNode(Y),Ot.childNodes[0]||null),Si===ro?uh.call(k,Go?"html":"body")[0]:Go?k.documentElement:Ot},ac=function(x){return Pe.call(x.ownerDocument||x,x,dt.SHOW_ELEMENT|dt.SHOW_COMMENT|dt.SHOW_TEXT|dt.SHOW_PROCESSING_INSTRUCTION|dt.SHOW_CDATA_SECTION,null,!1)},es=function(x){return x instanceof jt&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof yr)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},$o=function(x){return r(Ue)==="object"?x instanceof Ue:x&&r(x)==="object"&&typeof x.nodeType=="number"&&typeof x.nodeName=="string"},io=function(x,k,Y){vt[x]&&de(vt[x],function(ye){ye.call(W,k,Y,Ri)})},ma=function(x){var k;if(io("beforeSanitizeElements",x,null),es(x)||Me(/[\u0080-\uFFFF]/,x.nodeName))return Rr(x),!0;var Y=St(x.nodeName);if(io("uponSanitizeElement",x,{tagName:Y,allowedTags:yt}),x.hasChildNodes()&&!$o(x.firstElementChild)&&(!$o(x.content)||!$o(x.content.firstElementChild))&&Me(/<[/\w]/g,x.innerHTML)&&Me(/<[/\w]/g,x.textContent)||Y==="select"&&Me(/<template/i,x.innerHTML)||x.nodeType===7||ia&&x.nodeType===8&&Me(/<[/\w]/g,x.data))return Rr(x),!0;if(!yt[Y]||sn[Y]){if(!sn[Y]&&lc(Y)&&(it.tagNameCheck instanceof RegExp&&Me(it.tagNameCheck,Y)||it.tagNameCheck instanceof Function&&it.tagNameCheck(Y)))return!1;if(la&&!Vr[Y]){var ye=Js(x)||x.parentNode,Zt=G(x)||x.childNodes;if(Zt&&ye)for(var Ot=Zt.length,Mt=Ot-1;Mt>=0;--Mt){var Ko=Zs(Zt[Mt],!0);Ko.__removalCount=(x.__removalCount||0)+1,ye.insertBefore(Ko,qn(x))}}return Rr(x),!0}return x instanceof Ct&&!wh(x)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&Me(/<\/no(script|embed|frames)/i,x.innerHTML)?(Rr(x),!0):(qo&&x.nodeType===3&&(k=x.textContent,k=Ne(k,Sr," "),k=Ne(k,ot," "),k=Ne(k,pr," "),x.textContent!==k&&(te(W.removed,{element:x.cloneNode()}),x.textContent=k)),io("afterSanitizeElements",x,null),!1)},pa=function(x,k,Y){if(aa&&(k==="id"||k==="name")&&(Y in he||Y in ph))return!1;if(!(an&&!ra[k]&&Me(to,k))){if(!(Je&&Me(zo,k))){if(!Ze[k]||ra[k]){if(!(lc(x)&&(it.tagNameCheck instanceof RegExp&&Me(it.tagNameCheck,x)||it.tagNameCheck instanceof Function&&it.tagNameCheck(x))&&(it.attributeNameCheck instanceof RegExp&&Me(it.attributeNameCheck,k)||it.attributeNameCheck instanceof Function&&it.attributeNameCheck(k))||k==="is"&&it.allowCustomizedBuiltInElements&&(it.tagNameCheck instanceof RegExp&&Me(it.tagNameCheck,Y)||it.tagNameCheck instanceof Function&&it.tagNameCheck(Y))))return!1}else if(!Ar[k]){if(!Me($n,Ne(Y,Zl,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&x!=="script"&&Kt(Y,"data:")===0&&ca[x])){if(!(Jl&&!Me(dh,Ne(Y,Zl,"")))){if(Y)return!1}}}}}}return!0},lc=function(x){return x!=="annotation-xml"&&rt(x,nn)},cc=function(x){var k,Y,ye,Zt;io("beforeSanitizeAttributes",x,null);var Ot=x.attributes;if(Ot){var Mt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ze};for(Zt=Ot.length;Zt--;){k=Ot[Zt];var Ko=k,et=Ko.name,Wr=Ko.namespaceURI;if(Y=et==="value"?k.value:Ir(k.value),ye=St(et),Mt.attrName=ye,Mt.attrValue=Y,Mt.keepAttr=!0,Mt.forceKeepAttr=void 0,io("uponSanitizeAttribute",x,Mt),Y=Mt.attrValue,!Mt.forceKeepAttr&&(Jn(et,x),!!Mt.keepAttr)){if(!oa&&Me(/\/>/i,Y)){Jn(et,x);continue}qo&&(Y=Ne(Y,Sr," "),Y=Ne(Y,ot," "),Y=Ne(Y,pr," "));var ts=St(x.nodeName);if(pa(ts,ye,Y)){if(ec&&(ye==="id"||ye==="name")&&(Jn(et,x),Y=hh+Y),ia&&Me(/((--!?|])>)|<\/(style|title)/i,Y)){Jn(et,x);continue}if(ht&&r(Hr)==="object"&&typeof Hr.getAttributeType=="function"&&!Wr)switch(Hr.getAttributeType(ts,ye)){case"TrustedHTML":{Y=ht.createHTML(Y);break}case"TrustedScriptURL":{Y=ht.createScriptURL(Y);break}}try{Wr?x.setAttributeNS(Wr,et,Y):x.setAttribute(et,Y),es(x)?Rr(x):J(W.removed)}catch{}}}}io("afterSanitizeAttributes",x,null)}},bh=function Z(x){var k,Y=ac(x);for(io("beforeSanitizeShadowDOM",x,null);k=Y.nextNode();)io("uponSanitizeShadowNode",k,null),!ma(k)&&(k.content instanceof Ye&&Z(k.content),cc(k));io("afterSanitizeShadowDOM",x,null)};return W.sanitize=function(Z){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k,Y,ye,Zt,Ot;if(ua=!Z,ua&&(Z="<!-->"),typeof Z!="string"&&!$o(Z))if(typeof Z.toString=="function"){if(Z=Z.toString(),typeof Z!="string")throw At("dirty is not a string, aborting")}else throw At("toString is not a function");if(!W.isSupported){if(r(B.toStaticHTML)==="object"||typeof B.toStaticHTML=="function"){if(typeof Z=="string")return B.toStaticHTML(Z);if($o(Z))return B.toStaticHTML(Z.outerHTML)}return Z}if(na||ha(x),W.removed=[],typeof Z=="string"&&(Ci=!1),Ci){if(Z.nodeName){var Mt=St(Z.nodeName);if(!yt[Mt]||sn[Mt])throw At("root node is forbidden and cannot be sanitized in-place")}}else if(Z instanceof Ue)k=sc("<!---->"),Y=k.ownerDocument.importNode(Z,!0),Y.nodeType===1&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!bi&&!qo&&!Go&&Z.indexOf("<")===-1)return ht&&ln?ht.createHTML(Z):Z;if(k=sc(Z),!k)return bi?null:ln?Qt:""}k&&sa&&Rr(k.firstChild);for(var Ko=ac(Ci?Z:k);ye=Ko.nextNode();)ye.nodeType===3&&ye===Zt||ma(ye)||(ye.content instanceof Ye&&bh(ye.content),cc(ye),Zt=ye);if(Zt=null,Ci)return Z;if(bi){if(Kn)for(Ot=on.call(k.ownerDocument);k.firstChild;)Ot.appendChild(k.firstChild);else Ot=k;return(Ze.shadowroot||Ze.shadowrootmod)&&(Ot=Gn.call(U,Ot,!0)),Ot}var et=Go?k.outerHTML:k.innerHTML;return Go&&yt["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Me(Ut,k.ownerDocument.doctype.name)&&(et="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+et),qo&&(et=Ne(et,Sr," "),et=Ne(et,ot," "),et=Ne(et,pr," ")),ht&&ln?ht.createHTML(et):et},W.setConfig=function(Z){ha(Z),na=!0},W.clearConfig=function(){Ri=null,na=!1},W.isValidAttribute=function(Z,x,k){Ri||ha({});var Y=St(Z),ye=St(x);return pa(Y,ye,k)},W.addHook=function(Z,x){typeof x=="function"&&(vt[Z]=vt[Z]||[],te(vt[Z],x))},W.removeHook=function(Z){if(vt[Z])return J(vt[Z])},W.removeHooks=function(Z){vt[Z]&&(vt[Z]=[])},W.removeAllHooks=function(){vt={}},W}var Jr=Be();return Jr})});var xR=H((Kf,ws)=>{"use strict";(function(r,e){typeof Kf=="object"&&typeof ws<"u"?ws.exports=e():typeof define=="function"&&define.amd?define(e):r.moment=e()})(Kf,function(){"use strict";var r;function e(){return r.apply(null,arguments)}function t(s){r=s}function o(s){return s instanceof Array||Object.prototype.toString.call(s)==="[object Array]"}function n(s){return s!=null&&Object.prototype.toString.call(s)==="[object Object]"}function i(s,l){return Object.prototype.hasOwnProperty.call(s,l)}function a(s){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(s).length===0;var l;for(l in s)if(i(s,l))return!1;return!0}function c(s){return s===void 0}function u(s){return typeof s=="number"||Object.prototype.toString.call(s)==="[object Number]"}function m(s){return s instanceof Date||Object.prototype.toString.call(s)==="[object Date]"}function g(s,l){var d=[],h,b=s.length;for(h=0;h<b;++h)d.push(l(s[h],h));return d}function C(s,l){for(var d in l)i(l,d)&&(s[d]=l[d]);return i(l,"toString")&&(s.toString=l.toString),i(l,"valueOf")&&(s.valueOf=l.valueOf),s}function v(s,l,d,h){return vw(s,l,d,h,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function R(s){return s._pf==null&&(s._pf=y()),s._pf}var O;Array.prototype.some?O=Array.prototype.some:O=function(s){var l=Object(this),d=l.length>>>0,h;for(h=0;h<d;h++)if(h in l&&s.call(this,l[h],h,l))return!0;return!1};function N(s){var l=null,d=!1,h=s._d&&!isNaN(s._d.getTime());if(h&&(l=R(s),d=O.call(l.parsedDateParts,function(b){return b!=null}),h=l.overflow<0&&!l.empty&&!l.invalidEra&&!l.invalidMonth&&!l.invalidWeekday&&!l.weekdayMismatch&&!l.nullInput&&!l.invalidFormat&&!l.userInvalidated&&(!l.meridiem||l.meridiem&&d),s._strict&&(h=h&&l.charsLeftOver===0&&l.unusedTokens.length===0&&l.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(s))s._isValid=h;else return h;return s._isValid}function I(s){var l=v(NaN);return s!=null?C(R(l),s):R(l).userInvalidated=!0,l}var j=e.momentProperties=[],ie=!1;function ue(s,l){var d,h,b,T=j.length;if(c(l._isAMomentObject)||(s._isAMomentObject=l._isAMomentObject),c(l._i)||(s._i=l._i),c(l._f)||(s._f=l._f),c(l._l)||(s._l=l._l),c(l._strict)||(s._strict=l._strict),c(l._tzm)||(s._tzm=l._tzm),c(l._isUTC)||(s._isUTC=l._isUTC),c(l._offset)||(s._offset=l._offset),c(l._pf)||(s._pf=R(l)),c(l._locale)||(s._locale=l._locale),T>0)for(d=0;d<T;d++)h=j[d],b=l[h],c(b)||(s[h]=b);return s}function de(s){ue(this,s),this._d=new Date(s._d!=null?s._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ie===!1&&(ie=!0,e.updateOffset(this),ie=!1)}function J(s){return s instanceof de||s!=null&&s._isAMomentObject!=null}function te(s){e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+s)}function q(s,l){var d=!0;return C(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,s),d){var h=[],b,T,A,$=arguments.length;for(T=0;T<$;T++){if(b="",typeof arguments[T]=="object"){b+=`
[`+T+"] ";for(A in arguments[0])i(arguments[0],A)&&(b+=A+": "+arguments[0][A]+", ");b=b.slice(0,-2)}else b=arguments[T];h.push(b)}te(s+`
Arguments: `+Array.prototype.slice.call(h).join("")+`
`+new Error().stack),d=!1}return l.apply(this,arguments)},l)}var at={};function rt(s,l){e.deprecationHandler!=null&&e.deprecationHandler(s,l),at[s]||(te(l),at[s]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function Ne(s){return typeof Function<"u"&&s instanceof Function||Object.prototype.toString.call(s)==="[object Function]"}function Kt(s){var l,d;for(d in s)i(s,d)&&(l=s[d],Ne(l)?this[d]=l:this["_"+d]=l);this._config=s,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ir(s,l){var d=C({},s),h;for(h in l)i(l,h)&&(n(s[h])&&n(l[h])?(d[h]={},C(d[h],s[h]),C(d[h],l[h])):l[h]!=null?d[h]=l[h]:delete d[h]);for(h in s)i(s,h)&&!i(l,h)&&n(s[h])&&(d[h]=C({},d[h]));return d}function Me(s){s!=null&&this.set(s)}var At;Object.keys?At=Object.keys:At=function(s){var l,d=[];for(l in s)i(s,l)&&d.push(l);return d};var Ge={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Bt(s,l,d){var h=this._calendar[s]||this._calendar.sameElse;return Ne(h)?h.call(l,d):h}function F(s,l,d){var h=""+Math.abs(s),b=l-h.length,T=s>=0;return(T?d?"+":"":"-")+Math.pow(10,Math.max(0,b)).toString().substr(1)+h}var ae=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Nt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,f={},p={};function w(s,l,d,h){var b=h;typeof h=="string"&&(b=function(){return this[h]()}),s&&(p[s]=b),l&&(p[l[0]]=function(){return F(b.apply(this,arguments),l[1],l[2])}),d&&(p[d]=function(){return this.localeData().ordinal(b.apply(this,arguments),s)})}function E(s){return s.match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"")}function _(s){var l=s.match(ae),d,h;for(d=0,h=l.length;d<h;d++)p[l[d]]?l[d]=p[l[d]]:l[d]=E(l[d]);return function(b){var T="",A;for(A=0;A<h;A++)T+=Ne(l[A])?l[A].call(b,s):l[A];return T}}function M(s,l){return s.isValid()?(l=P(l,s.localeData()),f[l]=f[l]||_(l),f[l](s)):s.localeData().invalidDate()}function P(s,l){var d=5;function h(b){return l.longDateFormat(b)||b}for(Nt.lastIndex=0;d>=0&&Nt.test(s);)s=s.replace(Nt,h),Nt.lastIndex=0,d-=1;return s}var L={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function K(s){var l=this._longDateFormat[s],d=this._longDateFormat[s.toUpperCase()];return l||!d?l:(this._longDateFormat[s]=d.match(ae).map(function(h){return h==="MMMM"||h==="MM"||h==="DD"||h==="dddd"?h.slice(1):h}).join(""),this._longDateFormat[s])}var Q="Invalid date";function z(){return this._invalidDate}var Ce="%d",ke=/\d{1,2}/;function ve(s){return this._ordinal.replace("%d",s)}var ze={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function xt(s,l,d,h){var b=this._relativeTime[d];return Ne(b)?b(s,l,d,h):b.replace(/%d/i,s)}function Et(s,l){var d=this._relativeTime[s>0?"future":"past"];return Ne(d)?d(l):d.replace(/%s/i,l)}var wt={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ae(s){return typeof s=="string"?wt[s]||wt[s.toLowerCase()]:void 0}function Ut(s){var l={},d,h;for(h in s)i(s,h)&&(d=Ae(h),d&&(l[d]=s[h]));return l}var We={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function bt(s){var l=[],d;for(d in s)i(s,d)&&l.push({unit:d,priority:We[d]});return l.sort(function(h,b){return h.priority-b.priority}),l}var mr=/\d/,Be=/\d\d/,Jr=/\d{3}/,B=/\d{4}/,W=/[+-]?\d{6}/,U=/\d\d?/,he=/\d\d\d\d?/,Ye=/\d\d\d\d\d\d?/,ut=/\d{1,3}/,Ue=/\d{1,4}/,Ct=/[+-]?\d{1,6}/,dt=/\d+/,Xt=/[+-]?\d+/,yr=/Z|[+-]\d\d:?\d\d/gi,jt=/Z|[+-]\d\d(?::?\d\d)?/gi,Yn=/[+-]?\d+(\.\d{1,3})?/,Hr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,eo=/^[1-9]\d?/,Zs=/^([1-9]\d|\d)/,qn;qn={};function G(s,l,d){qn[s]=Ne(l)?l:function(h,b){return h&&d?d:l}}function Js(s,l){return i(qn,s)?qn[s](l._strict,l._locale):new RegExp(ea(s))}function ea(s){return ht(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(l,d,h,b,T){return d||h||b||T}))}function ht(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qt(s){return s<0?Math.ceil(s)||0:Math.floor(s)}function fe(s){var l=+s,d=0;return l!==0&&isFinite(l)&&(d=Qt(l)),d}var rn={};function Pe(s,l){var d,h=l,b;for(typeof s=="string"&&(s=[s]),u(l)&&(h=function(T,A){A[l]=fe(T)}),b=s.length,d=0;d<b;d++)rn[s[d]]=h}function on(s,l){Pe(s,function(d,h,b,T){b._w=b._w||{},l(d,b._w,b,T)})}function uh(s,l,d){l!=null&&i(rn,s)&&rn[s](l,d._a,d,s)}function Gn(s){return s%4===0&&s%100!==0||s%400===0}var _t=0,vt=1,Sr=2,ot=3,pr=4,to=5,zo=6,dh=7,Zl=8;w("Y",0,0,function(){var s=this.year();return s<=9999?F(s,4):"+"+s}),w(0,["YY",2],0,function(){return this.year()%100}),w(0,["YYYY",4],0,"year"),w(0,["YYYYY",5],0,"year"),w(0,["YYYYYY",6,!0],0,"year"),G("Y",Xt),G("YY",U,Be),G("YYYY",Ue,B),G("YYYYY",Ct,W),G("YYYYYY",Ct,W),Pe(["YYYYY","YYYYYY"],_t),Pe("YYYY",function(s,l){l[_t]=s.length===2?e.parseTwoDigitYear(s):fe(s)}),Pe("YY",function(s,l){l[_t]=e.parseTwoDigitYear(s)}),Pe("Y",function(s,l){l[_t]=parseInt(s,10)});function nn(s){return Gn(s)?366:365}e.parseTwoDigitYear=function(s){return fe(s)+(fe(s)>68?1900:2e3)};var $n=Yo("FullYear",!0);function yt(){return Gn(this.year())}function Yo(s,l){return function(d){return d!=null?(ta(this,s,d),e.updateOffset(this,l),this):Ze(this,s)}}function Ze(s,l){if(!s.isValid())return NaN;var d=s._d,h=s._isUTC;switch(l){case"Milliseconds":return h?d.getUTCMilliseconds():d.getMilliseconds();case"Seconds":return h?d.getUTCSeconds():d.getSeconds();case"Minutes":return h?d.getUTCMinutes():d.getMinutes();case"Hours":return h?d.getUTCHours():d.getHours();case"Date":return h?d.getUTCDate():d.getDate();case"Day":return h?d.getUTCDay():d.getDay();case"Month":return h?d.getUTCMonth():d.getMonth();case"FullYear":return h?d.getUTCFullYear():d.getFullYear();default:return NaN}}function ta(s,l,d){var h,b,T,A,$;if(!(!s.isValid()||isNaN(d))){switch(h=s._d,b=s._isUTC,l){case"Milliseconds":return void(b?h.setUTCMilliseconds(d):h.setMilliseconds(d));case"Seconds":return void(b?h.setUTCSeconds(d):h.setSeconds(d));case"Minutes":return void(b?h.setUTCMinutes(d):h.setMinutes(d));case"Hours":return void(b?h.setUTCHours(d):h.setHours(d));case"Date":return void(b?h.setUTCDate(d):h.setDate(d));case"FullYear":break;default:return}T=d,A=s.month(),$=s.date(),$=$===29&&A===1&&!Gn(T)?28:$,b?h.setUTCFullYear(T,A,$):h.setFullYear(T,A,$)}}function it(s){return s=Ae(s),Ne(this[s])?this[s]():this}function sn(s,l){if(typeof s=="object"){s=Ut(s);var d=bt(s),h,b=d.length;for(h=0;h<b;h++)this[d[h].unit](s[d[h].unit])}else if(s=Ae(s),Ne(this[s]))return this[s](l);return this}function ra(s,l){return(s%l+l)%l}var Je;Array.prototype.indexOf?Je=Array.prototype.indexOf:Je=function(s){var l;for(l=0;l<this.length;++l)if(this[l]===s)return l;return-1};function an(s,l){if(isNaN(s)||isNaN(l))return NaN;var d=ra(l,12);return s+=(l-d)/12,d===1?Gn(s)?29:28:31-d%7%2}w("M",["MM",2],"Mo",function(){return this.month()+1}),w("MMM",0,0,function(s){return this.localeData().monthsShort(this,s)}),w("MMMM",0,0,function(s){return this.localeData().months(this,s)}),G("M",U,eo),G("MM",U,Be),G("MMM",function(s,l){return l.monthsShortRegex(s)}),G("MMMM",function(s,l){return l.monthsRegex(s)}),Pe(["M","MM"],function(s,l){l[vt]=fe(s)-1}),Pe(["MMM","MMMM"],function(s,l,d,h){var b=d._locale.monthsParse(s,h,d._strict);b!=null?l[vt]=b:R(d).invalidMonth=s});var Jl="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),oa="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qo=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ia=Hr,Go=Hr;function na(s,l){return s?o(this._months)?this._months[s.month()]:this._months[(this._months.isFormat||qo).test(l)?"format":"standalone"][s.month()]:o(this._months)?this._months:this._months.standalone}function sa(s,l){return s?o(this._monthsShort)?this._monthsShort[s.month()]:this._monthsShort[qo.test(l)?"format":"standalone"][s.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bi(s,l,d){var h,b,T,A=s.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],h=0;h<12;++h)T=v([2e3,h]),this._shortMonthsParse[h]=this.monthsShort(T,"").toLocaleLowerCase(),this._longMonthsParse[h]=this.months(T,"").toLocaleLowerCase();return d?l==="MMM"?(b=Je.call(this._shortMonthsParse,A),b!==-1?b:null):(b=Je.call(this._longMonthsParse,A),b!==-1?b:null):l==="MMM"?(b=Je.call(this._shortMonthsParse,A),b!==-1?b:(b=Je.call(this._longMonthsParse,A),b!==-1?b:null)):(b=Je.call(this._longMonthsParse,A),b!==-1?b:(b=Je.call(this._shortMonthsParse,A),b!==-1?b:null))}function Kn(s,l,d){var h,b,T;if(this._monthsParseExact)return bi.call(this,s,l,d);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),h=0;h<12;h++){if(b=v([2e3,h]),d&&!this._longMonthsParse[h]&&(this._longMonthsParse[h]=new RegExp("^"+this.months(b,"").replace(".","")+"$","i"),this._shortMonthsParse[h]=new RegExp("^"+this.monthsShort(b,"").replace(".","")+"$","i")),!d&&!this._monthsParse[h]&&(T="^"+this.months(b,"")+"|^"+this.monthsShort(b,""),this._monthsParse[h]=new RegExp(T.replace(".",""),"i")),d&&l==="MMMM"&&this._longMonthsParse[h].test(s))return h;if(d&&l==="MMM"&&this._shortMonthsParse[h].test(s))return h;if(!d&&this._monthsParse[h].test(s))return h}}function ln(s,l){if(!s.isValid())return s;if(typeof l=="string"){if(/^\d+$/.test(l))l=fe(l);else if(l=s.localeData().monthsParse(l),!u(l))return s}var d=l,h=s.date();return h=h<29?h:Math.min(h,an(s.year(),d)),s._isUTC?s._d.setUTCMonth(d,h):s._d.setMonth(d,h),s}function aa(s){return s!=null?(ln(this,s),e.updateOffset(this,!0),this):Ze(this,"Month")}function ec(){return an(this.year(),this.month())}function hh(s){return this._monthsParseExact?(i(this,"_monthsRegex")||Ci.call(this),s?this._monthsShortStrictRegex:this._monthsShortRegex):(i(this,"_monthsShortRegex")||(this._monthsShortRegex=ia),this._monthsShortStrictRegex&&s?this._monthsShortStrictRegex:this._monthsShortRegex)}function la(s){return this._monthsParseExact?(i(this,"_monthsRegex")||Ci.call(this),s?this._monthsStrictRegex:this._monthsRegex):(i(this,"_monthsRegex")||(this._monthsRegex=Go),this._monthsStrictRegex&&s?this._monthsStrictRegex:this._monthsRegex)}function Ci(){function s(ne,xe){return xe.length-ne.length}var l=[],d=[],h=[],b,T,A,$;for(b=0;b<12;b++)T=v([2e3,b]),A=ht(this.monthsShort(T,"")),$=ht(this.months(T,"")),l.push(A),d.push($),h.push($),h.push(A);l.sort(s),d.sort(s),h.sort(s),this._monthsRegex=new RegExp("^("+h.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+d.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+l.join("|")+")","i")}function vi(s,l,d,h,b,T,A){var $;return s<100&&s>=0?($=new Date(s+400,l,d,h,b,T,A),isFinite($.getFullYear())&&$.setFullYear(s)):$=new Date(s,l,d,h,b,T,A),$}function Vr(s){var l,d;return s<100&&s>=0?(d=Array.prototype.slice.call(arguments),d[0]=s+400,l=new Date(Date.UTC.apply(null,d)),isFinite(l.getUTCFullYear())&&l.setUTCFullYear(s)):l=new Date(Date.UTC.apply(null,arguments)),l}function cn(s,l,d){var h=7+l-d,b=(7+Vr(s,0,h).getUTCDay()-l)%7;return-b+h-1}function ca(s,l,d,h,b){var T=(7+d-h)%7,A=cn(s,h,b),$=1+7*(l-1)+T+A,ne,xe;return $<=0?(ne=s-1,xe=nn(ne)+$):$>nn(s)?(ne=s+1,xe=$-nn(s)):(ne=s,xe=$),{year:ne,dayOfYear:xe}}function yi(s,l,d){var h=cn(s.year(),l,d),b=Math.floor((s.dayOfYear()-h-1)/7)+1,T,A;return b<1?(A=s.year()-1,T=b+Ar(A,l,d)):b>Ar(s.year(),l,d)?(T=b-Ar(s.year(),l,d),A=s.year()+1):(A=s.year(),T=b),{week:T,year:A}}function Ar(s,l,d){var h=cn(s,l,d),b=cn(s+1,l,d);return(nn(s)-h+b)/7}w("w",["ww",2],"wo","week"),w("W",["WW",2],"Wo","isoWeek"),G("w",U,eo),G("ww",U,Be),G("W",U,eo),G("WW",U,Be),on(["w","ww","W","WW"],function(s,l,d,h){l[h.substr(0,1)]=fe(s)});function tc(s){return yi(s,this._week.dow,this._week.doy).week}var Xn={dow:0,doy:6};function Qn(){return this._week.dow}function ro(){return this._week.doy}function Si(s){var l=this.localeData().week(this);return s==null?l:this.add((s-l)*7,"d")}function ua(s){var l=yi(this,1,4).week;return s==null?l:this.add((s-l)*7,"d")}w("d",0,"do","day"),w("dd",0,0,function(s){return this.localeData().weekdaysMin(this,s)}),w("ddd",0,0,function(s){return this.localeData().weekdaysShort(this,s)}),w("dddd",0,0,function(s){return this.localeData().weekdays(this,s)}),w("e",0,0,"weekday"),w("E",0,0,"isoWeekday"),G("d",U),G("e",U),G("E",U),G("dd",function(s,l){return l.weekdaysMinRegex(s)}),G("ddd",function(s,l){return l.weekdaysShortRegex(s)}),G("dddd",function(s,l){return l.weekdaysRegex(s)}),on(["dd","ddd","dddd"],function(s,l,d,h){var b=d._locale.weekdaysParse(s,h,d._strict);b!=null?l.d=b:R(d).invalidWeekday=s}),on(["d","e","E"],function(s,l,d,h){l[h]=fe(s)});function da(s,l){return typeof s!="string"?s:isNaN(s)?(s=l.weekdaysParse(s),typeof s=="number"?s:null):parseInt(s,10)}function fh(s,l){return typeof s=="string"?l.weekdaysParse(s)%7||7:isNaN(s)?null:s}function oo(s,l){return s.slice(l,7).concat(s.slice(0,l))}var mh="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),rc="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),St="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ri=Hr,ph=Hr,oc=Hr;function ha(s,l){var d=o(this._weekdays)?this._weekdays:this._weekdays[s&&s!==!0&&this._weekdays.isFormat.test(l)?"format":"standalone"];return s===!0?oo(d,this._week.dow):s?d[s.day()]:d}function ic(s){return s===!0?oo(this._weekdaysShort,this._week.dow):s?this._weekdaysShort[s.day()]:this._weekdaysShort}function nc(s){return s===!0?oo(this._weekdaysMin,this._week.dow):s?this._weekdaysMin[s.day()]:this._weekdaysMin}function gh(s,l,d){var h,b,T,A=s.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],h=0;h<7;++h)T=v([2e3,1]).day(h),this._minWeekdaysParse[h]=this.weekdaysMin(T,"").toLocaleLowerCase(),this._shortWeekdaysParse[h]=this.weekdaysShort(T,"").toLocaleLowerCase(),this._weekdaysParse[h]=this.weekdays(T,"").toLocaleLowerCase();return d?l==="dddd"?(b=Je.call(this._weekdaysParse,A),b!==-1?b:null):l==="ddd"?(b=Je.call(this._shortWeekdaysParse,A),b!==-1?b:null):(b=Je.call(this._minWeekdaysParse,A),b!==-1?b:null):l==="dddd"?(b=Je.call(this._weekdaysParse,A),b!==-1||(b=Je.call(this._shortWeekdaysParse,A),b!==-1)?b:(b=Je.call(this._minWeekdaysParse,A),b!==-1?b:null)):l==="ddd"?(b=Je.call(this._shortWeekdaysParse,A),b!==-1||(b=Je.call(this._weekdaysParse,A),b!==-1)?b:(b=Je.call(this._minWeekdaysParse,A),b!==-1?b:null)):(b=Je.call(this._minWeekdaysParse,A),b!==-1||(b=Je.call(this._weekdaysParse,A),b!==-1)?b:(b=Je.call(this._shortWeekdaysParse,A),b!==-1?b:null))}function Zn(s,l,d){var h,b,T;if(this._weekdaysParseExact)return gh.call(this,s,l,d);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),h=0;h<7;h++){if(b=v([2e3,1]).day(h),d&&!this._fullWeekdaysParse[h]&&(this._fullWeekdaysParse[h]=new RegExp("^"+this.weekdays(b,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[h]=new RegExp("^"+this.weekdaysShort(b,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[h]=new RegExp("^"+this.weekdaysMin(b,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[h]||(T="^"+this.weekdays(b,"")+"|^"+this.weekdaysShort(b,"")+"|^"+this.weekdaysMin(b,""),this._weekdaysParse[h]=new RegExp(T.replace(".",""),"i")),d&&l==="dddd"&&this._fullWeekdaysParse[h].test(s))return h;if(d&&l==="ddd"&&this._shortWeekdaysParse[h].test(s))return h;if(d&&l==="dd"&&this._minWeekdaysParse[h].test(s))return h;if(!d&&this._weekdaysParse[h].test(s))return h}}function fa(s){if(!this.isValid())return s!=null?this:NaN;var l=Ze(this,"Day");return s!=null?(s=da(s,this.localeData()),this.add(s-l,"d")):l}function wh(s){if(!this.isValid())return s!=null?this:NaN;var l=(this.day()+7-this.localeData()._week.dow)%7;return s==null?l:this.add(s-l,"d")}function Rr(s){if(!this.isValid())return s!=null?this:NaN;if(s!=null){var l=fh(s,this.localeData());return this.day(this.day()%7?l:l-7)}else return this.day()||7}function Jn(s){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||es.call(this),s?this._weekdaysStrictRegex:this._weekdaysRegex):(i(this,"_weekdaysRegex")||(this._weekdaysRegex=Ri),this._weekdaysStrictRegex&&s?this._weekdaysStrictRegex:this._weekdaysRegex)}function sc(s){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||es.call(this),s?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(i(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ph),this._weekdaysShortStrictRegex&&s?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ac(s){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||es.call(this),s?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(i(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=oc),this._weekdaysMinStrictRegex&&s?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function es(){function s(gr,ei){return ei.length-gr.length}var l=[],d=[],h=[],b=[],T,A,$,ne,xe;for(T=0;T<7;T++)A=v([2e3,1]).day(T),$=ht(this.weekdaysMin(A,"")),ne=ht(this.weekdaysShort(A,"")),xe=ht(this.weekdays(A,"")),l.push($),d.push(ne),h.push(xe),b.push($),b.push(ne),b.push(xe);l.sort(s),d.sort(s),h.sort(s),b.sort(s),this._weekdaysRegex=new RegExp("^("+b.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+l.join("|")+")","i")}function $o(){return this.hours()%12||12}function io(){return this.hours()||24}w("H",["HH",2],0,"hour"),w("h",["hh",2],0,$o),w("k",["kk",2],0,io),w("hmm",0,0,function(){return""+$o.apply(this)+F(this.minutes(),2)}),w("hmmss",0,0,function(){return""+$o.apply(this)+F(this.minutes(),2)+F(this.seconds(),2)}),w("Hmm",0,0,function(){return""+this.hours()+F(this.minutes(),2)}),w("Hmmss",0,0,function(){return""+this.hours()+F(this.minutes(),2)+F(this.seconds(),2)});function ma(s,l){w(s,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),l)})}ma("a",!0),ma("A",!1);function pa(s,l){return l._meridiemParse}G("a",pa),G("A",pa),G("H",U,Zs),G("h",U,eo),G("k",U,eo),G("HH",U,Be),G("hh",U,Be),G("kk",U,Be),G("hmm",he),G("hmmss",Ye),G("Hmm",he),G("Hmmss",Ye),Pe(["H","HH"],ot),Pe(["k","kk"],function(s,l,d){var h=fe(s);l[ot]=h===24?0:h}),Pe(["a","A"],function(s,l,d){d._isPm=d._locale.isPM(s),d._meridiem=s}),Pe(["h","hh"],function(s,l,d){l[ot]=fe(s),R(d).bigHour=!0}),Pe("hmm",function(s,l,d){var h=s.length-2;l[ot]=fe(s.substr(0,h)),l[pr]=fe(s.substr(h)),R(d).bigHour=!0}),Pe("hmmss",function(s,l,d){var h=s.length-4,b=s.length-2;l[ot]=fe(s.substr(0,h)),l[pr]=fe(s.substr(h,2)),l[to]=fe(s.substr(b)),R(d).bigHour=!0}),Pe("Hmm",function(s,l,d){var h=s.length-2;l[ot]=fe(s.substr(0,h)),l[pr]=fe(s.substr(h))}),Pe("Hmmss",function(s,l,d){var h=s.length-4,b=s.length-2;l[ot]=fe(s.substr(0,h)),l[pr]=fe(s.substr(h,2)),l[to]=fe(s.substr(b))});function lc(s){return(s+"").toLowerCase().charAt(0)==="p"}var cc=/[ap]\.?m?\.?/i,bh=Yo("Hours",!0);function Z(s,l,d){return s>11?d?"pm":"PM":d?"am":"AM"}var x={calendar:Ge,longDateFormat:L,invalidDate:Q,ordinal:Ce,dayOfMonthOrdinalParse:ke,relativeTime:ze,months:Jl,monthsShort:oa,week:Xn,weekdays:mh,weekdaysMin:St,weekdaysShort:rc,meridiemParse:cc},k={},Y={},ye;function Zt(s,l){var d,h=Math.min(s.length,l.length);for(d=0;d<h;d+=1)if(s[d]!==l[d])return d;return h}function Ot(s){return s&&s.toLowerCase().replace("_","-")}function Mt(s){for(var l=0,d,h,b,T;l<s.length;){for(T=Ot(s[l]).split("-"),d=T.length,h=Ot(s[l+1]),h=h?h.split("-"):null;d>0;){if(b=et(T.slice(0,d).join("-")),b)return b;if(h&&h.length>=d&&Zt(T,h)>=d-1)break;d--}l++}return ye}function Ko(s){return!!(s&&s.match("^[^/\\\\]*$"))}function et(s){var l=null,d;if(k[s]===void 0&&typeof ws<"u"&&ws&&ws.exports&&Ko(s))try{l=ye._abbr,d=jw,d("./locale/"+s),Wr(l)}catch{k[s]=null}return k[s]}function Wr(s,l){var d;return s&&(c(l)?d=Xo(s):d=ts(s,l),d?ye=d:typeof console<"u"&&console.warn&&console.warn("Locale "+s+" not found. Did you forget to load it?")),ye._abbr}function ts(s,l){if(l!==null){var d,h=x;if(l.abbr=s,k[s]!=null)rt("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),h=k[s]._config;else if(l.parentLocale!=null)if(k[l.parentLocale]!=null)h=k[l.parentLocale]._config;else if(d=et(l.parentLocale),d!=null)h=d._config;else return Y[l.parentLocale]||(Y[l.parentLocale]=[]),Y[l.parentLocale].push({name:s,config:l}),null;return k[s]=new Me(Ir(h,l)),Y[s]&&Y[s].forEach(function(b){ts(b.name,b.config)}),Wr(s),k[s]}else return delete k[s],null}function gw(s,l){if(l!=null){var d,h,b=x;k[s]!=null&&k[s].parentLocale!=null?k[s].set(Ir(k[s]._config,l)):(h=et(s),h!=null&&(b=h._config),l=Ir(b,l),h==null&&(l.abbr=s),d=new Me(l),d.parentLocale=k[s],k[s]=d),Wr(s)}else k[s]!=null&&(k[s].parentLocale!=null?(k[s]=k[s].parentLocale,s===Wr()&&Wr(s)):k[s]!=null&&delete k[s]);return k[s]}function Xo(s){var l;if(s&&s._locale&&s._locale._abbr&&(s=s._locale._abbr),!s)return ye;if(!o(s)){if(l=et(s),l)return l;s=[s]}return Mt(s)}function L_(){return At(k)}function Ch(s){var l,d=s._a;return d&&R(s).overflow===-2&&(l=d[vt]<0||d[vt]>11?vt:d[Sr]<1||d[Sr]>an(d[_t],d[vt])?Sr:d[ot]<0||d[ot]>24||d[ot]===24&&(d[pr]!==0||d[to]!==0||d[zo]!==0)?ot:d[pr]<0||d[pr]>59?pr:d[to]<0||d[to]>59?to:d[zo]<0||d[zo]>999?zo:-1,R(s)._overflowDayOfYear&&(l<_t||l>Sr)&&(l=Sr),R(s)._overflowWeeks&&l===-1&&(l=dh),R(s)._overflowWeekday&&l===-1&&(l=Zl),R(s).overflow=l),s}var F_=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,V_=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,W_=/Z|[+-]\d\d(?::?\d\d)?/,uc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],vh=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],B_=/^\/?Date\((-?\d+)/i,U_=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,j_={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ww(s){var l,d,h=s._i,b=F_.exec(h)||V_.exec(h),T,A,$,ne,xe=uc.length,gr=vh.length;if(b){for(R(s).iso=!0,l=0,d=xe;l<d;l++)if(uc[l][1].exec(b[1])){A=uc[l][0],T=uc[l][2]!==!1;break}if(A==null){s._isValid=!1;return}if(b[3]){for(l=0,d=gr;l<d;l++)if(vh[l][1].exec(b[3])){$=(b[2]||" ")+vh[l][0];break}if($==null){s._isValid=!1;return}}if(!T&&$!=null){s._isValid=!1;return}if(b[4])if(W_.exec(b[4]))ne="Z";else{s._isValid=!1;return}s._f=A+($||"")+(ne||""),Sh(s)}else s._isValid=!1}function z_(s,l,d,h,b,T){var A=[Y_(s),oa.indexOf(l),parseInt(d,10),parseInt(h,10),parseInt(b,10)];return T&&A.push(parseInt(T,10)),A}function Y_(s){var l=parseInt(s,10);return l<=49?2e3+l:l<=999?1900+l:l}function q_(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function G_(s,l,d){if(s){var h=rc.indexOf(s),b=new Date(l[0],l[1],l[2]).getDay();if(h!==b)return R(d).weekdayMismatch=!0,d._isValid=!1,!1}return!0}function $_(s,l,d){if(s)return j_[s];if(l)return 0;var h=parseInt(d,10),b=h%100,T=(h-b)/100;return T*60+b}function bw(s){var l=U_.exec(q_(s._i)),d;if(l){if(d=z_(l[4],l[3],l[2],l[5],l[6],l[7]),!G_(l[1],d,s))return;s._a=d,s._tzm=$_(l[8],l[9],l[10]),s._d=Vr.apply(null,s._a),s._d.setUTCMinutes(s._d.getUTCMinutes()-s._tzm),R(s).rfc2822=!0}else s._isValid=!1}function K_(s){var l=B_.exec(s._i);if(l!==null){s._d=new Date(+l[1]);return}if(ww(s),s._isValid===!1)delete s._isValid;else return;if(bw(s),s._isValid===!1)delete s._isValid;else return;s._strict?s._isValid=!1:e.createFromInputFallback(s)}e.createFromInputFallback=q("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(s){s._d=new Date(s._i+(s._useUTC?" UTC":""))});function rs(s,l,d){return s??l??d}function X_(s){var l=new Date(e.now());return s._useUTC?[l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()]:[l.getFullYear(),l.getMonth(),l.getDate()]}function yh(s){var l,d,h=[],b,T,A;if(!s._d){for(b=X_(s),s._w&&s._a[Sr]==null&&s._a[vt]==null&&Q_(s),s._dayOfYear!=null&&(A=rs(s._a[_t],b[_t]),(s._dayOfYear>nn(A)||s._dayOfYear===0)&&(R(s)._overflowDayOfYear=!0),d=Vr(A,0,s._dayOfYear),s._a[vt]=d.getUTCMonth(),s._a[Sr]=d.getUTCDate()),l=0;l<3&&s._a[l]==null;++l)s._a[l]=h[l]=b[l];for(;l<7;l++)s._a[l]=h[l]=s._a[l]==null?l===2?1:0:s._a[l];s._a[ot]===24&&s._a[pr]===0&&s._a[to]===0&&s._a[zo]===0&&(s._nextDay=!0,s._a[ot]=0),s._d=(s._useUTC?Vr:vi).apply(null,h),T=s._useUTC?s._d.getUTCDay():s._d.getDay(),s._tzm!=null&&s._d.setUTCMinutes(s._d.getUTCMinutes()-s._tzm),s._nextDay&&(s._a[ot]=24),s._w&&typeof s._w.d<"u"&&s._w.d!==T&&(R(s).weekdayMismatch=!0)}}function Q_(s){var l,d,h,b,T,A,$,ne,xe;l=s._w,l.GG!=null||l.W!=null||l.E!=null?(T=1,A=4,d=rs(l.GG,s._a[_t],yi($e(),1,4).year),h=rs(l.W,1),b=rs(l.E,1),(b<1||b>7)&&(ne=!0)):(T=s._locale._week.dow,A=s._locale._week.doy,xe=yi($e(),T,A),d=rs(l.gg,s._a[_t],xe.year),h=rs(l.w,xe.week),l.d!=null?(b=l.d,(b<0||b>6)&&(ne=!0)):l.e!=null?(b=l.e+T,(l.e<0||l.e>6)&&(ne=!0)):b=T),h<1||h>Ar(d,T,A)?R(s)._overflowWeeks=!0:ne!=null?R(s)._overflowWeekday=!0:($=ca(d,h,b,T,A),s._a[_t]=$.year,s._dayOfYear=$.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function Sh(s){if(s._f===e.ISO_8601){ww(s);return}if(s._f===e.RFC_2822){bw(s);return}s._a=[],R(s).empty=!0;var l=""+s._i,d,h,b,T,A,$=l.length,ne=0,xe,gr;for(b=P(s._f,s._locale).match(ae)||[],gr=b.length,d=0;d<gr;d++)T=b[d],h=(l.match(Js(T,s))||[])[0],h&&(A=l.substr(0,l.indexOf(h)),A.length>0&&R(s).unusedInput.push(A),l=l.slice(l.indexOf(h)+h.length),ne+=h.length),p[T]?(h?R(s).empty=!1:R(s).unusedTokens.push(T),uh(T,h,s)):s._strict&&!h&&R(s).unusedTokens.push(T);R(s).charsLeftOver=$-ne,l.length>0&&R(s).unusedInput.push(l),s._a[ot]<=12&&R(s).bigHour===!0&&s._a[ot]>0&&(R(s).bigHour=void 0),R(s).parsedDateParts=s._a.slice(0),R(s).meridiem=s._meridiem,s._a[ot]=Z_(s._locale,s._a[ot],s._meridiem),xe=R(s).era,xe!==null&&(s._a[_t]=s._locale.erasConvertYear(xe,s._a[_t])),yh(s),Ch(s)}function Z_(s,l,d){var h;return d==null?l:s.meridiemHour!=null?s.meridiemHour(l,d):(s.isPM!=null&&(h=s.isPM(d),h&&l<12&&(l+=12),!h&&l===12&&(l=0)),l)}function J_(s){var l,d,h,b,T,A,$=!1,ne=s._f.length;if(ne===0){R(s).invalidFormat=!0,s._d=new Date(NaN);return}for(b=0;b<ne;b++)T=0,A=!1,l=ue({},s),s._useUTC!=null&&(l._useUTC=s._useUTC),l._f=s._f[b],Sh(l),N(l)&&(A=!0),T+=R(l).charsLeftOver,T+=R(l).unusedTokens.length*10,R(l).score=T,$?T<h&&(h=T,d=l):(h==null||T<h||A)&&(h=T,d=l,A&&($=!0));C(s,d||l)}function eO(s){if(!s._d){var l=Ut(s._i),d=l.day===void 0?l.date:l.day;s._a=g([l.year,l.month,d,l.hour,l.minute,l.second,l.millisecond],function(h){return h&&parseInt(h,10)}),yh(s)}}function tO(s){var l=new de(Ch(Cw(s)));return l._nextDay&&(l.add(1,"d"),l._nextDay=void 0),l}function Cw(s){var l=s._i,d=s._f;return s._locale=s._locale||Xo(s._l),l===null||d===void 0&&l===""?I({nullInput:!0}):(typeof l=="string"&&(s._i=l=s._locale.preparse(l)),J(l)?new de(Ch(l)):(m(l)?s._d=l:o(d)?J_(s):d?Sh(s):rO(s),N(s)||(s._d=null),s))}function rO(s){var l=s._i;c(l)?s._d=new Date(e.now()):m(l)?s._d=new Date(l.valueOf()):typeof l=="string"?K_(s):o(l)?(s._a=g(l.slice(0),function(d){return parseInt(d,10)}),yh(s)):n(l)?eO(s):u(l)?s._d=new Date(l):e.createFromInputFallback(s)}function vw(s,l,d,h,b){var T={};return(l===!0||l===!1)&&(h=l,l=void 0),(d===!0||d===!1)&&(h=d,d=void 0),(n(s)&&a(s)||o(s)&&s.length===0)&&(s=void 0),T._isAMomentObject=!0,T._useUTC=T._isUTC=b,T._l=d,T._i=s,T._f=l,T._strict=h,tO(T)}function $e(s,l,d,h){return vw(s,l,d,h,!1)}var oO=q("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var s=$e.apply(null,arguments);return this.isValid()&&s.isValid()?s<this?this:s:I()}),iO=q("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var s=$e.apply(null,arguments);return this.isValid()&&s.isValid()?s>this?this:s:I()});function yw(s,l){var d,h;if(l.length===1&&o(l[0])&&(l=l[0]),!l.length)return $e();for(d=l[0],h=1;h<l.length;++h)(!l[h].isValid()||l[h][s](d))&&(d=l[h]);return d}function nO(){var s=[].slice.call(arguments,0);return yw("isBefore",s)}function sO(){var s=[].slice.call(arguments,0);return yw("isAfter",s)}var aO=function(){return Date.now?Date.now():+new Date},ga=["year","quarter","month","week","day","hour","minute","second","millisecond"];function lO(s){var l,d=!1,h,b=ga.length;for(l in s)if(i(s,l)&&!(Je.call(ga,l)!==-1&&(s[l]==null||!isNaN(s[l]))))return!1;for(h=0;h<b;++h)if(s[ga[h]]){if(d)return!1;parseFloat(s[ga[h]])!==fe(s[ga[h]])&&(d=!0)}return!0}function cO(){return this._isValid}function uO(){return no(NaN)}function dc(s){var l=Ut(s),d=l.year||0,h=l.quarter||0,b=l.month||0,T=l.week||l.isoWeek||0,A=l.day||0,$=l.hour||0,ne=l.minute||0,xe=l.second||0,gr=l.millisecond||0;this._isValid=lO(l),this._milliseconds=+gr+xe*1e3+ne*6e4+$*1e3*60*60,this._days=+A+T*7,this._months=+b+h*3+d*12,this._data={},this._locale=Xo(),this._bubble()}function hc(s){return s instanceof dc}function Rh(s){return s<0?Math.round(-1*s)*-1:Math.round(s)}function dO(s,l,d){var h=Math.min(s.length,l.length),b=Math.abs(s.length-l.length),T=0,A;for(A=0;A<h;A++)(d&&s[A]!==l[A]||!d&&fe(s[A])!==fe(l[A]))&&T++;return T+b}function Sw(s,l){w(s,0,0,function(){var d=this.utcOffset(),h="+";return d<0&&(d=-d,h="-"),h+F(~~(d/60),2)+l+F(~~d%60,2)})}Sw("Z",":"),Sw("ZZ",""),G("Z",jt),G("ZZ",jt),Pe(["Z","ZZ"],function(s,l,d){d._useUTC=!0,d._tzm=Th(jt,s)});var hO=/([\+\-]|\d\d)/gi;function Th(s,l){var d=(l||"").match(s),h,b,T;return d===null?null:(h=d[d.length-1]||[],b=(h+"").match(hO)||["-",0,0],T=+(b[1]*60)+fe(b[2]),T===0?0:b[0]==="+"?T:-T)}function xh(s,l){var d,h;return l._isUTC?(d=l.clone(),h=(J(s)||m(s)?s.valueOf():$e(s).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+h),e.updateOffset(d,!1),d):$e(s).local()}function Eh(s){return-Math.round(s._d.getTimezoneOffset())}e.updateOffset=function(){};function fO(s,l,d){var h=this._offset||0,b;if(!this.isValid())return s!=null?this:NaN;if(s!=null){if(typeof s=="string"){if(s=Th(jt,s),s===null)return this}else Math.abs(s)<16&&!d&&(s=s*60);return!this._isUTC&&l&&(b=Eh(this)),this._offset=s,this._isUTC=!0,b!=null&&this.add(b,"m"),h!==s&&(!l||this._changeInProgress?Ew(this,no(s-h,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?h:Eh(this)}function mO(s,l){return s!=null?(typeof s!="string"&&(s=-s),this.utcOffset(s,l),this):-this.utcOffset()}function pO(s){return this.utcOffset(0,s)}function gO(s){return this._isUTC&&(this.utcOffset(0,s),this._isUTC=!1,s&&this.subtract(Eh(this),"m")),this}function wO(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var s=Th(yr,this._i);s!=null?this.utcOffset(s):this.utcOffset(0,!0)}return this}function bO(s){return this.isValid()?(s=s?$e(s).utcOffset():0,(this.utcOffset()-s)%60===0):!1}function CO(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function vO(){if(!c(this._isDSTShifted))return this._isDSTShifted;var s={},l;return ue(s,this),s=Cw(s),s._a?(l=s._isUTC?v(s._a):$e(s._a),this._isDSTShifted=this.isValid()&&dO(s._a,l.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function yO(){return this.isValid()?!this._isUTC:!1}function SO(){return this.isValid()?this._isUTC:!1}function Rw(){return this.isValid()?this._isUTC&&this._offset===0:!1}var RO=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,TO=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function no(s,l){var d=s,h=null,b,T,A;return hc(s)?d={ms:s._milliseconds,d:s._days,M:s._months}:u(s)||!isNaN(+s)?(d={},l?d[l]=+s:d.milliseconds=+s):(h=RO.exec(s))?(b=h[1]==="-"?-1:1,d={y:0,d:fe(h[Sr])*b,h:fe(h[ot])*b,m:fe(h[pr])*b,s:fe(h[to])*b,ms:fe(Rh(h[zo]*1e3))*b}):(h=TO.exec(s))?(b=h[1]==="-"?-1:1,d={y:un(h[2],b),M:un(h[3],b),w:un(h[4],b),d:un(h[5],b),h:un(h[6],b),m:un(h[7],b),s:un(h[8],b)}):d==null?d={}:typeof d=="object"&&("from"in d||"to"in d)&&(A=xO($e(d.from),$e(d.to)),d={},d.ms=A.milliseconds,d.M=A.months),T=new dc(d),hc(s)&&i(s,"_locale")&&(T._locale=s._locale),hc(s)&&i(s,"_isValid")&&(T._isValid=s._isValid),T}no.fn=dc.prototype,no.invalid=uO;function un(s,l){var d=s&&parseFloat(s.replace(",","."));return(isNaN(d)?0:d)*l}function Tw(s,l){var d={};return d.months=l.month()-s.month()+(l.year()-s.year())*12,s.clone().add(d.months,"M").isAfter(l)&&--d.months,d.milliseconds=+l-+s.clone().add(d.months,"M"),d}function xO(s,l){var d;return s.isValid()&&l.isValid()?(l=xh(l,s),s.isBefore(l)?d=Tw(s,l):(d=Tw(l,s),d.milliseconds=-d.milliseconds,d.months=-d.months),d):{milliseconds:0,months:0}}function xw(s,l){return function(d,h){var b,T;return h!==null&&!isNaN(+h)&&(rt(l,"moment()."+l+"(period, number) is deprecated. Please use moment()."+l+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),T=d,d=h,h=T),b=no(d,h),Ew(this,b,s),this}}function Ew(s,l,d,h){var b=l._milliseconds,T=Rh(l._days),A=Rh(l._months);s.isValid()&&(h=h??!0,A&&ln(s,Ze(s,"Month")+A*d),T&&ta(s,"Date",Ze(s,"Date")+T*d),b&&s._d.setTime(s._d.valueOf()+b*d),h&&e.updateOffset(s,T||A))}var EO=xw(1,"add"),_O=xw(-1,"subtract");function _w(s){return typeof s=="string"||s instanceof String}function OO(s){return J(s)||m(s)||_w(s)||u(s)||IO(s)||MO(s)||s===null||s===void 0}function MO(s){var l=n(s)&&!a(s),d=!1,h=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],b,T,A=h.length;for(b=0;b<A;b+=1)T=h[b],d=d||i(s,T);return l&&d}function IO(s){var l=o(s),d=!1;return l&&(d=s.filter(function(h){return!u(h)&&_w(s)}).length===0),l&&d}function HO(s){var l=n(s)&&!a(s),d=!1,h=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],b,T;for(b=0;b<h.length;b+=1)T=h[b],d=d||i(s,T);return l&&d}function AO(s,l){var d=s.diff(l,"days",!0);return d<-6?"sameElse":d<-1?"lastWeek":d<0?"lastDay":d<1?"sameDay":d<2?"nextDay":d<7?"nextWeek":"sameElse"}function NO(s,l){arguments.length===1&&(arguments[0]?OO(arguments[0])?(s=arguments[0],l=void 0):HO(arguments[0])&&(l=arguments[0],s=void 0):(s=void 0,l=void 0));var d=s||$e(),h=xh(d,this).startOf("day"),b=e.calendarFormat(this,h)||"sameElse",T=l&&(Ne(l[b])?l[b].call(this,d):l[b]);return this.format(T||this.localeData().calendar(b,this,$e(d)))}function kO(){return new de(this)}function PO(s,l){var d=J(s)?s:$e(s);return this.isValid()&&d.isValid()?(l=Ae(l)||"millisecond",l==="millisecond"?this.valueOf()>d.valueOf():d.valueOf()<this.clone().startOf(l).valueOf()):!1}function DO(s,l){var d=J(s)?s:$e(s);return this.isValid()&&d.isValid()?(l=Ae(l)||"millisecond",l==="millisecond"?this.valueOf()<d.valueOf():this.clone().endOf(l).valueOf()<d.valueOf()):!1}function LO(s,l,d,h){var b=J(s)?s:$e(s),T=J(l)?l:$e(l);return this.isValid()&&b.isValid()&&T.isValid()?(h=h||"()",(h[0]==="("?this.isAfter(b,d):!this.isBefore(b,d))&&(h[1]===")"?this.isBefore(T,d):!this.isAfter(T,d))):!1}function FO(s,l){var d=J(s)?s:$e(s),h;return this.isValid()&&d.isValid()?(l=Ae(l)||"millisecond",l==="millisecond"?this.valueOf()===d.valueOf():(h=d.valueOf(),this.clone().startOf(l).valueOf()<=h&&h<=this.clone().endOf(l).valueOf())):!1}function VO(s,l){return this.isSame(s,l)||this.isAfter(s,l)}function WO(s,l){return this.isSame(s,l)||this.isBefore(s,l)}function BO(s,l,d){var h,b,T;if(!this.isValid())return NaN;if(h=xh(s,this),!h.isValid())return NaN;switch(b=(h.utcOffset()-this.utcOffset())*6e4,l=Ae(l),l){case"year":T=fc(this,h)/12;break;case"month":T=fc(this,h);break;case"quarter":T=fc(this,h)/3;break;case"second":T=(this-h)/1e3;break;case"minute":T=(this-h)/6e4;break;case"hour":T=(this-h)/36e5;break;case"day":T=(this-h-b)/864e5;break;case"week":T=(this-h-b)/6048e5;break;default:T=this-h}return d?T:Qt(T)}function fc(s,l){if(s.date()<l.date())return-fc(l,s);var d=(l.year()-s.year())*12+(l.month()-s.month()),h=s.clone().add(d,"months"),b,T;return l-h<0?(b=s.clone().add(d-1,"months"),T=(l-h)/(h-b)):(b=s.clone().add(d+1,"months"),T=(l-h)/(b-h)),-(d+T)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function UO(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function jO(s){if(!this.isValid())return null;var l=s!==!0,d=l?this.clone().utc():this;return d.year()<0||d.year()>9999?M(d,l?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ne(Date.prototype.toISOString)?l?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",M(d,"Z")):M(d,l?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function zO(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var s="moment",l="",d,h,b,T;return this.isLocal()||(s=this.utcOffset()===0?"moment.utc":"moment.parseZone",l="Z"),d="["+s+'("]',h=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",b="-MM-DD[T]HH:mm:ss.SSS",T=l+'[")]',this.format(d+h+b+T)}function YO(s){s||(s=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var l=M(this,s);return this.localeData().postformat(l)}function qO(s,l){return this.isValid()&&(J(s)&&s.isValid()||$e(s).isValid())?no({to:this,from:s}).locale(this.locale()).humanize(!l):this.localeData().invalidDate()}function GO(s){return this.from($e(),s)}function $O(s,l){return this.isValid()&&(J(s)&&s.isValid()||$e(s).isValid())?no({from:this,to:s}).locale(this.locale()).humanize(!l):this.localeData().invalidDate()}function KO(s){return this.to($e(),s)}function Ow(s){var l;return s===void 0?this._locale._abbr:(l=Xo(s),l!=null&&(this._locale=l),this)}var Mw=q("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(s){return s===void 0?this.localeData():this.locale(s)});function Iw(){return this._locale}var mc=1e3,os=60*mc,pc=60*os,Hw=(365*400+97)*24*pc;function is(s,l){return(s%l+l)%l}function Aw(s,l,d){return s<100&&s>=0?new Date(s+400,l,d)-Hw:new Date(s,l,d).valueOf()}function Nw(s,l,d){return s<100&&s>=0?Date.UTC(s+400,l,d)-Hw:Date.UTC(s,l,d)}function XO(s){var l,d;if(s=Ae(s),s===void 0||s==="millisecond"||!this.isValid())return this;switch(d=this._isUTC?Nw:Aw,s){case"year":l=d(this.year(),0,1);break;case"quarter":l=d(this.year(),this.month()-this.month()%3,1);break;case"month":l=d(this.year(),this.month(),1);break;case"week":l=d(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":l=d(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":l=d(this.year(),this.month(),this.date());break;case"hour":l=this._d.valueOf(),l-=is(l+(this._isUTC?0:this.utcOffset()*os),pc);break;case"minute":l=this._d.valueOf(),l-=is(l,os);break;case"second":l=this._d.valueOf(),l-=is(l,mc);break}return this._d.setTime(l),e.updateOffset(this,!0),this}function QO(s){var l,d;if(s=Ae(s),s===void 0||s==="millisecond"||!this.isValid())return this;switch(d=this._isUTC?Nw:Aw,s){case"year":l=d(this.year()+1,0,1)-1;break;case"quarter":l=d(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":l=d(this.year(),this.month()+1,1)-1;break;case"week":l=d(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":l=d(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":l=d(this.year(),this.month(),this.date()+1)-1;break;case"hour":l=this._d.valueOf(),l+=pc-is(l+(this._isUTC?0:this.utcOffset()*os),pc)-1;break;case"minute":l=this._d.valueOf(),l+=os-is(l,os)-1;break;case"second":l=this._d.valueOf(),l+=mc-is(l,mc)-1;break}return this._d.setTime(l),e.updateOffset(this,!0),this}function ZO(){return this._d.valueOf()-(this._offset||0)*6e4}function JO(){return Math.floor(this.valueOf()/1e3)}function eM(){return new Date(this.valueOf())}function tM(){var s=this;return[s.year(),s.month(),s.date(),s.hour(),s.minute(),s.second(),s.millisecond()]}function rM(){var s=this;return{years:s.year(),months:s.month(),date:s.date(),hours:s.hours(),minutes:s.minutes(),seconds:s.seconds(),milliseconds:s.milliseconds()}}function oM(){return this.isValid()?this.toISOString():null}function iM(){return N(this)}function nM(){return C({},R(this))}function sM(){return R(this).overflow}function aM(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}w("N",0,0,"eraAbbr"),w("NN",0,0,"eraAbbr"),w("NNN",0,0,"eraAbbr"),w("NNNN",0,0,"eraName"),w("NNNNN",0,0,"eraNarrow"),w("y",["y",1],"yo","eraYear"),w("y",["yy",2],0,"eraYear"),w("y",["yyy",3],0,"eraYear"),w("y",["yyyy",4],0,"eraYear"),G("N",_h),G("NN",_h),G("NNN",_h),G("NNNN",bM),G("NNNNN",CM),Pe(["N","NN","NNN","NNNN","NNNNN"],function(s,l,d,h){var b=d._locale.erasParse(s,h,d._strict);b?R(d).era=b:R(d).invalidEra=s}),G("y",dt),G("yy",dt),G("yyy",dt),G("yyyy",dt),G("yo",vM),Pe(["y","yy","yyy","yyyy"],_t),Pe(["yo"],function(s,l,d,h){var b;d._locale._eraYearOrdinalRegex&&(b=s.match(d._locale._eraYearOrdinalRegex)),d._locale.eraYearOrdinalParse?l[_t]=d._locale.eraYearOrdinalParse(s,b):l[_t]=parseInt(s,10)});function lM(s,l){var d,h,b,T=this._eras||Xo("en")._eras;for(d=0,h=T.length;d<h;++d){switch(typeof T[d].since){case"string":b=e(T[d].since).startOf("day"),T[d].since=b.valueOf();break}switch(typeof T[d].until){case"undefined":T[d].until=1/0;break;case"string":b=e(T[d].until).startOf("day").valueOf(),T[d].until=b.valueOf();break}}return T}function cM(s,l,d){var h,b,T=this.eras(),A,$,ne;for(s=s.toUpperCase(),h=0,b=T.length;h<b;++h)if(A=T[h].name.toUpperCase(),$=T[h].abbr.toUpperCase(),ne=T[h].narrow.toUpperCase(),d)switch(l){case"N":case"NN":case"NNN":if($===s)return T[h];break;case"NNNN":if(A===s)return T[h];break;case"NNNNN":if(ne===s)return T[h];break}else if([A,$,ne].indexOf(s)>=0)return T[h]}function uM(s,l){var d=s.since<=s.until?1:-1;return l===void 0?e(s.since).year():e(s.since).year()+(l-s.offset)*d}function dM(){var s,l,d,h=this.localeData().eras();for(s=0,l=h.length;s<l;++s)if(d=this.clone().startOf("day").valueOf(),h[s].since<=d&&d<=h[s].until||h[s].until<=d&&d<=h[s].since)return h[s].name;return""}function hM(){var s,l,d,h=this.localeData().eras();for(s=0,l=h.length;s<l;++s)if(d=this.clone().startOf("day").valueOf(),h[s].since<=d&&d<=h[s].until||h[s].until<=d&&d<=h[s].since)return h[s].narrow;return""}function fM(){var s,l,d,h=this.localeData().eras();for(s=0,l=h.length;s<l;++s)if(d=this.clone().startOf("day").valueOf(),h[s].since<=d&&d<=h[s].until||h[s].until<=d&&d<=h[s].since)return h[s].abbr;return""}function mM(){var s,l,d,h,b=this.localeData().eras();for(s=0,l=b.length;s<l;++s)if(d=b[s].since<=b[s].until?1:-1,h=this.clone().startOf("day").valueOf(),b[s].since<=h&&h<=b[s].until||b[s].until<=h&&h<=b[s].since)return(this.year()-e(b[s].since).year())*d+b[s].offset;return this.year()}function pM(s){return i(this,"_erasNameRegex")||Oh.call(this),s?this._erasNameRegex:this._erasRegex}function gM(s){return i(this,"_erasAbbrRegex")||Oh.call(this),s?this._erasAbbrRegex:this._erasRegex}function wM(s){return i(this,"_erasNarrowRegex")||Oh.call(this),s?this._erasNarrowRegex:this._erasRegex}function _h(s,l){return l.erasAbbrRegex(s)}function bM(s,l){return l.erasNameRegex(s)}function CM(s,l){return l.erasNarrowRegex(s)}function vM(s,l){return l._eraYearOrdinalRegex||dt}function Oh(){var s=[],l=[],d=[],h=[],b,T,A,$,ne,xe=this.eras();for(b=0,T=xe.length;b<T;++b)A=ht(xe[b].name),$=ht(xe[b].abbr),ne=ht(xe[b].narrow),l.push(A),s.push($),d.push(ne),h.push(A),h.push($),h.push(ne);this._erasRegex=new RegExp("^("+h.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+l.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+d.join("|")+")","i")}w(0,["gg",2],0,function(){return this.weekYear()%100}),w(0,["GG",2],0,function(){return this.isoWeekYear()%100});function gc(s,l){w(0,[s,s.length],0,l)}gc("gggg","weekYear"),gc("ggggg","weekYear"),gc("GGGG","isoWeekYear"),gc("GGGGG","isoWeekYear"),G("G",Xt),G("g",Xt),G("GG",U,Be),G("gg",U,Be),G("GGGG",Ue,B),G("gggg",Ue,B),G("GGGGG",Ct,W),G("ggggg",Ct,W),on(["gggg","ggggg","GGGG","GGGGG"],function(s,l,d,h){l[h.substr(0,2)]=fe(s)}),on(["gg","GG"],function(s,l,d,h){l[h]=e.parseTwoDigitYear(s)});function yM(s){return kw.call(this,s,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function SM(s){return kw.call(this,s,this.isoWeek(),this.isoWeekday(),1,4)}function RM(){return Ar(this.year(),1,4)}function TM(){return Ar(this.isoWeekYear(),1,4)}function xM(){var s=this.localeData()._week;return Ar(this.year(),s.dow,s.doy)}function EM(){var s=this.localeData()._week;return Ar(this.weekYear(),s.dow,s.doy)}function kw(s,l,d,h,b){var T;return s==null?yi(this,h,b).year:(T=Ar(s,h,b),l>T&&(l=T),_M.call(this,s,l,d,h,b))}function _M(s,l,d,h,b){var T=ca(s,l,d,h,b),A=Vr(T.year,0,T.dayOfYear);return this.year(A.getUTCFullYear()),this.month(A.getUTCMonth()),this.date(A.getUTCDate()),this}w("Q",0,"Qo","quarter"),G("Q",mr),Pe("Q",function(s,l){l[vt]=(fe(s)-1)*3});function OM(s){return s==null?Math.ceil((this.month()+1)/3):this.month((s-1)*3+this.month()%3)}w("D",["DD",2],"Do","date"),G("D",U,eo),G("DD",U,Be),G("Do",function(s,l){return s?l._dayOfMonthOrdinalParse||l._ordinalParse:l._dayOfMonthOrdinalParseLenient}),Pe(["D","DD"],Sr),Pe("Do",function(s,l){l[Sr]=fe(s.match(U)[0])});var Pw=Yo("Date",!0);w("DDD",["DDDD",3],"DDDo","dayOfYear"),G("DDD",ut),G("DDDD",Jr),Pe(["DDD","DDDD"],function(s,l,d){d._dayOfYear=fe(s)});function MM(s){var l=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return s==null?l:this.add(s-l,"d")}w("m",["mm",2],0,"minute"),G("m",U,Zs),G("mm",U,Be),Pe(["m","mm"],pr);var IM=Yo("Minutes",!1);w("s",["ss",2],0,"second"),G("s",U,Zs),G("ss",U,Be),Pe(["s","ss"],to);var HM=Yo("Seconds",!1);w("S",0,0,function(){return~~(this.millisecond()/100)}),w(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),w(0,["SSS",3],0,"millisecond"),w(0,["SSSS",4],0,function(){return this.millisecond()*10}),w(0,["SSSSS",5],0,function(){return this.millisecond()*100}),w(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),w(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),w(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),w(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),G("S",ut,mr),G("SS",ut,Be),G("SSS",ut,Jr);var Ti,Dw;for(Ti="SSSS";Ti.length<=9;Ti+="S")G(Ti,dt);function AM(s,l){l[zo]=fe(("0."+s)*1e3)}for(Ti="S";Ti.length<=9;Ti+="S")Pe(Ti,AM);Dw=Yo("Milliseconds",!1),w("z",0,0,"zoneAbbr"),w("zz",0,0,"zoneName");function NM(){return this._isUTC?"UTC":""}function kM(){return this._isUTC?"Coordinated Universal Time":""}var D=de.prototype;D.add=EO,D.calendar=NO,D.clone=kO,D.diff=BO,D.endOf=QO,D.format=YO,D.from=qO,D.fromNow=GO,D.to=$O,D.toNow=KO,D.get=it,D.invalidAt=sM,D.isAfter=PO,D.isBefore=DO,D.isBetween=LO,D.isSame=FO,D.isSameOrAfter=VO,D.isSameOrBefore=WO,D.isValid=iM,D.lang=Mw,D.locale=Ow,D.localeData=Iw,D.max=iO,D.min=oO,D.parsingFlags=nM,D.set=sn,D.startOf=XO,D.subtract=_O,D.toArray=tM,D.toObject=rM,D.toDate=eM,D.toISOString=jO,D.inspect=zO,typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),D.toJSON=oM,D.toString=UO,D.unix=JO,D.valueOf=ZO,D.creationData=aM,D.eraName=dM,D.eraNarrow=hM,D.eraAbbr=fM,D.eraYear=mM,D.year=$n,D.isLeapYear=yt,D.weekYear=yM,D.isoWeekYear=SM,D.quarter=D.quarters=OM,D.month=aa,D.daysInMonth=ec,D.week=D.weeks=Si,D.isoWeek=D.isoWeeks=ua,D.weeksInYear=xM,D.weeksInWeekYear=EM,D.isoWeeksInYear=RM,D.isoWeeksInISOWeekYear=TM,D.date=Pw,D.day=D.days=fa,D.weekday=wh,D.isoWeekday=Rr,D.dayOfYear=MM,D.hour=D.hours=bh,D.minute=D.minutes=IM,D.second=D.seconds=HM,D.millisecond=D.milliseconds=Dw,D.utcOffset=fO,D.utc=pO,D.local=gO,D.parseZone=wO,D.hasAlignedHourOffset=bO,D.isDST=CO,D.isLocal=yO,D.isUtcOffset=SO,D.isUtc=Rw,D.isUTC=Rw,D.zoneAbbr=NM,D.zoneName=kM,D.dates=q("dates accessor is deprecated. Use date instead.",Pw),D.months=q("months accessor is deprecated. Use month instead",aa),D.years=q("years accessor is deprecated. Use year instead",$n),D.zone=q("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mO),D.isDSTShifted=q("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",vO);function PM(s){return $e(s*1e3)}function DM(){return $e.apply(null,arguments).parseZone()}function Lw(s){return s}var Ie=Me.prototype;Ie.calendar=Bt,Ie.longDateFormat=K,Ie.invalidDate=z,Ie.ordinal=ve,Ie.preparse=Lw,Ie.postformat=Lw,Ie.relativeTime=xt,Ie.pastFuture=Et,Ie.set=Kt,Ie.eras=lM,Ie.erasParse=cM,Ie.erasConvertYear=uM,Ie.erasAbbrRegex=gM,Ie.erasNameRegex=pM,Ie.erasNarrowRegex=wM,Ie.months=na,Ie.monthsShort=sa,Ie.monthsParse=Kn,Ie.monthsRegex=la,Ie.monthsShortRegex=hh,Ie.week=tc,Ie.firstDayOfYear=ro,Ie.firstDayOfWeek=Qn,Ie.weekdays=ha,Ie.weekdaysMin=nc,Ie.weekdaysShort=ic,Ie.weekdaysParse=Zn,Ie.weekdaysRegex=Jn,Ie.weekdaysShortRegex=sc,Ie.weekdaysMinRegex=ac,Ie.isPM=lc,Ie.meridiem=Z;function wc(s,l,d,h){var b=Xo(),T=v().set(h,l);return b[d](T,s)}function Fw(s,l,d){if(u(s)&&(l=s,s=void 0),s=s||"",l!=null)return wc(s,l,d,"month");var h,b=[];for(h=0;h<12;h++)b[h]=wc(s,h,d,"month");return b}function Mh(s,l,d,h){typeof s=="boolean"?(u(l)&&(d=l,l=void 0),l=l||""):(l=s,d=l,s=!1,u(l)&&(d=l,l=void 0),l=l||"");var b=Xo(),T=s?b._week.dow:0,A,$=[];if(d!=null)return wc(l,(d+T)%7,h,"day");for(A=0;A<7;A++)$[A]=wc(l,(A+T)%7,h,"day");return $}function LM(s,l){return Fw(s,l,"months")}function FM(s,l){return Fw(s,l,"monthsShort")}function VM(s,l,d){return Mh(s,l,d,"weekdays")}function WM(s,l,d){return Mh(s,l,d,"weekdaysShort")}function BM(s,l,d){return Mh(s,l,d,"weekdaysMin")}Wr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(s){var l=s%10,d=fe(s%100/10)===1?"th":l===1?"st":l===2?"nd":l===3?"rd":"th";return s+d}}),e.lang=q("moment.lang is deprecated. Use moment.locale instead.",Wr),e.langData=q("moment.langData is deprecated. Use moment.localeData instead.",Xo);var Qo=Math.abs;function UM(){var s=this._data;return this._milliseconds=Qo(this._milliseconds),this._days=Qo(this._days),this._months=Qo(this._months),s.milliseconds=Qo(s.milliseconds),s.seconds=Qo(s.seconds),s.minutes=Qo(s.minutes),s.hours=Qo(s.hours),s.months=Qo(s.months),s.years=Qo(s.years),this}function Vw(s,l,d,h){var b=no(l,d);return s._milliseconds+=h*b._milliseconds,s._days+=h*b._days,s._months+=h*b._months,s._bubble()}function jM(s,l){return Vw(this,s,l,1)}function zM(s,l){return Vw(this,s,l,-1)}function Ww(s){return s<0?Math.floor(s):Math.ceil(s)}function YM(){var s=this._milliseconds,l=this._days,d=this._months,h=this._data,b,T,A,$,ne;return s>=0&&l>=0&&d>=0||s<=0&&l<=0&&d<=0||(s+=Ww(Ih(d)+l)*864e5,l=0,d=0),h.milliseconds=s%1e3,b=Qt(s/1e3),h.seconds=b%60,T=Qt(b/60),h.minutes=T%60,A=Qt(T/60),h.hours=A%24,l+=Qt(A/24),ne=Qt(Bw(l)),d+=ne,l-=Ww(Ih(ne)),$=Qt(d/12),d%=12,h.days=l,h.months=d,h.years=$,this}function Bw(s){return s*4800/146097}function Ih(s){return s*146097/4800}function qM(s){if(!this.isValid())return NaN;var l,d,h=this._milliseconds;if(s=Ae(s),s==="month"||s==="quarter"||s==="year")switch(l=this._days+h/864e5,d=this._months+Bw(l),s){case"month":return d;case"quarter":return d/3;case"year":return d/12}else switch(l=this._days+Math.round(Ih(this._months)),s){case"week":return l/7+h/6048e5;case"day":return l+h/864e5;case"hour":return l*24+h/36e5;case"minute":return l*1440+h/6e4;case"second":return l*86400+h/1e3;case"millisecond":return Math.floor(l*864e5)+h;default:throw new Error("Unknown unit "+s)}}function Zo(s){return function(){return this.as(s)}}var Uw=Zo("ms"),GM=Zo("s"),$M=Zo("m"),KM=Zo("h"),XM=Zo("d"),QM=Zo("w"),ZM=Zo("M"),JM=Zo("Q"),eI=Zo("y"),tI=Uw;function rI(){return no(this)}function oI(s){return s=Ae(s),this.isValid()?this[s+"s"]():NaN}function dn(s){return function(){return this.isValid()?this._data[s]:NaN}}var iI=dn("milliseconds"),nI=dn("seconds"),sI=dn("minutes"),aI=dn("hours"),lI=dn("days"),cI=dn("months"),uI=dn("years");function dI(){return Qt(this.days()/7)}var Jo=Math.round,ns={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function hI(s,l,d,h,b){return b.relativeTime(l||1,!!d,s,h)}function fI(s,l,d,h){var b=no(s).abs(),T=Jo(b.as("s")),A=Jo(b.as("m")),$=Jo(b.as("h")),ne=Jo(b.as("d")),xe=Jo(b.as("M")),gr=Jo(b.as("w")),ei=Jo(b.as("y")),xi=T<=d.ss&&["s",T]||T<d.s&&["ss",T]||A<=1&&["m"]||A<d.m&&["mm",A]||$<=1&&["h"]||$<d.h&&["hh",$]||ne<=1&&["d"]||ne<d.d&&["dd",ne];return d.w!=null&&(xi=xi||gr<=1&&["w"]||gr<d.w&&["ww",gr]),xi=xi||xe<=1&&["M"]||xe<d.M&&["MM",xe]||ei<=1&&["y"]||["yy",ei],xi[2]=l,xi[3]=+s>0,xi[4]=h,hI.apply(null,xi)}function mI(s){return s===void 0?Jo:typeof s=="function"?(Jo=s,!0):!1}function pI(s,l){return ns[s]===void 0?!1:l===void 0?ns[s]:(ns[s]=l,s==="s"&&(ns.ss=l-1),!0)}function gI(s,l){if(!this.isValid())return this.localeData().invalidDate();var d=!1,h=ns,b,T;return typeof s=="object"&&(l=s,s=!1),typeof s=="boolean"&&(d=s),typeof l=="object"&&(h=Object.assign({},ns,l),l.s!=null&&l.ss==null&&(h.ss=l.s-1)),b=this.localeData(),T=fI(this,!d,h,b),d&&(T=b.pastFuture(+this,T)),b.postformat(T)}var Hh=Math.abs;function ss(s){return(s>0)-(s<0)||+s}function bc(){if(!this.isValid())return this.localeData().invalidDate();var s=Hh(this._milliseconds)/1e3,l=Hh(this._days),d=Hh(this._months),h,b,T,A,$=this.asSeconds(),ne,xe,gr,ei;return $?(h=Qt(s/60),b=Qt(h/60),s%=60,h%=60,T=Qt(d/12),d%=12,A=s?s.toFixed(3).replace(/\.?0+$/,""):"",ne=$<0?"-":"",xe=ss(this._months)!==ss($)?"-":"",gr=ss(this._days)!==ss($)?"-":"",ei=ss(this._milliseconds)!==ss($)?"-":"",ne+"P"+(T?xe+T+"Y":"")+(d?xe+d+"M":"")+(l?gr+l+"D":"")+(b||h||s?"T":"")+(b?ei+b+"H":"")+(h?ei+h+"M":"")+(s?ei+A+"S":"")):"P0D"}var _e=dc.prototype;_e.isValid=cO,_e.abs=UM,_e.add=jM,_e.subtract=zM,_e.as=qM,_e.asMilliseconds=Uw,_e.asSeconds=GM,_e.asMinutes=$M,_e.asHours=KM,_e.asDays=XM,_e.asWeeks=QM,_e.asMonths=ZM,_e.asQuarters=JM,_e.asYears=eI,_e.valueOf=tI,_e._bubble=YM,_e.clone=rI,_e.get=oI,_e.milliseconds=iI,_e.seconds=nI,_e.minutes=sI,_e.hours=aI,_e.days=lI,_e.weeks=dI,_e.months=cI,_e.years=uI,_e.humanize=gI,_e.toISOString=bc,_e.toString=bc,_e.toJSON=bc,_e.locale=Ow,_e.localeData=Iw,_e.toIsoString=q("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bc),_e.lang=Mw,w("X",0,0,"unix"),w("x",0,0,"valueOf"),G("x",Xt),G("X",Yn),Pe("X",function(s,l,d){d._d=new Date(parseFloat(s)*1e3)}),Pe("x",function(s,l,d){d._d=new Date(fe(s))});return e.version="2.30.1",t($e),e.fn=D,e.min=nO,e.max=sO,e.now=aO,e.utc=v,e.unix=PM,e.months=LM,e.isDate=m,e.locale=Wr,e.invalid=I,e.duration=no,e.isMoment=J,e.weekdays=VM,e.parseZone=DM,e.localeData=Xo,e.isDuration=hc,e.monthsShort=FM,e.weekdaysMin=BM,e.defineLocale=ts,e.updateLocale=gw,e.locales=L_,e.weekdaysShort=WM,e.normalizeUnits=Ae,e.relativeTimeRounding=mI,e.relativeTimeThreshold=pI,e.calendarFormat=AO,e.prototype=D,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var aT=H((aY,sT)=>{"use strict";var mD=ft(),oT=If(),pD=Dt(),iT=Ai(),gD=ka(),nT=mD([].push);sT.exports=function(r){if(pD(r))return r;if(oT(r)){for(var e=r.length,t=[],o=0;o<e;o++){var n=r[o];typeof n=="string"?nT(t,n):(typeof n=="number"||iT(n)==="Number"||iT(n)==="String")&&nT(t,gD(n))}var i=t.length,a=!0;return function(c,u){if(a)return a=!1,u;if(oT(this))return u;for(var m=0;m<i;m++)if(t[m]===c)return u}}}});var CT=H(()=>{"use strict";var wD=er(),pT=gn(),gT=Na(),bD=Ao(),$a=ft(),wT=Cr(),lT=Dt(),cT=kc(),bT=Jc(),CD=aT(),vD=Nc(),yD=String,ji=pT("JSON","stringify"),mu=$a(/./.exec),uT=$a("".charAt),SD=$a("".charCodeAt),RD=$a("".replace),TD=$a(1 .toString),xD=/[\uD800-\uDFFF]/g,dT=/^[\uD800-\uDBFF]$/,hT=/^[\uDC00-\uDFFF]$/,fT=!vD||wT(function(){var r=pT("Symbol")("stringify detection");return ji([r])!=="[null]"||ji({a:r})!=="{}"||ji(Object(r))!=="{}"}),mT=wT(function(){return ji("\uDF06\uD834")!=='"\\udf06\\ud834"'||ji("\uDEAD")!=='"\\udead"'}),ED=function(r,e){var t=bT(arguments),o=CD(e);if(!(!lT(o)&&(r===void 0||cT(r))))return t[1]=function(n,i){if(lT(o)&&(i=bD(o,this,yD(n),i)),!cT(i))return i},gT(ji,null,t)},_D=function(r,e,t){var o=uT(t,e-1),n=uT(t,e+1);return mu(dT,r)&&!mu(hT,n)||mu(hT,r)&&!mu(dT,o)?"\\u"+TD(SD(r,0),16):r};ji&&wD({target:"JSON",stat:!0,arity:3,forced:fT||mT},{stringify:function(e,t,o){var n=bT(arguments),i=gT(fT?ED:ji,null,n);return mT&&typeof i=="string"?RD(i,xD,_D):i}})});var kT=H((TY,NT)=>{"use strict";var HD=Tf(),AD=Gc();NT.exports=Object.keys||function(e){return HD(e,AD)}});var DT=H(PT=>{"use strict";var ND=lo(),kD=cf(),PD=bn(),DD=Ni(),LD=_a(),FD=kT();PT.f=ND&&!kD?Object.defineProperties:function(e,t){DD(e);for(var o=LD(t),n=FD(t),i=n.length,a=0,c;i>a;)PD.f(e,c=n[a++],o[c]);return e}});var zT=H((EY,jT)=>{"use strict";var VD=Ni(),WD=DT(),LT=Gc(),BD=Bc(),UD=Pf(),jD=Vc(),zD=wf(),FT=">",VT="<",um="prototype",dm="script",BT=zD("IE_PROTO"),cm=function(){},UT=function(r){return VT+dm+FT+r+VT+"/"+dm+FT},WT=function(r){r.write(UT("")),r.close();var e=r.parentWindow.Object;return r=null,e},YD=function(){var r=jD("iframe"),e="java"+dm+":",t;return r.style.display="none",UD.appendChild(r),r.src=String(e),t=r.contentWindow.document,t.open(),t.write(UT("document.F=Object")),t.close(),t.F},Su,Ru=function(){try{Su=new ActiveXObject("htmlfile")}catch{}Ru=typeof document<"u"?document.domain&&Su?WT(Su):YD():WT(Su);for(var r=LT.length;r--;)delete Ru[um][LT[r]];return Ru()};BD[BT]=!0;jT.exports=Object.create||function(e,t){var o;return e!==null?(cm[um]=VD(e),o=new cm,cm[um]=null,o[BT]=e):o=Ru(),t===void 0?o:WD.f(o,t)}});var Tu=H((_Y,YT)=>{"use strict";var qD=wn(),GD=zT(),$D=bn().f,hm=qD("unscopables"),fm=Array.prototype;fm[hm]===void 0&&$D(fm,hm,{configurable:!0,value:GD(null)});YT.exports=function(r){fm[hm][r]=!0}});var qT=H(()=>{"use strict";var KD=Tu();KD("flatMap")});var rx=H((dq,tx)=>{"use strict";var bL=co(),CL=Ai(),vL=wn(),yL=vL("match");tx.exports=function(r){var e;return bL(r)&&((e=r[yL])!==void 0?!!e:CL(r)==="RegExp")}});var ix=H((hq,ox)=>{"use strict";var SL=Ni();ox.exports=function(){var r=SL(this),e="";return r.hasIndices&&(e+="d"),r.global&&(e+="g"),r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.dotAll&&(e+="s"),r.unicode&&(e+="u"),r.unicodeSets&&(e+="v"),r.sticky&&(e+="y"),e}});var ax=H((fq,sx)=>{"use strict";var RL=Ao(),TL=ho(),xL=Hc(),EL=ix(),nx=RegExp.prototype;sx.exports=function(r){var e=r.flags;return e===void 0&&!("flags"in nx)&&!TL(r,"flags")&&xL(nx,r)?RL(EL,r):e}});var cx=H((mq,lx)=>{"use strict";var Em=ft(),_L=Ia(),OL=Math.floor,Tm=Em("".charAt),ML=Em("".replace),xm=Em("".slice),IL=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,HL=/\$([$&'`]|\d{1,2})/g;lx.exports=function(r,e,t,o,n,i){var a=t+r.length,c=o.length,u=HL;return n!==void 0&&(n=_L(n),u=IL),ML(i,u,function(m,g){var C;switch(Tm(g,0)){case"$":return"$";case"&":return r;case"`":return xm(e,0,t);case"'":return xm(e,a);case"<":C=n[xm(g,1,-1)];break;default:var v=+g;if(v===0)return m;if(v>c){var y=OL(v/10);return y===0?m:y<=c?o[y-1]===void 0?Tm(g,1):o[y-1]+Tm(g,1):m}C=o[v-1]}return C===void 0?"":C})}});var hx=H(()=>{"use strict";var AL=er(),NL=Ao(),Om=ft(),ux=ds(),kL=Dt(),PL=Ic(),DL=rx(),Ms=ka(),LL=Pc(),FL=ax(),VL=cx(),WL=wn(),BL=Dc(),UL=WL("replace"),jL=TypeError,_m=Om("".indexOf),zL=Om("".replace),dx=Om("".slice),YL=Math.max;AL({target:"String",proto:!0},{replaceAll:function(e,t){var o=ux(this),n,i,a,c,u,m,g,C,v,y,R=0,O="";if(!PL(e)){if(n=DL(e),n&&(i=Ms(ux(FL(e))),!~_m(i,"g")))throw new jL("`.replaceAll` does not allow non-global regexes");if(a=LL(e,UL),a)return NL(a,e,o,t);if(BL&&n)return zL(Ms(o),e,t)}for(c=Ms(o),u=Ms(e),m=kL(t),m||(t=Ms(t)),g=u.length,C=YL(1,g),v=_m(c,u);v!==-1;)y=m?Ms(t(u,v,c)):VL(u,c,v,[],void 0,t),O+=dx(c,R,v)+y,R=v+g,v=v+C>c.length?-1:_m(c,u,v+C);return R<c.length&&(O+=dx(c,R)),O}})});var Ja=H(()=>{"use strict";var cF=er(),uF=Ia(),dF=qc(),hF=ms(),fF=Tu();cF({target:"Array",proto:!0},{at:function(e){var t=uF(this),o=dF(t),n=hF(e),i=n>=0?n:o+n;return i<0||i>=o?void 0:t[i]}});fF("at")});var el=H(()=>{"use strict";var mF=er(),pF=ft(),gF=ds(),wF=ms(),bF=ka(),CF=Cr(),vF=pF("".charAt),yF=CF(function(){return"\u{20BB7}".at(-2)!=="\uD842"});mF({target:"String",proto:!0,forced:yF},{at:function(e){var t=bF(gF(this)),o=t.length,n=wF(e),i=n>=0?n:o+n;return i<0||i>=o?void 0:vF(t,i)}})});var Xx=H(()=>{"use strict";var KV=Tu();KV("flat")});var Uh=[{formName:"404Form"},{formName:"alphabetForm",fields:[{name:"alphabet",type:"select",label:"Alfabeto para la entrada",placeholder:"Ingresa el alfabeto (e.g. a,b,c,\u03BB)",options:[{label:"Ingresa el alfabeto (e.g. a,b,c,\u03BB)",value:""},{label:"n\xFAmeros",value:"0123456789"},{label:"letras min\xFAsculas",value:"abcdefghijklmnopqsrtuvwxyz"},{label:"letras may\xFAsculas",value:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},{label:"letras m y M",value:"mM"},{label:"n\xFAmeros y letras min\xFAsculas",value:"0123456789abcdefghijklmnopqsrtuvwxyz"},{label:"n\xFAmeros y letras may\xFAsculas",value:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"},{label:"n\xFAmeros, letras min\xFAsculas y may\xFAsculas",value:"0123456789abcdefghijklmnopqsrtuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"},{label:"n\xFAmeros, letras min\xFAsculas, may\xFAsculas y m y M",value:"0123456789abcdefghijklmnopqsrtuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZmM"}]}]},{formName:"stateForm",fields:[{name:"state",type:"select",label:"Estado",placeholder:"Ingresa el estado (q1, q2, ...)"},{name:"isInitial",type:"checkbox",label:"Estado inicial q0"},{name:"isFinal",type:"checkbox",label:"Estado final \u03BB"}]},{formName:"transitionForm",fields:[{name:"start",type:"select",label:"Donde inicia",placeholder:"Estado en el que inicia",optios:[]},{name:"end",type:"select",label:"Donde termina",placeholder:"Estado en el que termina",optios:[]},{name:"entry",type:"select",label:"Entrada",placeholder:"Entrada",optios:[]}]},{formName:"entryForm",fields:[{name:"entryChain",type:"text",label:"Cadena a Procesar - Alfabeto de Entrada",placeholder:"Ingresa la entrada de la cadena a procesar"}]},{formName:"turingForm",fields:[{name:"Estados",type:"textarea",label:"Estados",placeholder:"Ingresa los estados Q0, Qf",required:!0},{name:"Estado Inicial Q0",label:"Estado Inicial Q0",type:"text",placeholder:"Ingresa el estado inicial q0"},{name:"Estados Finales",type:"checkboxes",placeholder:"Ingresa el estado final \u03BB",options:[],required:!0},{name:"Simbolo Blanco",label:"Simbolo Blanco",type:"text",hint:"Pertenece al lenguaje de la cinta (Entrada a evaluar)"},{name:"Alfabeto de Entrada",type:"text-alphabet",label:"Alfabeto de Entrada",placeholder:"Ingresa una lista de entradas",required:!0},{name:"Alfabeto Cinta",type:"text-tape",label:"Alfabeto Cinta",placeholder:"Entrada a evaluar",required:!0},{name:"Transiciones",type:"text-transitions",label:"Transiciones",placeholder:"q0 a q1 a S",required:!0,hint:["S: State, L: Left, R:Right","La estructura consta de: [Estado, Leer, Nuevo, Escribir, Movimiento]","Debe ir separada por comas"]},{name:"Transiciones (q0,S,L/S/R)",type:"table",label:"Transiciones (q0,S,L/S/R)"}]}];var CI=["input"],vI=["label"],yI=["*"],SI=new _i("mat-checkbox-default-options",{providedIn:"root",factory:Wb});function Wb(){return{color:"accent",clickAction:"check-indeterminate",disabledInteractive:!1}}var Jt=function(r){return r[r.Init=0]="Init",r[r.Checked=1]="Checked",r[r.Unchecked=2]="Unchecked",r[r.Indeterminate=3]="Indeterminate",r}(Jt||{}),RI={provide:fb,useExisting:Kw(()=>_c),multi:!0},jh=class{},TI=0,Vb=Wb(),_c=(()=>{class r{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){let o=new jh;return o.source=this,o.checked=t,o}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,o,n,i,a,c){this._elementRef=t,this._changeDetectorRef=o,this._ngZone=n,this._animationMode=a,this._options=c,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Tr,this.indeterminateChange=new Tr,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=Jt.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||Vb,this.color=this._options.color||Vb.color,this.tabIndex=parseInt(i)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++TI}`,this.disabledInteractive=c?.disabledInteractive??!1}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){let o=t!=this._indeterminate;this._indeterminate=t,o&&(this._indeterminate?this._transitionCheckState(Jt.Indeterminate):this._transitionCheckState(this.checked?Jt.Checked:Jt.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&t.value!==!0?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let o=this._currentCheckState,n=this._getAnimationTargetElement();if(!(o===t||!n)&&(this._currentAnimationClass&&n.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(o,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){n.classList.add(this._currentAnimationClass);let i=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{n.classList.remove(i)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let t=this._options?.clickAction;!this.disabled&&t!=="noop"?(this.indeterminate&&t!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?Jt.Checked:Jt.Unchecked),this._emitChangeEvent()):(this.disabled&&this.disabledInteractive||!this.disabled&&t==="noop")&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,o){if(this._animationMode==="NoopAnimations")return"";switch(t){case Jt.Init:if(o===Jt.Checked)return this._animationClasses.uncheckedToChecked;if(o==Jt.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case Jt.Unchecked:return o===Jt.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case Jt.Checked:return o===Jt.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case Jt.Indeterminate:return o===Jt.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){let o=this._inputElement;o&&(o.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static{this.\u0275fac=function(o){return new(o||r)(De(Rc),De(pn),De(Sc),yc("tabindex"),De(ba,8),De(SI,8))}}static{this.\u0275cmp=ti({type:r,selectors:[["mat-checkbox"]],viewQuery:function(o,n){if(o&1&&(Io(CI,5),Io(vI,5),Io(Lh,5)),o&2){let i;so(i=ao())&&(n._inputElement=i.first),so(i=ao())&&(n._labelElement=i.first),so(i=ao())&&(n.ripple=i.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:16,hostBindings:function(o,n){o&2&&(rb("id",n.id),ls("tabindex",null)("aria-label",null)("aria-labelledby",null),eb(n.color?"mat-"+n.color:"mat-accent"),fn("_mat-animation-noopable",n._animationMode==="NoopAnimations")("mdc-checkbox--disabled",n.disabled)("mat-mdc-checkbox-disabled",n.disabled)("mat-mdc-checkbox-checked",n.checked)("mat-mdc-checkbox-disabled-interactive",n.disabledInteractive))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],id:"id",required:[2,"required","required",Br],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[2,"disableRipple","disableRipple",Br],tabIndex:[2,"tabIndex","tabIndex",t=>t==null?void 0:Tc(t)],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",Br],checked:[2,"checked","checked",Br],disabled:[2,"disabled","disabled",Br],indeterminate:[2,"indeterminate","indeterminate",Br]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[Ho([RI,{provide:pb,useExisting:r,multi:!0}]),hn,ri,mn],ngContentSelectors:yI,decls:15,vars:20,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(o,n){if(o&1){let i=ii();ya(),ce(0,"div",3),Nr("click",function(c){return wr(i),br(n._preventBubblingFromLabel(c))}),ce(1,"div",4,0)(3,"div",5),Nr("click",function(){return wr(i),br(n._onTouchTargetClick())}),we(),ce(4,"input",6,1),Nr("blur",function(){return wr(i),br(n._onBlur())})("click",function(){return wr(i),br(n._onInputClick())})("change",function(c){return wr(i),br(n._onInteractionEvent(c))}),we(),zt(6,"div",7),ce(7,"div",8),vc(),ce(8,"svg",9),zt(9,"path",10),we(),Xw(),zt(10,"div",11),we(),zt(11,"div",12),we(),ce(12,"label",13,2),ni(14),we()()}if(o&2){let i=ib(2);Le("labelPosition",n.labelPosition),Ee(4),fn("mdc-checkbox--selected",n.checked),Le("checked",n.checked)("indeterminate",n.indeterminate)("disabled",n.disabled&&!n.disabledInteractive)("id",n.inputId)("required",n.required)("tabIndex",n.disabled&&!n.disabledInteractive?-1:n.tabIndex),ls("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby)("aria-checked",n.indeterminate?"mixed":null)("aria-disabled",n.disabled&&n.disabledInteractive?!0:null)("name",n.name)("value",n.value),Ee(7),Le("matRippleTrigger",i)("matRippleDisabled",n.disableRipple||n.disabled)("matRippleCentered",!0),Ee(),Le("for",n.inputId)}},dependencies:[Lh,ub],styles:['.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity));background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity));background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mdc-checkbox__ripple{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-checkbox .mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.cdk-high-contrast-active .mdc-checkbox--disabled{opacity:.5}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1);-webkit-print-color-adjust:exact;color-adjust:exact;border-color:var(--mdc-checkbox-unselected-icon-color, var(--mat-app-on-surface-variant));top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2)}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox__native-control:disabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:disabled:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:not(:checked)~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mat-app-on-surface));background-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-app-primary))}.mdc-checkbox__native-control:focus:focus:not(:checked)~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mat-app-on-surface))}.mdc-checkbox__native-control:focus:focus:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-app-primary))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox:hover .mdc-checkbox__native-control~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.6, 1);color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox--disabled .mdc-checkbox__checkmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.cdk-high-contrast-active .mdc-checkbox--disabled .mdc-checkbox__checkmark,.cdk-high-contrast-active .mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:CanvasText}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.cdk-high-contrast-active .mdc-checkbox__mixedmark{margin:0 1px}.mdc-checkbox--disabled .mdc-checkbox__mixedmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms cubic-bezier(0, 0, 0.2, 1),transform 180ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *,.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox .mat-internal-form-field{color:var(--mat-checkbox-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-checkbox-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-checkbox-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-checkbox-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-checkbox-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-checkbox-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive{pointer-events:auto}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive input{cursor:default}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return r})();var Bb=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=Oi({type:r})}static{this.\u0275inj=Ei({imports:[_c,Sa,Sa]})}}return r})();var Ub=new _i("CdkAccordion");var _I=0,jb=(()=>{class r{get expanded(){return this._expanded}set expanded(t){if(this._expanded!==t){if(this._expanded=t,this.expandedChange.emit(t),t){this.opened.emit();let o=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,o)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(t,o,n){this.accordion=t,this._changeDetectorRef=o,this._expansionDispatcher=n,this._openCloseAllSubscription=Cc.EMPTY,this.closed=new Tr,this.opened=new Tr,this.destroyed=new Tr,this.expandedChange=new Tr,this.id=`cdk-accordion-child-${_I++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=n.listen((i,a)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===a&&this.id!==i&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}static{this.\u0275fac=function(o){return new(o||r)(De(Ub,12),De(pn),De(xc))}}static{this.\u0275dir=as({type:r,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",Br],disabled:[2,"disabled","disabled",Br]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[Ho([{provide:Ub,useValue:void 0}]),hn]})}}return r})(),zb=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=Oi({type:r})}static{this.\u0275inj=Ei({})}}return r})();var II=["body"],HI=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],AI=["mat-expansion-panel-header","*","mat-action-row"];function NI(r,e){}var kI=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],PI=["mat-panel-title","mat-panel-description","*"];function DI(r,e){if(r&1&&(ce(0,"span",1),vc(),ce(1,"svg",2),zt(2,"path",3),we()()),r&2){let t=Ve();Le("@indicatorRotate",t._getExpandedState())}}var Yb=new _i("MAT_ACCORDION"),qb="225ms cubic-bezier(0.4,0.0,0.2,1)",$b={indicatorRotate:Vh("indicatorRotate",[Ta("collapsed, void",Ra({transform:"rotate(0deg)"})),Ta("expanded",Ra({transform:"rotate(180deg)"})),Bh("expanded <=> collapsed, void => collapsed",Wh(qb))]),bodyExpansion:Vh("bodyExpansion",[Ta("collapsed, void",Ra({height:"0px",visibility:"hidden"})),Ta("expanded",Ra({height:"*",visibility:""})),Bh("expanded <=> collapsed, void => collapsed",Wh(qb))])},Kb=new _i("MAT_EXPANSION_PANEL"),LI=(()=>{class r{constructor(t,o){this._template=t,this._expansionPanel=o}static{this.\u0275fac=function(o){return new(o||r)(De(Qw),De(Kb,8))}}static{this.\u0275dir=as({type:r,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return r})(),FI=0,Xb=new _i("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),zh=(()=>{class r extends jb{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}constructor(t,o,n,i,a,c,u){super(t,o,n),this._viewContainerRef=i,this._animationMode=c,this._hideToggle=!1,this.afterExpand=new Tr,this.afterCollapse=new Tr,this._inputChanges=new Ah,this._headerId=`mat-expansion-panel-header-${FI++}`,this.accordion=t,this._document=a,this._animationsDisabled=c==="NoopAnimations",u&&(this.hideToggle=u.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe($w(null),wa(()=>this.expanded&&!this._portal),Gw(1)).subscribe(()=>{this._portal=new Db(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){let t=this._document.activeElement,o=this._body.nativeElement;return t===o||o.contains(t)}return!1}_animationStarted(t){!Gb(t)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(t){Gb(t)||(t.toState==="expanded"?this.afterExpand.emit():t.toState==="collapsed"&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(o){return new(o||r)(De(Yb,12),De(pn),De(xc),De(Zw),De(nb),De(ba,8),De(Xb,8))}}static{this.\u0275cmp=ti({type:r,selectors:[["mat-expansion-panel"]],contentQueries:function(o,n,i){if(o&1&&ob(i,LI,5),o&2){let a;so(a=ao())&&(n._lazyContent=a.first)}},viewQuery:function(o,n){if(o&1&&Io(II,5),o&2){let i;so(i=ao())&&(n._body=i.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(o,n){o&2&&fn("mat-expanded",n.expanded)("_mat-animation-noopable",n._animationsDisabled)("mat-expansion-panel-spacing",n._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",Br],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[Ho([{provide:Yb,useValue:void 0},{provide:Kb,useExisting:r}]),hn,Ph,ri,mn],ngContentSelectors:AI,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(o,n){if(o&1){let i=ii();ya(HI),ni(0),ce(1,"div",1,0),Nr("@bodyExpansion.start",function(c){return wr(i),br(n._animationStarted(c))})("@bodyExpansion.done",function(c){return wr(i),br(n._animationDone(c))}),ce(3,"div",2),ni(4,1),oi(5,NI,0,0,"ng-template",3),we(),ni(6,2),we()}o&2&&(Ee(),Le("@bodyExpansion",n._getExpandedState())("id",n.id),ls("aria-labelledby",n._headerId),Ee(4),Le("cdkPortalOutlet",n._portal))},dependencies:[Lb],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color, var(--mat-app-surface));color:var(--mat-expansion-container-text-color, var(--mat-app-on-surface));border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font, var(--mat-app-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-app-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-app-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-app-body-large-tracking))}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-app-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[$b.bodyExpansion]},changeDetection:0})}}return r})();function Gb(r){return r.fromState==="void"}var Qb=(()=>{class r{constructor(t,o,n,i,a,c,u){this.panel=t,this._element=o,this._focusMonitor=n,this._changeDetectorRef=i,this._animationMode=c,this._parentChangeSubscription=Cc.EMPTY,this.tabIndex=0;let m=t.accordion?t.accordion._stateChanges.pipe(wa(g=>!!(g.hideToggle||g.togglePosition))):Yw;this.tabIndex=parseInt(u||"")||0,this._parentChangeSubscription=qw(t.opened,t.closed,m,t._inputChanges.pipe(wa(g=>!!(g.hideToggle||g.disabled||g.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(wa(()=>t._containsFocus())).subscribe(()=>n.focusVia(o,"program")),a&&(this.expandedHeight=a.expandedHeight,this.collapsedHeight=a.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:lb(t)||(t.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t);return}}focus(t,o){t?this._focusMonitor.focusVia(this._element,t,o):this._element.nativeElement.focus(o)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(o){return new(o||r)(De(zh,1),De(Rc),De(cb),De(pn),De(Xb,8),De(ba,8),yc("tabindex"))}}static{this.\u0275cmp=ti({type:r,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(o,n){o&1&&Nr("click",function(){return n._toggle()})("keydown",function(a){return n._keydown(a)}),o&2&&(ls("id",n.panel._headerId)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n._getPanelId())("aria-expanded",n._isExpanded())("aria-disabled",n.panel.disabled),Jw("height",n._getHeaderHeight()),fn("mat-expanded",n._isExpanded())("mat-expansion-toggle-indicator-after",n._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",n._getTogglePosition()==="before")("_mat-animation-noopable",n._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>t==null?0:Tc(t)]},standalone:!0,features:[hn,mn],ngContentSelectors:PI,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(o,n){o&1&&(ya(kI),ce(0,"span",0),ni(1),ni(2,1),ni(3,2),we(),oi(4,DI,3,1,"span",1)),o&2&&(fn("mat-content-hide-toggle",!n._showToggle()),Ee(4),Mi(n._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font, var(--mat-app-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-app-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-app-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-app-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-app-title-medium-tracking))}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-app-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-app-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-app-on-surface-variant))}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[$b.indicatorRotate]},changeDetection:0})}}return r})();var Zb=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275dir=as({type:r,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0})}}return r})();var Jb=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=Oi({type:r})}static{this.\u0275inj=Ei({imports:[Sa,zb,Fb]})}}return r})();var are=S(V(),1),lre=S(me(),1),cre=S(tr(),1),ure=S(rr(),1),dre=S(or(),1),hre=S(ir(),1),fre=S(nr(),1),mre=S(sr(),1),pre=S(ar(),1),gre=S(RR(),1);var tY=S(V(),1),rY=S(me(),1);var Z2=S(me(),1),NR=S(TR(),1);var Jf=S(xR(),1);var V2=S(me(),1),W2=S(tr(),1),B2=S(rr(),1),U2=S(or(),1),j2=S(ir(),1),z2=S(nr(),1),Y2=S(sr(),1),q2=S(ar(),1);function ER(r){let e=r.length,t=0;for(;t<e;)r[t]=[r[t]],t+=1}function Xf(r,e){let t=e.length,o=0;for(;o<t;)r.push(e[o]),o+=1}function tu(r){let e=[];if(!r||r.length===0||!r[0]||r[0].length===0)return e;let t=r.length,o=r[0].length;for(let n=0;n<t;n++)for(let i=0;i<o;i++)e[i]||(e[i]=[]),e[i][n]=r[n][i];return e}function Fi(r,e,t,o){let n=-1,i=r,a=t;Array.isArray(r)||(i=Array.from(r));let c=i.length;for(o&&c&&(n+=1,a=i[n]),n+=1;n<c;)a=e(a,i[n],n,i),n+=1;return a}function bs(r,e){let t=0,o=r;Array.isArray(r)||(o=Array.from(r));let n=o.length,i=[],a=-1;for(;t<n;){let c=o[t];e(c,t,o)&&(a+=1,i[a]=c),t+=1}return i}function po(r,e){let t=0,o=r;Array.isArray(r)||(o=Array.from(r));let n=o.length,i=[],a=-1;for(;t<n;){let c=o[t];a+=1,i[a]=e(c,t,o),t+=1}return i}function re(r,e){let t=0,o=r;Array.isArray(r)||(o=Array.from(r));let n=o.length;for(;t<n&&e(o[t],t,o)!==!1;)t+=1;return r}function Qf(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];let[o,...n]=[...e],i=o;return re(n,a=>{i=i.filter(c=>!a.includes(c))}),i}function Zf(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return r.split(e)}function mt(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return Fi(r,(i,a,c)=>{let u=a.replace(/\r?\n\s*/g,""),m=t[c]?t[c]:"";return i+u+m},"").trim()}function ou(r){let e;switch(typeof r){case"string":case"number":e=`${r}`;break;case"object":e=r===null?"":r.toString();break;case"undefined":e="";break;default:e=r.toString();break}return e}function oe(r){return typeof r<"u"}function pt(r){return typeof r>"u"}function ai(r){return r===null||r===""||pt(r)}function HR(r){return Object.prototype.toString.call(r)==="[object RegExp]"}var Fa="length",Va=r=>parseInt(r,16),_R=r=>parseInt(r,10),ru=(r,e,t)=>r.substr(e,t),Wa=r=>r.codePointAt(0)-65,em=r=>`${r}`.replace(/\-/g,""),lD=r=>Va(ru(em(r),Va("12"),Wa("F")))/(Va(ru(em(r),Wa("B"),~~![][Fa]))||9),cD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),OR=!1,MR={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},IR={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function AR(r,e){let t=!ai(r),o=typeof r=="string"&&r.toLowerCase()==="non-commercial-and-evaluation",n="14.6.0",i,a="invalid",c="invalid";r=em(r||"");let u=uD(r);if(t||o||u)if(u){let m=(0,Jf.default)("01/10/2024","DD/MM/YYYY"),g=Math.floor(m.toDate().getTime()/864e5),C=lD(r);i=(0,Jf.default)((C+1)*864e5,"x").format("MMMM DD, YYYY"),g>C?(a="expired",c="expired"):(a="valid",c="valid")}else o?(a="non_commercial",c="valid"):(a="invalid",c="invalid");else a="missing",c="missing";if(cD()&&(a="valid",c="valid"),!OR&&a!=="valid"&&(MR[a]({keyValidityDate:i,hotVersion:n})&&console[a==="non_commercial"?"info":"warn"](MR[a]({keyValidityDate:i,hotVersion:n})),OR=!0),c!=="valid"&&e.parentNode&&IR[c]({keyValidityDate:i,hotVersion:n})){let g=document.createElement("div");g.className="hot-display-license-info",g.innerHTML=IR[c]({keyValidityDate:i,hotVersion:n}),e.parentNode.insertBefore(g,e.nextSibling)}}function uD(r){let e=[][Fa],t=e;if(r[Fa]!==Wa("Z"))return!1;for(let o="",n="B<H4P+".split(""),i=Wa(n.shift());i;i=Wa(n.shift()||"A"))--i<""[Fa]?t=t|(_R(`${_R(Va(o)+(Va(ru(r,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:o=ru(r,i,i?n[Fa]===1?9:8:6);return t===e}function Cs(r){return r[0].toUpperCase()+r.substr(1)}function iu(){function r(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return r()+r()+r()+r()}function kR(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${r}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,o)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[o]===void 0?"":e[o])}function PR(r,e){return NR.default.sanitize(r,e)}var Vi=r=>["tabindex",r],DR=()=>["role","treegrid"],Pr=()=>["role","presentation"],LR=()=>["role","gridcell"],FR=()=>["role","rowheader"],nu=()=>["role","rowgroup"],VR=()=>["role","columnheader"],Ba=()=>["role","row"];var WR=()=>["scope","col"],BR=()=>["scope","row"];var su=()=>["aria-hidden","true"];var UR=()=>["aria-multiselectable","true"];var au=r=>["aria-rowcount",r],vs=r=>["aria-colcount",r],lu=r=>["aria-rowindex",r],ys=r=>["aria-colindex",r];var tm=()=>["aria-readonly","true"],rm=()=>["aria-invalid","true"];var cu=()=>["aria-selected","true"];function jR(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,o=null,n=r;for(;n!==null;){if(t===e){o=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(t+=1,n=n.parentNode)}return o}function zR(r,e){let t=r.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function dD(r){return Object.getPrototypeOf(r.parent)&&r.frameElement}function Ss(r){return dD(r)&&r.parent}function im(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:n}=Node,i=r;for(;i!=null&&i!==t;){let{nodeType:a,nodeName:c}=i;if(a===o&&(e.includes(c)||e.includes(i)))return i;let{host:u}=i;u&&a===n?i=u:i=i.parentNode}return null}function Ua(r,e,t){let o=[],n=r;for(;n&&(n=im(n,e,t),!(!n||t&&!t.contains(n)));)o.push(n),n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:n=n.parentNode;let i=o.length;return i?o[i-1]:null}function ja(r,e){let t=r.parentNode,o=[];for(typeof e=="string"?r.defaultView?o=Array.prototype.slice.call(r.querySelectorAll(e),0):o=Array.prototype.slice.call(r.ownerDocument.querySelectorAll(e),0):o.push(e);t!==null;){if(o.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function YR(r){let e=0,t=r;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Bi(r,e,t){let o=t.parentElement.querySelector(`.ht_clone_${r}`);return o?o.contains(e):null}function qR(r){return!r||!r.length?[]:r.filter(e=>!!e)}function GR(r,e){if(!r||!r.length)return e?{regexFree:[],regexes:[]}:[];let t=[],o=[];return o.push(...r.filter(n=>{let i=n instanceof RegExp;return i&&e&&t.push(n),!i})),e?{regexFree:o,regexes:t}:o}function He(r,e){return r.classList===void 0||typeof e!="string"||e===""?!1:r.classList.contains(e)}function se(r,e){typeof e=="string"&&(e=e.split(" ")),e=qR(e),e.length>0&&r.classList.add(...e)}function Fe(r,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:o}=GR(e,!0);t=qR(t),t.length>0&&r.classList.remove(...t),o.forEach(n=>{r.classList.forEach(i=>{n.test(i)&&r.classList.remove(i)})})}function Se(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(o=>{Array.isArray(o)&&o[0]!==""&&r.setAttribute(...o)})}function ko(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:o}=GR(e,!0);t.forEach(n=>{n!==""&&r.removeAttribute(n)}),o.forEach(n=>{r.getAttributeNames().forEach(i=>{n.test(i)&&r.removeAttribute(i)})})}function nm(r){if(r.nodeType===3)r.parentNode.removeChild(r);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(r.nodeName)>-1){let e=r.childNodes;for(let t=e.length-1;t>=0;t--)nm(e[t])}}function Po(r){let e;for(;e=r.lastChild;)r.removeChild(e)}var hD=/(<(.*)>|&(.*);)/;function $R(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;hD.test(e)?r.innerHTML=t?PR(e):e:li(r,e)}function li(r,e){let t=r.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(Po(r),r.appendChild(r.ownerDocument.createTextNode(e)))}function Wi(r){let e=r.ownerDocument.documentElement,t=r;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Wi(t.host.impl);if(t.host)return Wi(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(Ur(t).display==="none")return!1;t=t.parentNode}return!0}function Yt(r){let e=r.ownerDocument,t=e.defaultView,o=e.documentElement,n=r,i,a,c;for(i=n.offsetLeft,a=n.offsetTop,c=n;(n=n.offsetParent)&&!(n===e.body||!("offsetLeft"in n));)i+=n.offsetLeft,a+=n.offsetTop,c=n;return c&&c.style.position==="fixed"&&(i+=t.pageXOffset||o.scrollLeft,a+=t.pageYOffset||o.scrollTop),{left:i,top:a}}function sm(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function za(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Rs(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?sm(e):r.scrollTop}function uu(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?za(e):r.scrollLeft}function Ts(r){let e=r.ownerDocument,t=e?e.defaultView:void 0;e||(e=r.document?r.document:r,t=e.defaultView);let o=["auto","scroll"],n=r.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:i,overflowX:a,overflowY:c}=n.style;if([i,a,c].includes("scroll"))return n;if({overflow:i,overflowX:a,overflowY:c}=t.getComputedStyle(n),o.includes(i)||o.includes(a)||o.includes(c)||n.clientHeight<=n.scrollHeight+1&&(o.includes(c)||o.includes(i))||n.clientWidth<=n.scrollWidth+1&&(o.includes(a)||o.includes(i)))return n;n=n.parentNode}return t}function KR(r){return r.scrollHeight-r.clientHeight}function XR(r){return r.scrollWidth-r.clientWidth}function Sn(r){let e=r.ownerDocument,t=e.defaultView,o=r.parentNode;for(;o&&o.style&&e.body!==o;){if(o.style.overflow!=="visible"&&o.style.overflow!=="")return o;let n=Ur(o,t),i=["scroll","hidden","auto"],a=n.getPropertyValue("overflow"),c=n.getPropertyValue("overflow-y"),u=n.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(c)||i.includes(u))return o;o=o.parentNode}return t}function Ya(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(r){if(r===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;let o=r.style[e];if(o!==""&&o!==void 0)return o;let n=Ur(r,t);if(n[e]!==""&&n[e]!==void 0)return n[e]}function Ur(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r.currentStyle||e.getComputedStyle(r)}function Ke(r){return r.offsetWidth}function Rt(r){return r.offsetHeight}function ci(r){return r.clientHeight||r.innerHeight}function du(r){return r.clientWidth||r.innerWidth}function QR(r){return r.selectionStart?r.selectionStart:0}function am(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;r.getSelection&&(r.getSelection().empty?r.getSelection().empty():r.getSelection().removeAllRanges&&r.getSelection().removeAllRanges())}function hu(r,e,t){if(t===void 0&&(t=e),r.setSelectionRange){r.focus();try{r.setSelectionRange(e,t)}catch{let n=r.parentNode,i=n.style.display;n.style.display="block",r.setSelectionRange(e,t),n.style.display=i}}}var om;function fD(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=r.createElement("div");e.style.height="200px",e.style.width="100%";let t=r.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(r.body||r.documentElement).appendChild(t);let o=e.offsetWidth;t.style.overflow="scroll";let n=e.offsetWidth;return o===n&&(n=t.clientWidth),(r.body||r.documentElement).removeChild(t),o-n}function Xe(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return om===void 0&&(om=fD(r)),om}function ZR(r){return r.offsetWidth!==r.clientWidth}function JR(r){return r.offsetHeight!==r.clientHeight}function xs(r,e,t){r.style.transform=`translate3d(${e},${t},0)`}function Ui(r){r.style.transform&&r.style.transform!==""&&(r.style.transform="")}function qa(r){return r&&(["INPUT","SELECT","TEXTAREA"].indexOf(r.nodeName)>-1||r.contentEditable==="true")}function fu(r){return qa(r)&&r.hasAttribute("data-hot-input")===!1}function eT(r,e){new IntersectionObserver((o,n)=>{o.forEach(i=>{i.isIntersecting&&r.offsetParent!==null&&(e(),n.unobserve(r))})},{root:r.ownerDocument.body}).observe(r)}function Re(r){return typeof r=="function"}function tT(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,o;function n(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return t&&clearTimeout(t),t=setTimeout(()=>{o=r.apply(this,a)},e),o}return n}function rT(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return r.apply(this,t.concat(a))}}function Ga(r,e,t,o,n,i,a,c){return oe(c)?r.call(e,t,o,n,i,a,c):oe(a)?r.call(e,t,o,n,i,a):oe(i)?r.call(e,t,o,n,i):oe(n)?r.call(e,t,o,n):oe(o)?r.call(e,t,o):oe(t)?r.call(e,t):r.call(e)}var uY=S(V(),1),dY=S(me(),1),hY=S(CT(),1);function Rn(r){let e;return Array.isArray(r)?e=r.length?new Array(r.length).fill(null):[]:(e={},be(r,(t,o)=>{o!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[o]=Rn(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[o]=[Rn(t[0])]:e[o]=[]:e[o]=null)})),e}function vT(r,e){return e.prototype.constructor=e,r.prototype=new e,r.prototype.constructor=r,r}function go(r,e,t){let o=Array.isArray(t);return be(e,(n,i)=>{(o===!1||t.includes(i))&&(r[i]=n)}),r}function lm(r,e){be(e,(t,o)=>{e[o]&&typeof e[o]=="object"?(r[o]||(Array.isArray(e[o])?r[o]=[]:Object.prototype.toString.call(e[o])==="[object Date]"?r[o]=e[o]:r[o]={}),lm(r[o],e[o])):r[o]=e[o]})}function jr(r){return typeof r=="object"?JSON.parse(JSON.stringify(r)):r}function Te(r){r.MIXINS||(r.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return re(t,n=>{r.MIXINS.push(n.MIXIN_NAME),be(n,(i,a)=>{if(r.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof i=="function")r.prototype[a]=i;else{let c=function(g,C){let v=`_${g}`,y=R=>{let O=R;return(Array.isArray(O)||qt(O))&&(O=jr(O)),O};return function(){return this[v]===void 0&&(this[v]=y(C)),this[v]}},u=function(g){let C=`_${g}`;return function(v){this[C]=v}};Object.defineProperty(r.prototype,a,{get:c(a,i),set:u(a),configurable:!0})}})}),r}function pu(r,e){return JSON.stringify(r)===JSON.stringify(e)}function qt(r){return Object.prototype.toString.call(r)==="[object Object]"}function lr(r,e,t,o){o.value=t,o.writable=o.writable!==!1,o.enumerable=o.enumerable!==!1,o.configurable=o.configurable!==!1,Object.defineProperty(r,e,o)}function be(r,e){for(let t in r)if((!r.hasOwnProperty||r.hasOwnProperty&&Object.prototype.hasOwnProperty.call(r,t))&&e(r[t],t,r)===!1)break;return r}function yT(r,e){let t=e.split("."),o=r;return be(t,n=>{if(o=o[n],o===void 0)return o=void 0,!1}),o}function gu(r,e,t){let o=e.split("."),n=r;o.forEach((i,a)=>{a!==o.length-1?(Do(n,i)||(n[i]={}),n=n[i]):n[i]=t})}function Es(r){if(!qt(r))return 0;let e=function(t){let o=0;return qt(t)?be(t,(n,i)=>{i!=="__children"&&(o+=e(n))}):o+=1,o};return e(r)}function cr(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",t=`_${e}`,o={_touched:!1,[t]:r,isTouched(){return this._touched}};return Object.defineProperty(o,e,{get(){return this[t]},set(n){this._touched=!0,this[t]=n},enumerable:!0,configurable:!0}),o}function Do(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function ST(r){return window.requestAnimationFrame(r)}function RT(){return"ontouchstart"in window}function TT(){return typeof window<"u"}var zr=r=>{let e={value:!1};return e.test=(t,o)=>{e.value=r(t,o)},e},Tn={chrome:zr((r,e)=>/Chrome/.test(r)&&/Google/.test(e)),chromeWebKit:zr(r=>/CriOS/.test(r)),edge:zr(r=>/Edge/.test(r)),edgeWebKit:zr(r=>/EdgiOS/.test(r)),firefox:zr(r=>/Firefox/.test(r)),firefoxWebKit:zr(r=>/FxiOS/.test(r)),mobile:zr(r=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)),safari:zr((r,e)=>/Safari/.test(r)&&/Apple Computer/.test(e))},wu={mac:zr(r=>/^Mac/.test(r)),win:zr(r=>/^Win/.test(r)),linux:zr(r=>/^Linux/.test(r)),ios:zr(r=>/iPhone|iPad|iPod/i.test(r))};function OD(){let{userAgent:r=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};be(Tn,t=>{let{test:o}=t;return void o(r,e)})}function MD(){let{platform:r=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};be(wu,e=>{let{test:t}=e;return void t(r)})}TT()&&(OD(),MD());function xT(){return Tn.chrome.value}function ET(){return Tn.chromeWebKit.value}function bu(){return Tn.firefox.value}function _T(){return Tn.firefoxWebKit.value}function OT(){return Tn.edge.value}function ui(){return Tn.mobile.value}function Cu(){return wu.ios.value}function MT(){let{maxTouchPoints:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return r>2&&wu.mac.value}function vu(){return wu.mac.value}var JY=S(V(),1);var CY=S(me(),1);var ee={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:bu()?182:174,AUDIO_MUTE:bu()?181:173,AUDIO_UP:bu()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},ID=[ee.ALT,ee.ARROW_DOWN,ee.ARROW_LEFT,ee.ARROW_RIGHT,ee.ARROW_UP,ee.AUDIO_DOWN,ee.AUDIO_MUTE,ee.AUDIO_UP,ee.BACKSPACE,ee.CAPS_LOCK,ee.DELETE,ee.END,ee.ENTER,ee.ESCAPE,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12,ee.F13,ee.F14,ee.F15,ee.F16,ee.F17,ee.F18,ee.F19,ee.HOME,ee.INSERT,ee.MEDIA_NEXT,ee.MEDIA_PLAY_PAUSE,ee.MEDIA_PREV,ee.MEDIA_STOP,ee.NULL,ee.NUM_LOCK,ee.PAGE_DOWN,ee.PAGE_UP,ee.PAUSE,ee.SCROLL_LOCK,ee.SHIFT,ee.TAB];function IT(r){return ID.includes(r)}function HT(r){return[ee.CONTROL,ee.COMMAND_LEFT,ee.COMMAND_RIGHT,ee.COMMAND_FIREFOX].includes(r)}function AT(r,e){let t=e.split("|"),o=!1;return re(t,n=>{if(r===ee[n])return o=!0,!1}),o}function zi(r){r.isImmediatePropagationEnabled=!1,r.cancelBubble=!0}function Lo(r){return r.isImmediatePropagationEnabled===!1}function Ka(r){return r.button===2}function yu(r){return r.button===0}var jY=S(V(),1);var AY=S(V(),1),NY=S(me(),1),kY=S(qT(),1);function Dr(){oe(console)&&console.warn(...arguments)}function GT(){oe(console)&&console.error(...arguments)}function XD(r,e,t){return(e=QD(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function QD(r){var e=ZD(r,"string");return typeof e=="symbol"?e:e+""}function ZD(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var _s=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],JD=mt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,mm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),pm=new Map([[]]),xu=new WeakMap,Eu=class{static getSingleton(){return tL()}constructor(){XD(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let e=Object.create(null);return re(_s,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))re(t,i=>this.add(e,i,o));else{mm.has(e)&&Dr(kR(JD,{hookName:e,removedInVersion:mm.get(e)})),pm.has(e)&&Dr(pm.get(e));let i=this.getBucket(o);if(typeof i[e]>"u"&&(this.register(e),i[e]=[],this.initOrderMap(i,e)),t.skip=!1,i[e].indexOf(t)===-1){let a=!1;t.initialHook&&re(i[e],(c,u)=>{if(c.initialHook)return i[e][u]=t,a=!0,!1}),a||i[e].push(t)}this.setCallbackOrderIndex(i,e,t,n),this.orderBucketByOrderIndex(i,e)}return this}once(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?re(t,i=>this.once(e,i,o)):(t.runOnce=!0,this.add(e,t,o,n))}remove(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=this.getBucket(o);return typeof n[e]<"u"&&n[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(t);return!!(o[e]!==void 0&&o[e].length)}run(e,t,o,n,i,a,c,u){{let m=this.globalBucket[t],g=m?m.length:0,C=0;if(g)for(;C<g;){if(!m[C]||m[C].skip){C+=1;continue}let v=Ga(m[C],e,o,n,i,a,c,u);v!==void 0&&(o=v),m[C]&&m[C].runOnce&&this.remove(t,m[C]),C+=1}}{let m=this.getBucket(e)[t],g=m?m.length:0,C=0;if(g)for(;C<g;){if(!m[C]||m[C].skip){C+=1;continue}let v=Ga(m[C],e,o,n,i,a,c,u);v!==void 0&&(o=v),m[C]&&m[C].runOnce&&this.remove(t,m[C],e),C+=1}}return o}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;be(this.getBucket(e),(t,o,n)=>n[o].length=0)}register(e){this.isRegistered(e)||_s.push(e)}deregister(e){this.isRegistered(e)&&_s.splice(_s.indexOf(e),1)}isDeprecated(e){return pm.has(e)||mm.has(e)}isRegistered(e){return _s.indexOf(e)>=0}getRegistered(){return _s}setCallbackOrderIndex(e,t,o,n){let i=Number.isInteger(n)?n:0,a=this.getCallbackOrderMap(e,t);a.set(i,[...a.get(i)||[],o])}orderBucketByOrderIndex(e,t){let o=this.getCallbackOrderMap(e,t);o===void 0||o.size===0||o.size===1&&o.has(0)||(e[t]=[...o].sort((n,i)=>n[0]-i[0]).flatMap(n=>{let[,i]=n;return i}))}initOrderMap(e,t){xu.has(e)||xu.set(e,[]),xu.get(e)[t]=new Map}getCallbackOrderMap(e,t){return xu.get(e)[t]}},eL=new Eu;function tL(){return eL}var Gt=Eu;var gm=new Map;function Lr(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";gm.has(r)||gm.set(r,new Map);let e=gm.get(r);function t(c,u){e.set(c,u)}function o(c){return e.get(c)}function n(c){return e.has(c)}function i(){return[...e.keys()]}function a(){return[...e.values()]}return{register:t,getItem:o,hasItem:n,getNames:i,getValues:a}}var wm=new WeakMap,{register:rL,getItem:$T,hasItem:oL,getNames:qY,getValues:GY}=Lr("editors");function iL(r){let e={},t=r;this.getConstructor=function(){return r},this.getInstance=function(o){return o.guid in e||(e[o.guid]=new t(o)),e[o.guid]},Gt.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function KT(r,e){let t;if(typeof r=="function")wm.get(r)||Cm(null,r),t=wm.get(r);else if(typeof r=="string")t=$T(r);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${r}"`);return t.getInstance(e)}function bm(r){if(typeof r=="function")return r;if(!oL(r))throw Error(`No registered editor found under "${r}" name`);return $T(r).getConstructor()}function Cm(r,e){r&&typeof r!="string"&&(e=r,r=e.EDITOR_TYPE);let t=new iL(e);typeof r=="string"&&rL(r,t),wm.set(e,t)}var KY=S(V(),1),XY=S(me(),1);function nL(r,e,t){return(e=sL(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function sL(r){var e=aL(r,"string");return typeof e=="symbol"?e:e+""}function aL(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var vm=0,ym=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nL(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,o){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function i(a){o.call(this,lL(a))}return this.context.eventListeners.push({element:e,event:t,callback:o,callbackProxy:i,options:n,eventManager:this}),e.addEventListener(t,i,n),vm+=1,()=>{this.removeEventListener(e,t,o)}}removeEventListener(e,t,o){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,a;for(;i;)if(i-=1,a=this.context.eventListeners[i],a.event===t&&a.element===e){if(o&&o!==a.callback||n&&a.eventManager!==this)continue;this.context.eventListeners.splice(i,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),vm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;let o=this.context.eventListeners[t];e&&o.eventManager!==this||(this.context.eventListeners.splice(t,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),vm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let o=e.document,n=e;o||(o=e.ownerDocument?e.ownerDocument:e,n=o.defaultView);let i={bubbles:!0,cancelable:t!=="mousemove",view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;o.createEvent?(a=o.createEvent("MouseEvents"),a.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||o.body.parentNode)):a=o.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}};function lL(r){let e=r.stopImmediatePropagation;return r.stopImmediatePropagation=function(){e.apply(this),zi(this)},r}var wo=ym;function cL(r,e){uL(r,e),e.add(r)}function uL(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(r,e,t){return(e=dL(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dL(r){var e=hL(r,"string");return typeof e=="symbol"?e:e+""}function hL(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function XT(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Sm=new WeakSet,Xa=class{constructor(e,t,o){cL(this,Sm),xn(this,"hot",void 0),xn(this,"tableMeta",void 0),xn(this,"selection",void 0),xn(this,"eventManager",void 0),xn(this,"destroyed",!1),xn(this,"activeEditor",void 0),xn(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=o,this.eventManager=new wo(e),this.hot.addHook("afterDocumentKeyDown",n=>XT(Sm,this,fL).call(this,n)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",n=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",n)}),this.hot.view._wt.update("onCellDblClick",(n,i,a)=>XT(Sm,this,mL).call(this,n,i,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,m=>{m&&this.prepareEditor()});return}let t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;let{row:o,col:n}=t,i=this.hot.runHooks("modifyGetCellCoords",o,n),a=o,c=n;if(Array.isArray(i)&&([a,c]=i),this.cellProperties=this.hot.getCellMeta(a,c),!this.isCellEditable()){this.clearActiveEditor();return}let u=this.hot.getCell(o,n,!0);if(u){let m=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(c),C=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),c);this.activeEditor=KT(m,this.hot),this.activeEditor.prepare(o,n,g,u,C,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}let n=this.hot.getSelectedRangeLast(),i=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,e,t,o);if(t instanceof MouseEvent&&typeof i!="boolean"&&(i=this.hot.selection.getLayerLevel()===0&&n.isSingle()),i===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,o){this.activeEditor?this.activeEditor.finishEditing(e,t,o):o&&o(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=this.hot.getCellEditor(this.cellProperties),{row:o,col:n}=e.highlight,{rowIndexMapper:i,columnIndexMapper:a}=this.hot,c=i.isHidden(this.hot.toPhysicalRow(o))||a.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!t||c)}moveSelectionAfterEnter(e){let t=pe({},typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function fL(r){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Lo(r))return;let{keyCode:t}=r,o=(r.ctrlKey||r.metaKey)&&!r.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!IT(t)&&!HT(t)&&!o&&!this.isEditorOpened()&&this.openEditor("",r)}function mL(r,e){e.isCell()&&this.openEditor(null,r,!0)}var QT=new WeakMap;Xa.getInstance=function(r,e,t){let o=QT.get(r);return o||(o=new Xa(r,e,t),QT.set(r,o)),o};var ZT=Xa;var sq=S(V(),1);function pL(r,e){ex(r,e),e.add(r)}function Qa(r,e,t){ex(r,e),e.set(r,t)}function ex(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(r,e){return r.get(di(r,e))}function Za(r,e,t){return r.set(di(r,e),t),t}function di(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Os=Object.freeze({CELL:"cell",MIXED:"mixed"}),Lt=new WeakMap,_u=new WeakMap,Ou=new WeakMap,Mu=new WeakMap,Iu=new WeakMap,Yi=new WeakSet,Hu=class{constructor(e){var t=this;pL(this,Yi),Qa(this,Lt,void 0),Qa(this,_u,void 0),Qa(this,Ou,1),Qa(this,Mu,null),Qa(this,Iu,new Map);let o=e.getSettings();Za(Lt,this,e),Za(_u,this,o.imeFastEdit?Os.MIXED:Os.CELL),tt(Lt,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return di(Yi,t,wL).call(t,...i)}),tt(Lt,this).addHook("afterSelection",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return di(Yi,t,JT).call(t,...i)}),tt(Lt,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return di(Yi,t,JT).call(t,...i)}),tt(Lt,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return di(Yi,t,gL).call(t,...i)})}getFocusMode(){return tt(_u,this)}setFocusMode(e){Object.values(Os).includes(e)?Za(_u,this,e):Dr(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return tt(Ou,this)}setRefocusDelay(e){Za(Ou,this,e)}setRefocusElementGetter(e){Za(Mu,this,e)}getRefocusElement(){if(typeof tt(Mu,this)=="function")return tt(Mu,this).call(this);var e;return(e=tt(Lt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){let t=o=>{var n,i;let a=(n=tt(Lt,this).getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;if(!a)return;let c=tt(Lt,this).runHooks("modifyFocusedElement",a.row,a.col,o);c instanceof HTMLElement||(c=o),c&&!((i=tt(Lt,this).getActiveEditor())!==null&&i!==void 0&&i.isOpened())&&c.focus({preventScroll:!0})};e?t(e):di(Yi,this,Rm).call(this,o=>t(o))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tt(Ou,this),o=this.getRefocusElement();tt(Lt,this).getSettings().imeFastEdit&&!((e=tt(Lt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&o&&(tt(Iu,this).has(t)||tt(Iu,this).set(t,tT(()=>{o.select()},t)),tt(Iu,this).get(t)())}};function Rm(r){var e;let t=(e=tt(Lt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!tt(Lt,this).selection.isCellVisible(t)){r(null);return}let o=tt(Lt,this).getCell(t.row,t.col,!0);o===null?tt(Lt,this).addHookOnce("afterScroll",()=>{r(tt(Lt,this).getCell(t.row,t.col,!0))}):r(o)}function JT(){di(Yi,this,Rm).call(this,r=>{let{activeElement:e}=tt(Lt,this).rootDocument;e&&fu(e)&&e.blur(),this.focusOnHighlightedCell(r)})}function gL(){di(Yi,this,Rm).call(this,r=>{this.getFocusMode()===Os.MIXED&&r.nodeName==="TD"&&this.refocusToEditorTextarea()})}function wL(r){typeof r.imeFastEdit=="boolean"&&this.setFocusMode(r.imeFastEdit?Os.MIXED:Os.CELL)}var wq=S(me(),1),bq=S(hx(),1);var qL={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},vq=new RegExp(Object.keys(qL).map(r=>`(${r})`).join("|"),"gi");function Mm(r){let e=r.hasColHeaders(),t=r.hasRowHeaders(),o=[e?-1:0,t?-1:0,r.countRows()-1,r.countCols()-1],n=r.getData(...o),i=n.length,a=i>0?n[0].length:0,c=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],m=["<tbody>","</tbody>"],g=t?1:0,C=e?1:0;for(let v=0;v<i;v+=1){let y=e&&v===0,R=[];for(let N=0;N<a;N+=1){let I=!y&&t&&N===0,j="";if(y)j=`<th>${r.getColHeader(N-g)}</th>`;else if(I)j=`<th>${r.getRowHeader(v-C)}</th>`;else{let ie=n[v][N],{hidden:ue,rowspan:de,colspan:J}=r.getCellMeta(v-C,N-g);if(!ue){let te=[];if(de&&te.push(`rowspan="${de}"`),J&&te.push(`colspan="${J}"`),ai(ie))j=`<td ${te.join(" ")}></td>`;else{let q=ie.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");j=`<td ${te.join(" ")}>${q}</td>`}}}R.push(j)}let O=["<tr>",...R,"</tr>"].join("");y?u.splice(1,0,O):m.splice(-1,0,O)}return c.splice(1,0,u.join(""),m.join("")),c.join("")}var Gq=S(V(),1);var Iq=S(V(),1);var Sq=S(tr(),1),Rq=S(rr(),1),Tq=S(or(),1),xq=S(ir(),1),Eq=S(nr(),1),_q=S(sr(),1),Oq=S(ar(),1);function Im(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=typeof r;if(t==="number")return!isNaN(r)&&isFinite(r);if(t==="string"){if(r.length===0)return!1;if(r.length===1)return/\d/.test(r);let o=Array.from(new Set([".",...e])).map(n=>`\\${n}`).join("|");return new RegExp(`^[+-]?(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(r.trim())}else if(t==="object")return!!r&&typeof r.valueOf()=="number"&&!(r instanceof Date);return!1}function fx(r){return Im(r,[","])}function $t(r,e,t){let o=-1;for(typeof e=="function"?(t=e,e=r):o=r-1;++o<=e&&t(o)!==!1;);}function Hm(r,e,t){let o=r+1;for(typeof e=="function"&&(t=e,e=0);--o>=e&&t(o)!==!1;);}function nt(r,e,t){return Math.min(r,e)===r?e:Math.max(r,t)===r?t:r}var Am="asc",GL="desc",mx=new Map([[Am,[-1,1]],[GL,[1,-1]]]),$L=r=>`The priority '${r}' is already declared in a map.`,KL=r=>`The priority '${r}' is not a number.`;function px(){let{errorPriorityExists:r,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=new Map;r=Re(r)?r:$L,e=Re(e)?e:KL;function o(i,a){if(!Im(i))throw new Error(e(i));if(t.has(i))throw new Error(r(i));t.set(i,a)}function n(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Am,[a,c]=mx.get(i)||mx.get(Am);return[...t].sort((u,m)=>u[0]<m[0]?a:c).map(u=>u[1])}return{addItem:o,getItems:n}}var kq=S(V(),1);var XL=r=>`The id '${r}' is already declared in a map.`;function qi(){let{errorIdExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Map;r=Re(r)?r:XL;function t(m,g){if(u(m))throw new Error(r(m));e.set(m,g)}function o(m){return e.delete(m)}function n(){e.clear()}function i(m){let[g]=c().find(C=>{let[v,y]=C;return m===y?v:!1})||[null];return g}function a(m){return e.get(m)}function c(){return[...e]}function u(m){return e.has(m)}return{addItem:t,clear:n,getId:i,getItem:a,getItems:c,hasItem:u,removeItem:o}}var Lq=S(V(),1),Fq=S(tr(),1),Vq=S(rr(),1),Wq=S(or(),1),Bq=S(ir(),1),Uq=S(nr(),1),jq=S(sr(),1),zq=S(ar(),1);var QL=r=>`'${r}' value is already declared in a unique set.`;function gx(){let{errorItemExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Set;r=Re(r)?r:QL;function t(i){if(e.has(i))throw new Error(r(i));e.add(i)}function o(){return[...e]}function n(){e.clear()}return{addItem:t,clear:n,getItems:o}}var wx=r=>`There is already registered "${r}" plugin.`,ZL=r=>`There is already registered plugin on priority "${r}".`,JL=r=>`The priority "${r}" is not a number.`,eF=px({errorPriorityExists:ZL,errorPriorityNaN:JL}),tF=gx({errorItemExists:wx}),rF=qi({errorIdExists:wx});function bx(){return[...eF.getItems(),...tF.getItems()]}function Cx(r){let e=Cs(r);return rF.getItem(e)}var Jq=S(V(),1);var{register:oF,getItem:iF,hasItem:nF,getNames:tG,getValues:rG}=Lr("renderers");function Nm(r){if(typeof r=="function")return r;if(!nF(r))throw Error(`No registered renderer found under "${r}" name`);return iF(r)}function vx(r,e){typeof r!="string"&&(e=r,r=e.RENDERER_TYPE),oF(r,e)}var iG=S(V(),1);var{register:sF,getItem:aF,hasItem:lF,getNames:sG,getValues:aG}=Lr("validators");function yx(r){if(typeof r=="function")return r;if(!lF(r))throw Error(`No registered validator found under "${r}" name`);return aF(r)}function Sx(r,e){typeof r!="string"&&(e=r,r=e.VALIDATOR_TYPE),sF(r,e)}var _6=S(V(),1),O6=S(me(),1);var fG=S(V(),1),mG=S(Ja(),1),pG=S(el(),1);function tl(r,e,t){return(e=SF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function SF(r){var e=RF(r,"string");return typeof e=="symbol"?e:e+""}function RF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var rl=class{constructor(){tl(this,"count",0),tl(this,"startColumn",null),tl(this,"endColumn",null),tl(this,"startPosition",null),tl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedWidth:o,zeroBasedScrollOffset:n,viewportWidth:i,columnWidth:a}=t,c=n>0?i+1:i;o>=n&&o+a<=n+c&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;let{scrollOffset:o,viewportWidth:n,inlineStartOffset:i,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:m,columnWidth:g}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){let R=m[this.endColumn]+g-m[this.startColumn-1];if(R<=n&&(this.startColumn-=1),R>=n)break}this.startPosition=(t=m[this.startColumn])!==null&&t!==void 0?t:null;let C=a>0?n+1:n,v=o+n-C,y=this.startColumn===null?0:e.getColumnWidth(this.startColumn);v<-1*i||o>m.at(-1)||-1*o-n>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var wG=S(V(),1),bG=S(Ja(),1),CG=S(el(),1);function ol(r,e,t){return(e=TF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function TF(r){var e=xF(r,"string");return typeof e=="symbol"?e:e+""}function xF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var il=class{constructor(){ol(this,"count",0),ol(this,"startRow",null),ol(this,"endRow",null),ol(this,"startPosition",null),ol(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedHeight:o,zeroBasedScrollOffset:n,innerViewportHeight:i,rowHeight:a}=t;o>=n&&o+a<=i&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;let{scrollOffset:o,viewportHeight:n,horizontalScrollbarHeight:i,totalRows:a,needReverse:c,startPositions:u,rowHeight:m}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){let v=u[this.endRow]+m-u[this.startRow-1];if(v<=n-i&&(this.startRow-=1),v>=n-i)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null;let g=o+n-i,C=this.startRow===null?0:e.getRowHeight(this.startRow);g<C||o>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var yG=S(V(),1),SG=S(Ja(),1),RG=S(el(),1);function nl(r,e,t){return(e=EF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function EF(r){var e=_F(r,"string");return typeof e=="symbol"?e:e+""}function _F(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var En=class{constructor(){nl(this,"count",0),nl(this,"startColumn",null),nl(this,"endColumn",null),nl(this,"startPosition",null),nl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedWidth:o,zeroBasedScrollOffset:n,viewportWidth:i}=t;o<=n&&(this.startColumn=e);let a=n>0?i+1:i;o>=n&&o<=n+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;let{scrollOffset:o,viewportWidth:n,inlineStartOffset:i,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:m,columnWidth:g}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){let y=m[this.endColumn]+g-m[this.startColumn-1];if(this.startColumn-=1,y>n)break}this.startPosition=(t=m[this.startColumn])!==null&&t!==void 0?t:null;let C=a>0?n+1:n;o+n-C<-1*i||o>m.at(-1)+g||-1*o-n>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var xG=S(V(),1),EG=S(Ja(),1),_G=S(el(),1);function sl(r,e,t){return(e=OF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function OF(r){var e=MF(r,"string");return typeof e=="symbol"?e:e+""}function MF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var _n=class{constructor(){sl(this,"count",0),sl(this,"startRow",null),sl(this,"endRow",null),sl(this,"startPosition",null),sl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedHeight:o,zeroBasedScrollOffset:n,innerViewportHeight:i}=t;o<=n&&(this.startRow=e),o>=n&&o<=i&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;let{scrollOffset:o,viewportHeight:n,horizontalScrollbarHeight:i,totalRows:a,needReverse:c,startPositions:u,rowHeight:m}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){let C=u[this.endRow]+m-u[this.startRow-1];if(this.startRow-=1,C>=n-i)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null,o+n-i<0||o>u.at(-1)+m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var MG=S(V(),1);function al(r,e,t){return(e=IF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function IF(r){var e=HF(r,"string");return typeof e=="symbol"?e:e+""}function HF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ll=class{constructor(){al(this,"count",0),al(this,"startColumn",0),al(this,"endColumn",0),al(this,"startPosition",0),al(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}};var HG=S(V(),1);function cl(r,e,t){return(e=AF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function AF(r){var e=NF(r,"string");return typeof e=="symbol"?e:e+""}function NF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ul=class{constructor(){cl(this,"count",0),cl(this,"startRow",0),cl(this,"endRow",0),cl(this,"startPosition",0),cl(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}};var dl=class extends En{finalize(e){var t;super.finalize(e);let{overrideFn:o,totalColumns:n,startPositions:i}=e;this.startColumn!==null&&typeof o=="function"&&o(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=i[this.startColumn])!==null&&t!==void 0?t:null,n<this.endColumn&&(this.endColumn=n-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var hl=class extends _n{finalize(e){var t;super.finalize(e);let{overrideFn:o,totalRows:n,startPositions:i}=e;this.startRow!==null&&typeof o=="function"&&o(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=i[this.startRow])!==null&&t!==void 0?t:null,n<this.endRow&&(this.endRow=n-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var VG=S(V(),1),WG=S(me(),1);var LG=S(V(),1);function Rx(r,e,t){return(e=kF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kF(r){var e=PF(r,"string");return typeof e=="symbol"?e:e+""}function PF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Is=class{constructor(e){Rx(this,"calculationTypes",[]),Rx(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[o,n]=t;this.calculationResults.set(o,n),n.initialize(e)})}_process(e,t){this.calculationTypes.forEach(o=>{let[,n]=o;return n.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,o]=t;return o.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}};function bo(r,e,t){return(e=DF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function DF(r){var e=LF(r,"string");return typeof e=="symbol"?e:e+""}function LF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var On=50,Hs=class extends Is{constructor(e){let{calculationTypes:t,viewportWidth:o,scrollOffset:n,totalColumns:i,columnWidthFn:a,overrideFn:c,inlineStartOffset:u}=e;super(t),bo(this,"viewportWidth",0),bo(this,"scrollOffset",0),bo(this,"zeroBasedScrollOffset",0),bo(this,"totalColumns",0),bo(this,"columnWidthFn",null),bo(this,"columnWidth",0),bo(this,"overrideFn",null),bo(this,"inlineStartOffset",0),bo(this,"totalCalculatedWidth",0),bo(this,"startPositions",[]),bo(this,"needReverse",!0),this.viewportWidth=o,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalColumns=i,this.columnWidthFn=a,this.overrideFn=c,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){let t=this.columnWidthFn(e);return isNaN(t)?On:t}};var jG=S(V(),1),zG=S(me(),1);function Yr(r,e,t){return(e=FF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function FF(r){var e=VF(r,"string");return typeof e=="symbol"?e:e+""}function VF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var km=23,As=class extends Is{constructor(e){let{calculationTypes:t,viewportHeight:o,scrollOffset:n,totalRows:i,rowHeightFn:a,overrideFn:c,horizontalScrollbarHeight:u}=e;super(t),Yr(this,"viewportHeight",0),Yr(this,"scrollOffset",0),Yr(this,"zeroBasedScrollOffset",0),Yr(this,"totalRows",0),Yr(this,"rowHeightFn",null),Yr(this,"rowHeight",0),Yr(this,"overrideFn",null),Yr(this,"horizontalScrollbarHeight",0),Yr(this,"innerViewportHeight",0),Yr(this,"totalCalculatedHeight",0),Yr(this,"startPositions",[]),Yr(this,"needReverse",!0),this.viewportHeight=o,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalRows=i,this.rowHeightFn=a,this.overrideFn=c,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){let t=this.rowHeightFn(e);return isNaN(t)?km:t}};var i$=S(V(),1);function WF(r,e,t){BF(r,e),e.set(r,t)}function BF(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tx(r,e,t){return(e=UF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function UF(r){var e=jF(r,"string");return typeof e=="symbol"?e:e+""}function jF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Ns(r,e){return r.get(Ex(r,e))}function xx(r,e,t){return r.set(Ex(r,e),t),t}function Ex(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hi=new WeakMap,Pm=class r{constructor(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Tx(this,"row",null),Tx(this,"col",null),WF(this,hi,!1),xx(hi,this,o),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){let{countRows:t,countCols:o,countRowHeaders:n,countColHeaders:i}=pe({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-n||this.row>=t||this.col>=o)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ns(hi,this)}isSouthEastOf(e){return this.row>=e.row&&(Ns(hi,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ns(hi,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ns(hi,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ns(hi,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof r&&xx(hi,this,e.isRtl()),this}clone(){return new r(this.row,this.col,Ns(hi,this))}toObject(){return{row:this.row,col:this.col}}},Gi=Pm;var a$=S(V(),1),l$=S(me(),1);function zF(r,e,t){YF(r,e),e.set(r,t)}function YF(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dm(r,e,t){return(e=qF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function qF(r){var e=GF(r,"string");return typeof e=="symbol"?e:e+""}function GF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function qr(r,e){return r.get(_x(r,e))}function $F(r,e,t){return r.set(_x(r,e),t),t}function _x(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xr=new WeakMap,Lm=class r{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Dm(this,"highlight",null),Dm(this,"from",null),Dm(this,"to",null),zF(this,xr,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=o.clone(),$F(xr,this,n)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:t,col:o}=e,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=t&&i.row>=t&&n.col<=o&&i.col>=o}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){let t=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;let o=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=this.getDirection(),a=e.getOuterTopStartCorner(),c=e.getOuterBottomEndCorner(),u=Math.min(o.row,a.row),m=Math.min(o.col,a.col),g=Math.max(n.row,c.row),C=Math.max(n.col,c.col),v=this._createCellCoords(u,m),y=this._createCellCoords(g,C);return this.from=v,this.to=y,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return qr(xr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return qr(xr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return qr(xr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return qr(xr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return qr(xr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return qr(xr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return qr(xr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return qr(xr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Gi))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];let t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return t.top===o.top&&n.push("top"),t.right===o.right&&n.push(qr(xr,this)?"left":"right"),t.bottom===o.bottom&&n.push("bottom"),t.left===o.left&&n.push(qr(xr,this)?"right":"left"),n}getInner(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),o=[];for(let n=e.row;n<=t.row;n++)for(let i=e.col;i<=t.col;i++)!(this.from.row===n&&this.from.col===i)&&!(this.to.row===n&&this.to.col===i)&&o.push(this._createCellCoords(n,i));return o}getAll(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),o=[];for(let n=e.row;n<=t.row;n++)for(let i=e.col;i<=t.col;i++)e.row===n&&e.col===i?o.push(e):t.row===n&&t.col===i?o.push(t):o.push(this._createCellCoords(n,i));return o}forAll(e){let t=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=t.row;n<=o.row;n++)for(let i=t.col;i<=o.col;i++)if(e(n,i)===!1)return}clone(){return new r(this.highlight,this.from,this.to,qr(xr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Gi(e,t,qr(xr,this))}},Mn=Lm;var o6=S(me(),1);var d$=S(V(),1);function Fo(r,e,t){KF(r,e),e.set(r,t)}function KF(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X(r,e){return r.get(Ox(r,e))}function $i(r,e,t){return r.set(Ox(r,e),t),t}function Ox(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Gr=new WeakMap,Fm=new WeakMap,Ft=new WeakMap,ks=new WeakMap,Au=new WeakMap,Co=new WeakMap,Vm=new WeakMap,fl=new WeakMap,In=new WeakMap,Vo=new WeakMap,Wm=class{constructor(e,t,o,n,i,a){let c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Fo(this,Gr,void 0),Fo(this,Fm,void 0),Fo(this,Ft,void 0),Fo(this,ks,void 0),Fo(this,Au,void 0),Fo(this,Co,void 0),Fo(this,Vm,void 0),Fo(this,fl,void 0),Fo(this,In,[null,null]),Fo(this,Vo,[null,null]),$i(Gr,this,o),$i(Fm,this,t),$i(Ft,this,i),$i(ks,this,a),$i(Au,this,c),$i(Co,this,n),$i(Vm,this,e),this.registerEvents()}registerEvents(){X(Co,this).addEventListener(X(Ft,this).holder,"contextmenu",o=>this.onContextMenu(o)),X(Co,this).addEventListener(X(Ft,this).TABLE,"mouseover",o=>this.onMouseOver(o)),X(Co,this).addEventListener(X(Ft,this).TABLE,"mouseout",o=>this.onMouseOut(o));let e=()=>{X(Co,this).addEventListener(X(Ft,this).holder,"touchstart",o=>this.onTouchStart(o)),X(Co,this).addEventListener(X(Ft,this).holder,"touchend",o=>this.onTouchEnd(o)),this.momentumScrolling||(this.momentumScrolling={}),X(Co,this).addEventListener(X(Ft,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||X(Gr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,X(Gr,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{X(Co,this).addEventListener(X(Ft,this).holder,"mouseup",o=>this.onMouseUp(o)),X(Co,this).addEventListener(X(Ft,this).holder,"mousedown",o=>this.onMouseDown(o))};ui()?e():(RT()&&e(),t())}selectedCellWasTouched(e){let o=this.parentCell(e).coords;if(X(fl,this)&&o){let[n,i]=[o.row,X(fl,this).from.row],[a,c]=[o.col,X(fl,this).from.col];return n===i&&a===c}return!1}parentCell(e){let t={},o=X(Ft,this).TABLE,n=Ua(e,["TD","TH"],o);return n?(t.coords=X(Ft,this).getCoords(n),t.TD=n):He(e,"wtBorder")&&He(e,"current")?(t.coords=X(ks,this).getFocusSelection().cellRange.highlight,t.TD=X(Ft,this).getCell(t.coords)):He(e,"wtBorder")&&He(e,"area")&&X(ks,this).getAreaSelection().cellRange&&(t.coords=X(ks,this).getAreaSelection().cellRange.to,t.TD=X(Ft,this).getCell(t.coords)),t}onMouseDown(e){let t=X(Fm,this).rootDocument.activeElement,o=rT(jR,e.target),n=e.target;if(!["TD","TH"].includes(t.nodeName)&&(n===t||o(0)===t||o(1)===t))return;let i=this.parentCell(n);He(n,"corner")?X(Gr,this).getSetting("onCellCornerMouseDown",e,n):i.TD&&X(Gr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(e.button===0||this.touchApplied)&&i.TD&&(X(Vo,this)[0]=i.TD,clearTimeout(X(In,this)[0]),X(In,this)[0]=setTimeout(()=>{X(Vo,this)[0]=null},1e3))}onContextMenu(e){if(X(Gr,this).has("onCellContextMenu")){let t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!X(Gr,this).has("onCellMouseOver"))return;let t=X(Ft,this).TABLE,o=Ua(e.target,["TD","TH"],t),n=X(Au,this)||this;o&&o!==n.lastMouseOver&&ja(o,t)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",e,X(Ft,this).getCoords(o),o))}onMouseOut(e){if(!X(Gr,this).has("onCellMouseOut"))return;let t=X(Ft,this).TABLE,o=Ua(e.target,["TD","TH"],t),n=Ua(e.relatedTarget,["TD","TH"],t),i=X(Au,this)||this;o&&o!==n&&ja(o,t)&&(this.callListener("onCellMouseOut",e,X(Ft,this).getCoords(o),o),n===null&&(i.lastMouseOver=null))}onMouseUp(e){let t=this.parentCell(e.target);t.TD&&X(Gr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===X(Vo,this)[0]&&t.TD===X(Vo,this)[1]?(He(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),X(Vo,this)[0]=null,X(Vo,this)[1]=null):t.TD===X(Vo,this)[0]&&(X(Vo,this)[1]=t.TD,clearTimeout(X(In,this)[1]),X(In,this)[1]=setTimeout(()=>{X(Vo,this)[1]=null},500)))}onTouchStart(e){$i(fl,this,X(ks,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;let o=e.target,n=(t=this.parentCell(o))===null||t===void 0?void 0:t.coords,i=oe(n)&&n.row>=0&&n.col>=0;if(e.cancelable&&i&&X(Gr,this).getSetting("isDataViewInstance")){let c=["A","BUTTON","INPUT"];Cu()&&(ET()||_T())&&this.selectedCellWasTouched(o)&&!c.includes(o.tagName)?e.preventDefault():this.selectedCellWasTouched(o)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,o,n){let i=X(Gr,this).getSettingPure(e);i&&i(t,o,n,X(Vm,this).call(this))}destroy(){clearTimeout(X(In,this)[0]),clearTimeout(X(In,this)[1]),X(Co,this).destroy()}},Nu=Wm;var N4=S(V(),1),k4=S(me(),1);var PK=S(V(),1),DK=S(me(),1);var b$=S(V(),1);function Bm(r,e,t){return(e=XF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function XF(r){var e=QF(r,"string");return typeof e=="symbol"?e:e+""}function QF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Um=class{constructor(e,t,o){Bm(this,"offset",void 0),Bm(this,"total",void 0),Bm(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=o}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},Mx=Um;var v$=S(V(),1);function jm(r,e,t){return(e=ZF(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ZF(r){var e=JF(r,"string");return typeof e=="symbol"?e:e+""}function JF(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var zm=class{constructor(e,t,o){jm(this,"offset",void 0),jm(this,"total",void 0),jm(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=o}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},Ix=zm;var U$=S(V(),1);var O$=S(V(),1),M$=S(me(),1);var x$=S(V(),1);var S$=S(V(),1);function ku(r,e,t){return(e=eV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function eV(r){var e=tV(r,"string");return typeof e=="symbol"?e:e+""}function tV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ml=class{constructor(){ku(this,"currentSize",0),ku(this,"nextSize",0),ku(this,"currentOffset",0),ku(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};function Ym(r,e,t){return(e=rV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function rV(r){var e=oV(r,"string");return typeof e=="symbol"?e:e+""}function oV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Pu=class{constructor(){Ym(this,"size",new ml),Ym(this,"workingSpace",0),Ym(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ml}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}};function Ps(r,e,t){return(e=iV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function iV(r){var e=nV(r,"string");return typeof e=="symbol"?e:e+""}function nV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Hn=class{constructor(e,t,o){Ps(this,"rootNode",void 0),Ps(this,"nodesPool",void 0),Ps(this,"sizeSet",new Pu),Ps(this,"childNodeType",void 0),Ps(this,"visualIndex",0),Ps(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=o.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){let{rootNode:e,sizeSet:t}=this,o=0;if(this.isSharedViewSet()){let n=e.firstElementChild;for(;n;){if(n.tagName===this.childNodeType)o+=1;else if(t.isPlaceOn(1))break;n=n.nextElementSibling}}else o=e.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:e,sizeSet:t}=this,o=this.isSharedViewSet(),{nextSize:n}=t.getViewSize(),i=this.getRenderedChildCount();for(;i<n;){let c=this.nodesPool();!o||o&&t.isPlaceOn(2)?e.appendChild(c):e.insertBefore(c,e.firstChild),i+=1}let a=o&&t.isPlaceOn(1);for(;i>n;)e.removeChild(a?e.firstChild:e.lastChild),i-=1}render(){let{rootNode:e,sizeSet:t}=this,o=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(o+=t.sharedSize.nextSize);let n=e.childNodes[o];if(n.tagName!==this.childNodeType){let i=this.nodesPool();e.replaceChild(i,n),n=i}this.collectedNodes.push(n),this.visualIndex+=1}end(){}};var An=class extends Hn{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}};var V$=S(V(),1);var L$=S(V(),1);function sV(r,e,t){return(e=aV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function aV(r){var e=lV(r,"string");return typeof e=="symbol"?e:e+""}function lV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Du=class{constructor(e){sV(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}};function pl(r,e,t){return(e=cV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function cV(r){var e=uV(r,"string");return typeof e=="symbol"?e:e+""}function uV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var $r=class{constructor(e,t){pl(this,"nodesPool",null),pl(this,"nodeType",void 0),pl(this,"rootNode",void 0),pl(this,"table",null),pl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Du(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};function Hx(r,e,t){return(e=dV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dV(r){var e=hV(r,"string");return typeof e=="symbol"?e:e+""}function hV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Lu=class extends $r{constructor(){super("TH"),Hx(this,"orderViews",new WeakMap),Hx(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new An(e,o=>this.nodesPool.obtain(this.sourceRowIndex,o),this.nodeType),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:o,rows:n,cells:i}=this.table;for(let a=0;a<e;a++){let c=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=c;let m=this.obtainOrderView(u),g=i.obtainOrderView(u);m.appendView(g).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let C=0;C<o;C++){m.render();let v=m.getCurrentNode();v.className="",v.removeAttribute("style"),ko(v,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(v,[FR(),BR(),ys(C+1),Vi(-1)]),t[C](c,v,C)}m.end()}}};var Fu=class extends $r{constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:t}=this.table,o=this.rootNode.firstChild;if(e){let{columnsToRender:n}=this.table,i=n+t;for(let c=0,u=e;c<u;c++){for(o=this.rootNode.childNodes[c],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<i;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)o.removeChild(o.lastChild),this.renderedNodes-=1}let a=this.rootNode.childNodes.length;if(a>e)for(let c=e;c<a;c++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Po(o)}render(){let{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Se(this.rootNode,[nu()]);for(let t=0;t<e;t+=1){let{columnHeaderFunctions:o,columnsToRender:n,rowHeadersCount:i}=this.table,a=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Se(a,[Ba(),lu(t+1)]);for(let c=-1*i;c<n;c+=1){let u=this.table.renderedColumnToSource(c),m=a.childNodes[c+i];m.className="",m.removeAttribute("style"),ko(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(m,[ys(c+1+this.table.rowHeadersCount),Vi(-1),VR(),...c>=0?[WR()]:[Ba()]]),o[t](u,m,t)}}}};var Ax=!1,Vu=class extends $r{constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:t}=this.table,o=e+t;for(;this.renderedNodes<o;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>o;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:t}=this.table;!Ax&&e>1e3&&(Ax=!0,Dr(mt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<t;n++){let i=this.table.renderedColumnToSource(n),a=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[n].style.width=`${a}px`}for(let n=0;n<e;n++){let i=this.table.renderedColumnToSource(n),a=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[n+t].style.width=`${a}px`}let o=this.rootNode.firstChild;o&&se(o,"rowHeader")}};var oK=S(V(),1);function fV(r,e,t){return(e=mV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function mV(r){var e=pV(r,"string");return typeof e=="symbol"?e:e+""}function pV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Wu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},Nx=!1,Bu=class extends $r{constructor(e){super("TR",e),fV(this,"orderView",void 0),this.orderView=new Hn(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){let{rowsToRender:e}=this.table;!Nx&&e>1e3&&(Nx=!0,Dr(mt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Se(this.rootNode,[nu()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();let i=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var t,o;Se(i,[Ba(),lu(a+((t=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}Fe(i,[Wu.rowEven,Wu.rowOdd]),(a+1)%2===0?se(i,Wu.rowEven):se(i,Wu.rowOdd)}this.orderView.end()}};var dK=S(V(),1);function kx(r,e,t){return(e=gV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function gV(r){var e=wV(r,"string");return typeof e=="symbol"?e:e+""}function wV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Uu=class extends $r{constructor(){super("TD"),kx(this,"orderViews",new WeakMap),kx(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new An(e,o=>this.nodesPool.obtain(this.sourceRowIndex,o),this.nodeType),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,columnsToRender:t,rows:o,rowHeaders:n}=this.table;for(let c=0;c<e;c++){let u=this.table.renderedRowToSource(c),m=o.getRenderedNode(c);this.sourceRowIndex=u;let g=this.obtainOrderView(m),C=n.obtainOrderView(m);g.prependView(C).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let v=0;v<t;v++){g.render();let y=g.getCurrentNode(),R=this.table.renderedColumnToSource(v);if(He(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),ko(y,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,R,y),this.table.isAriaEnabled()){var i,a;Se(y,[...y.hasAttribute("role")?[]:[LR()],Vi(-1),ys(R+((i=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&i!==void 0?i:0)+1)])}}g.end()}}};var wK=S(V(),1);function It(r,e,t){return(e=bV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function bV(r){var e=CV(r,"string");return typeof e=="symbol"?e:e+""}function CV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ju=class{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};It(this,"rootNode",void 0),It(this,"rootDocument",void 0),It(this,"rowHeaders",null),It(this,"columnHeaders",null),It(this,"colGroup",null),It(this,"rows",null),It(this,"cells",null),It(this,"rowFilter",null),It(this,"columnFilter",null),It(this,"rowUtils",null),It(this,"columnUtils",null),It(this,"rowsToRender",0),It(this,"columnsToRender",0),It(this,"rowHeaderFunctions",[]),It(this,"rowHeadersCount",0),It(this,"columnHeaderFunctions",[]),It(this,"columnHeadersCount",0),It(this,"cellRenderer",void 0),It(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:o,rows:n,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),o.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=o,this.rows=n,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:t}=this;for(let o=0;o<e;o++){let n=t.getRenderedNode(o);if(n.firstChild){let i=this.renderedRowToSource(o),a=this.rowUtils.getHeightByOverlayName(i,this.activeOverlayName);a?n.firstChild.style.height=`${a-1}px`:n.firstChild.style.height=""}}}};var zu=class{constructor(){let{TABLE:e,THEAD:t,COLGROUP:o,TBODY:n,rowUtils:i,columnUtils:a,cellRenderer:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new ju(e,{cellRenderer:c}),this.renderer.setRenderers({rowHeaders:new Lu,columnHeaders:new Fu(t),colGroup:new Vu(o),rows:new Bu(n),cells:new Uu}),this.renderer.setAxisUtils(i,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var MK=S(V(),1);var EK=S(V(),1);function gl(r,e,t){vV(r,e),e.set(r,t)}function vV(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(r,e,t){return(e=yV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function yV(r){var e=SV(r,"string");return typeof e=="symbol"?e:e+""}function SV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ur(r,e){return r.get(Px(r,e))}function wl(r,e,t){return r.set(Px(r,e),t),t}function Px(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qu=new WeakMap,Ds=new WeakMap,bl=new WeakMap,Gu=new WeakMap,Nn=new WeakMap,$u=class{constructor(e){let{totalColumns:t,stretchMode:o,stretchingColumnWidthFn:n,columnWidthFn:i}=e;Yu(this,"stretchAllRatio",0),Yu(this,"stretchLastWidth",0),Yu(this,"stretchAllColumnsWidth",[]),gl(this,qu,0),Yu(this,"needVerifyLastColumnWidth",!0),gl(this,Ds,()=>0),gl(this,bl,a=>a),gl(this,Gu,a=>a),gl(this,Nn,()=>"none"),wl(Ds,this,t),wl(Nn,this,o),wl(bl,this,n??ur(bl,this)),wl(Gu,this,i??ur(Gu,this))}refreshStretching(e){if(ur(Nn,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,wl(qu,this,e);let t=0;for(let n=0;n<ur(Ds,this).call(this);n++){let i=this._getColumnWidth(n),a=ur(bl,this).call(this,void 0,n);typeof a=="number"?e-=a:t+=i}let o=e-t;if(ur(Nn,this).call(this)==="all"&&o>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(ur(Nn,this).call(this)==="last"&&e!==1/0){let n=this._getColumnWidth(ur(Ds,this).call(this)-1),i=o+n;this.stretchLastWidth=i>=0?i:n}}getStretchedColumnWidth(e,t){let o=null;return ur(Nn,this).call(this)==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(e,t):ur(Nn,this).call(this)==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(e)),o}_getStretchedAllColumnWidth(e,t){let o=0;if(!this.stretchAllColumnsWidth[e]){let n=Math.round(t*this.stretchAllRatio),i=ur(bl,this).call(this,n,e);i===void 0?this.stretchAllColumnsWidth[e]=n:this.stretchAllColumnsWidth[e]=isNaN(i)?this._getColumnWidth(e):i}if(this.stretchAllColumnsWidth.length===ur(Ds,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let n=0;n<this.stretchAllColumnsWidth.length;n++)o+=this.stretchAllColumnsWidth[n];o!==ur(qu,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=ur(qu,this)-o)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===ur(Ds,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=ur(Gu,this).call(this,e);return isNaN(t)&&(t=On),t}};function Ku(r,e,t){return(e=RV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function RV(r){var e=TV(r,"string");return typeof e=="symbol"?e:e+""}function TV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Xu=class{constructor(e,t){Ku(this,"dataAccessObject",void 0),Ku(this,"wtSettings",void 0),Ku(this,"headerWidths",new Map),Ku(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new $u({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(o,n)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",o,n),columnWidthFn:o=>this.dataAccessObject.wtTable.getColumnWidth(o)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e),o=this.stretching.getStretchedColumnWidth(e,t);return o&&(t=o),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return o!==void 0&&(t=t?Math.max(t,o):o),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){let{wtTable:e,wtViewport:t,cloneSource:o}=this.dataAccessObject,n=o?o.wtTable.holder:e.holder,i=n.offsetHeight<n.scrollHeight?Xe():0;this.stretching.refreshStretching(t.getViewportWidth()-i)}calculateWidths(){let{wtSettings:e}=this,t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){let o=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let i=0;i<o;i++){let a=Array.isArray(t)?t[i]:t;a=a??n,this.headerWidths.set(i,a)}}}};var NK=S(V(),1);function Dx(r,e,t){return(e=xV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function xV(r){var e=EV(r,"string");return typeof e=="symbol"?e:e+""}function EV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Qu=class{constructor(e,t){Dx(this,"dataAccessObject",void 0),Dx(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e),o=this.dataAccessObject.wtViewport.oversizedRows[e];return o!==void 0&&(t=t===void 0?o:Math.max(t,o)),t}getHeightByOverlayName(e,t){let o=this.wtSettings.getSetting("rowHeightByOverlayName",e,t),n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(o=o===void 0?n:Math.max(o,n)),o}};function Wo(r,e,t){return(e=_V(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _V(r){var e=OV(r,"string");return typeof e=="symbol"?e:e+""}function OV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var $m=class{constructor(e,t,o,n,i){Wo(this,"wtSettings",null),Wo(this,"domBindings",void 0),Wo(this,"TBODY",null),Wo(this,"THEAD",null),Wo(this,"COLGROUP",null),Wo(this,"hasTableHeight",!0),Wo(this,"hasTableWidth",!0),Wo(this,"isTableVisible",!1),Wo(this,"tableOffset",0),Wo(this,"holderOffset",0),this.domBindings=o,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,nm(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new Qu(this.dataAccessObject,this.wtSettings),this.columnUtils=new Xu(this.dataAccessObject,this.wtSettings),this.tableRenderer=new zu({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let t=e.parentNode,o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!He(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",t&&t.insertBefore(o,e),o.appendChild(e)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Se(o,[Pr()]),o}createHider(e){let t=e.parentNode,o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!He(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",t&&t.insertBefore(o,e),o.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(o,[Pr()]),o}createHolder(e){let t=e.parentNode,o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!He(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",t&&t.insertBefore(o,e),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Se(o.parentNode,[Pr()])),o.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(o,[Pr()]),o}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:t}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,i=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),c=t.getSetting("rowHeaders"),u=c.length,m=t.getSetting("columnHeaders"),g=m.length,C=e;if(this.isMaster&&(o.beforeDraw(),this.holderOffset=Yt(this.holder),C=n.createCalculators(C),u&&!t.getSetting("fixedColumnsStart"))){let y=o.inlineStartOverlay.getScrollPosition(),R=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,R!==this.correctHeaderWidth&&(C=!1)}if(C)this.isMaster&&o.refresh(!0);else{this.isMaster?this.tableOffset=Yt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let y=i>0?this.getFirstRenderedRow():0,R=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ix(y,i,g),this.columnFilter=new Mx(R,a,u);let O=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let N={};this.wtSettings.getSetting("beforeDraw",!0,N),O=N.skipRender!==!0}if(O){this.tableRenderer.setHeaderContentRenderers(c,m),(this.is(Fr)||this.is(vo))&&this.tableRenderer.setHeaderContentRenderers(c,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let N;if(this.isMaster&&(N=this.dataAccessObject.workspaceWidth,n.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fr))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),o.refresh(!1),o.applyToDOM();let I=Ke(this.hider),j=Ke(this.TABLE);I!==0&&j!==I&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),N!==n.getWorkspaceWidth()&&(n.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Fr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let v=!1;return this.isMaster&&(v=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(v=o.bottomOverlay.resetFixedPosition()||v),v=o.inlineStartOverlay.resetFixedPosition()||v,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),v?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(C),this.isMaster&&o.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let t=this.columnFilter.renderedToSource(e),o=this.wtSettings.getSetting("columnHeaders").length,n=this.wtSettings.getSetting("defaultRowHeight"),i,a,c,u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;o;)o-=1,i=this.getColumnHeaderHeight(o),a=this.getColumnHeader(t,o),a&&(c=ci(a),(!i&&n<c||i<c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=c),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,t=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=e.getSetting("columnHeaders");for(let i=0,a=n.length;i<a;i++)if(o[i]){if(!t[i]||t[i].childNodes.length===0)return;t[i].childNodes[0].style.height=`${o[i]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Fr))&&!e.getSetting("externalRowCalculator")){let o=this.getRenderedRowsCount();for(let n=0;n<o;n++){let i=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}}getCell(e){let t=e.row,o=e.col,n=this.wtSettings.getSetting("onModifyGetCellCoords",t,o);if(n&&Array.isArray(n)&&([t,o]=n),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;let i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");let a=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!a&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,o=null;if(e<0){var n;t=(n=this.rowFilter)===null||n===void 0?void 0:n.sourceRowToVisibleColHeadedRow(e),o=this.THEAD}else{var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),o=this.TBODY}return t!==void 0&&o!==void 0?o.childNodes.length<t+1?!1:o.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[t];return o?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let t=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(n=>{let i=n.childNodes[o];i&&t.push(i)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.wtSettings.getSetting("rowHeaders").length;if(t>=o)return;let n=this.rowFilter.sourceToRendered(e),i=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,c=(n<0?this.THEAD:this.TBODY).childNodes[i];return c?.childNodes[t]}getRowHeaders(e){let t=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=i?.childNodes[n];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=im(t,["TD","TH"])),t===null)return null;let o=t.parentNode,n=o.parentNode,i=YR(o),a=t.cellIndex;return Bi(Bo,t,this.wtRootElement)||Bi(yo,t,this.wtRootElement)?n.nodeName==="THEAD"&&(i-=n.childNodes.length):Bi(vo,t,this.wtRootElement)||Bi(Fr,t,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-n.childNodes.length+i:n===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),Bi(Bo,t,this.wtRootElement)||Bi(So,t,this.wtRootElement)||Bi(vo,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length,t=e*this.wtSettings.getSetting("defaultRowHeight"),o=ci(this.TBODY)-1,n,i,a,c,u;if(!(t===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,a=this.rowFilter.renderedToSource(e),n=this.getRowHeight(a),c=this.getTrForRow(a),u=c.querySelector("th"),u?i=ci(u):i=ci(c)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<i||n<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;let o=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=o}isRowHeaderRendered(e){if(e>=0)return!1;let o=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=o}isRowBeforeRenderedRows(e){let t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Ke(this.TABLE)}getHeight(){return Rt(this.TABLE)}getTotalWidth(){let e=Ke(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){let e=Rt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Wi(this.TABLE)}_modifyRowHeaderWidth(e){let t=Re(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},Kr=$m;var MV="stickyRowsBottom",Lx={getFirstRenderedRow(){let r=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=r-e;return r===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};lr(Lx,"MIXIN_NAME",MV,{writable:!1,enumerable:!1});var Zu=Lx;var IV="stickyColumnsStart",Fx={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let r=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lr(Fx,"MIXIN_NAME",IV,{writable:!1,enumerable:!1});var Ls=Fx;var Cl=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,vo)}};Te(Cl,Zu);Te(Cl,Ls);var Vx=Cl;var v3=S(V(),1);var yo="top",Fr="bottom",So="inline_start",Bo="top_inline_start_corner",vo="bottom_inline_start_corner",Ju=[yo,Fr,So,Bo,vo],Wx=new Map([[yo,`ht_clone_${yo}`],[Fr,`ht_clone_${Fr}`],[So,`ht_clone_${So} ht_clone_left`],[Bo,`ht_clone_${Bo} ht_clone_top_left_corner`],[vo,`ht_clone_${vo} ht_clone_bottom_left_corner`]]);var g3=S(V(),1);var a3=S(V(),1),l3=S(me(),1);var i3=S(V(),1);function HV(r,e){AV(r,e),e.add(r)}function AV(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NV(r,e,t){return(e=kV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kV(r){var e=PV(r,"string");return typeof e=="symbol"?e:e+""}function PV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ed(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var vl=new WeakSet,Km=class{constructor(e){HV(this,vl),NV(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,o,n,i){let a=this.scrollViewportHorizontally(e.col,o,i),c=this.scrollViewportVertically(e.row,t,n);return a||c}scrollViewportHorizontally(e,t,o){let{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>i)return!1;let a=t===void 0&&o===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(a&&e<c||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>i))return!1;let m=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn(),C=!1;return(a&&(e<m||e>g)||!a)&&(C=u.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():t)),C}scrollViewportVertically(e,t,o){let{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>i)return!1;let a=t===void 0&&o===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:m}=this.dataAccessObject;if(a&&(e<u||e>i-c-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>i))return!1;let g=this.getFirstVisibleRow(),C=this.getLastVisibleRow(),v=!1;return(a&&(e<g||e>C)||!a)&&(v=m.scrollTo(e,a?e>=this.getLastPartiallyVisibleRow():o)),v}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return ed(vl,this,Ux).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return ed(vl,this,Ux).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return ed(vl,this,Bx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return ed(vl,this,Bx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function Bx(r){let{wtSettings:e,inlineStartOverlay:t,wtTable:o,wtViewport:n,totalColumns:i,rootWindow:a}=this.dataAccessObject;if(t.mainTableScrollableElement===a){let c=e.getSetting("rtlMode"),u=null;if(c){let g=o.TABLE.getBoundingClientRect(),v=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(g.right-v)}else u=Yt(o.wtRootElement).left;let m=Math.abs(uu(a,a));if(u>m){let g=du(a),C=n.getRowHeaderWidth();for(let v=1;v<=i;v++)if(C+=t.sumCellSizes(v-1,v),u+C-m>=g){r=v-2;break}}}return r}function Ux(r){let{topOverlay:e,wtTable:t,wtViewport:o,totalRows:n,rootWindow:i}=this.dataAccessObject;if(e.mainTableScrollableElement===i){let a=Yt(t.wtRootElement),c=Rs(i,i);if(a.top>c){let u=ci(i),m=o.getColumnHeaderHeight();for(let g=1;g<=n;g++)if(m+=e.sumCellSizes(g-1,g),a.top+m-c>=u){r=g-2;break}}}return r}var jx=Km;function Ro(r,e,t){return(e=DV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function DV(r){var e=LV(r,"string");return typeof e=="symbol"?e:e+""}function LV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Ki=class{get eventManager(){return new wo(this)}constructor(e,t){Ro(this,"wtTable",void 0),Ro(this,"wtScroll",void 0),Ro(this,"wtViewport",void 0),Ro(this,"wtOverlays",void 0),Ro(this,"selectionManager",void 0),Ro(this,"wtEvent",void 0),Ro(this,"guid",`wt_${iu()}`),Ro(this,"drawInterrupted",!1),Ro(this,"drawn",!1),Ro(this,"domBindings",void 0),Ro(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new jx(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;t<o;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,o){li(o,e[t])}])}}createCellCoords(e,t){return new Gi(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,o){return new Mn(e,t,o,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);let o=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=o-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<o&&e.row>=o-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,o,n,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,o,n,i)}scrollViewportHorizontally(e,t,o){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}};function zx(r,e,t){return(e=FV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function FV(r){var e=VV(r,"string");return typeof e=="symbol"?e:e+""}function VV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var td=class extends Ki{constructor(e,t,o){super(e,t),zx(this,"cloneSource",void 0),zx(this,"cloneOverlay",void 0);let n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new Nu(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}};function WV(r,e,t){return(e=BV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function BV(r){var e=UV(r,"string");return typeof e=="symbol"?e:e+""}function UV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Xr=class{constructor(e,t,o,n,i){WV(this,"wtSettings",null),lr(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=n;let{TABLE:a,hider:c,spreader:u,holder:m,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=c,this.spreader=u,this.holder=m,this.wtRootElement=g,this.trimmingContainer=Sn(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Sn(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ts(e.TABLE)}getRelativeCellPosition(e,t,o){if(this.clone.wtTable.holder.contains(e)===!1){Dr(`The provided element is not a child of the ${this.type} overlay`);return}let n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=o<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),c=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,m={start:this.getRelativeStartPosition(u),top:u.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop},C=null;return n?C=this.getRelativeCellPositionWithinWindow(a,i,g,m):C=this.getRelativeCellPositionWithinHolder(a,c,i,g,m),C}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,o,n){let i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,c=0;if(!t)a=n.start;else{let u=i.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Xe())),a=u<=0?-1*u:0}return e?c=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:c=n.top,{start:o.start+a,top:o.top+c}}getRelativeCellPositionWithinHolder(e,t,o,n,i){let a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},c=0,u=0;if(o||(c=a.horizontal-i.start),t){let m=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+m.top}else e||(u=a.vertical-i.top);return{start:n.start-c,top:n.top-u}}makeClone(){if(Ju.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e,wtSettings:t}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=o.createElement("div"),a=o.createElement("table"),c=e.wtRootElement.parentNode;i.className=`${Wx.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Se(i,[Pr()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(a),c.appendChild(i);let m=this.wtSettings.getSetting("preventOverflow");return m===!0||m==="horizontal"&&this.type===yo||m==="vertical"&&this.type===So?this.mainTableScrollableElement=n:n.getComputedStyle(c).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ts(e.TABLE),new td(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){let e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,o=e.style,n=t.style,i=e.parentNode.style;[o,n,i].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};var yl=class extends Xr{constructor(e,t,o,n,i,a){super(e,t,vo,o,n),this.bottomOverlay=i,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new Vx(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let i=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${i}px`,t.style.bottom=`${a}px`}else Ui(t),this.repositionOverlay();let o=Rt(this.clone.wtTable.TABLE),n=Ke(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height=`${o}px`,t.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Xe(o)),n.style.bottom=`${i}px`}};var B3=S(V(),1);var jV="calculatedColumns",Yx={getFirstRenderedColumn(){let r=this.dataAccessObject.startColumnRendered;return r===null?-1:r},getFirstVisibleColumn(){let r=this.dataAccessObject.startColumnVisible;return r===null?-1:r},getFirstPartiallyVisibleColumn(){let r=this.dataAccessObject.startColumnPartiallyVisible;return r===null?-1:r},getLastRenderedColumn(){let r=this.dataAccessObject.endColumnRendered;return r===null?-1:r},getLastVisibleColumn(){let r=this.dataAccessObject.endColumnVisible;return r===null?-1:r},getLastPartiallyVisibleColumn(){let r=this.dataAccessObject.endColumnPartiallyVisible;return r===null?-1:r},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lr(Yx,"MIXIN_NAME",jV,{writable:!1,enumerable:!1});var Fs=Yx;var Sl=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,Fr)}};Te(Sl,Zu);Te(Sl,Fs);var qx=Sl;function zV(r,e,t){return(e=YV(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function YV(r){var e=qV(r,"string");return typeof e=="symbol"?e:e+""}function qV(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Rl=class extends Xr{constructor(e,t,o,n){super(e,t,Fr,o,n),zV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new qx(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let o=0,n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!n||n!=="vertical")?(o=this.getOverlayOffset(),t.style.bottom=`${o}px`):(o=this.getScrollPosition(),this.repositionOverlay());let i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Xe(o)),n.style.bottom=`${i}px`}setScrollPosition(e){let{rootWindow:t}=this.domBindings,o=!1;return this.mainTableScrollableElement===t?(t.scrollTo(za(t),e),o=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let{wtTable:o,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight"),a=e,c=0;for(;a<t;){let u=o.getRowHeight(a);c+=u===void 0?i:u,a+=1}return c}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=Xe(o),c=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||u==="horizontal"){let g=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(g-=i),g=Math.min(g,e.wtRootElement.scrollWidth),c.width=`${g}px`}else c.width="";this.clone.wtTable.holder.style.width=c.width;let m=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(m=0),c.height=`${m}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let o=this.getTableParentOffset(),i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,a=0;t&&i.offsetHeight!==i.clientHeight&&(a=Xe(this.domBindings.rootDocument)),t?(o+=this.sumCellSizes(0,e+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),o+=a,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rs(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){let n=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),a=n-i,c=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+n,0),o>a&&(o=0)}return o}adjustHeaderBordersPosition(e){let t=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==t,n=this.wtSettings.getSetting("columnHeaders"),i=!1;if((o||t===0)&&n.length>0){let a=this.wot.wtTable.holder.parentNode,c=He(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(se(a,"innerBorderBottom"),i=!c):(Fe(a,"innerBorderBottom"),i=c)}return i}};var qX=S(V(),1);var GV="calculatedRows",Gx={getFirstRenderedRow(){let r=this.dataAccessObject.startRowRendered;return r===null?-1:r},getFirstVisibleRow(){let r=this.dataAccessObject.startRowVisible;return r===null?-1:r},getFirstPartiallyVisibleRow(){let r=this.dataAccessObject.startRowPartiallyVisible;return r===null?-1:r},getLastRenderedRow(){let r=this.dataAccessObject.endRowRendered;return r===null?-1:r},getLastVisibleRow(){let r=this.dataAccessObject.endRowVisible;return r===null?-1:r},getLastPartiallyVisibleRow(){let r=this.dataAccessObject.endRowPartiallyVisible;return r===null?-1:r},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lr(Gx,"MIXIN_NAME",GV,{writable:!1,enumerable:!1});var rd=Gx;var Tl=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,So)}};Te(Tl,rd);Te(Tl,Ls);var $x=Tl;var tX=S(me(),1);var $V="localHooks",Kx={_localHooks:Object.create(null),addLocalHook(r,e){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(e),this},runLocalHooks(r,e,t,o,n,i,a){if(this._localHooks[r]){let c=this._localHooks[r].length;for(let u=0;u<c;u++)Ga(this._localHooks[r][u],this,e,t,o,n,i,a)}},clearLocalHooks(){return this._localHooks={},this}};lr(Kx,"MIXIN_NAME",$V,{writable:!1,enumerable:!1});var dr=Kx;var od=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Te(od,dr);var id=od;var nd="active-header",Vs="header",Xi="area",kn="focus",sd="fill",ad="row",ld="column",cd="custom-selection";var Ws=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var OX=S(V(),1),MX=S(me(),1),IX=S(Xx(),1),HX=S(tr(),1),AX=S(rr(),1),NX=S(or(),1),kX=S(ir(),1),PX=S(nr(),1),DX=S(sr(),1),LX=S(ar(),1);var hX=S(V(),1),fX=S(tr(),1),mX=S(rr(),1),pX=S(or(),1),gX=S(ir(),1),wX=S(nr(),1),bX=S(sr(),1),CX=S(ar(),1);function XV(r,e){Jx(r,e),e.add(r)}function Qx(r,e,t){Jx(r,e),e.set(r,t)}function Jx(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gt(r,e){return r.get(xl(r,e))}function Zx(r,e,t){return r.set(xl(r,e),t),t}function xl(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var To=new WeakMap,Er=new WeakMap,ud=new WeakSet,dd=class{constructor(){XV(this,ud),Qx(this,To,void 0),Qx(this,Er,void 0)}setActiveOverlay(e){return Zx(Er,this,e),this}setActiveSelection(e){return Zx(To,this,e),this}scan(){let e=gt(To,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o))):e==="area"?this.scanCellsRange(o=>t.add(o)):e==="focus"?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o)),this.scanCellsRange(o=>t.add(o))):e==="fill"?this.scanCellsRange(o=>t.add(o)):e==="header"?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o))):e==="row"?(this.scanRowsInHeadersRange(o=>t.add(o)),this.scanRowsInCellsRange(o=>t.add(o))):e==="column"&&(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanColumnsInCellsRange(o=>t.add(o))),t}scanColumnsInHeadersRange(e){let[t,o,n,i]=gt(To,this).getCorners(),{wtTable:a}=gt(Er,this),c=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount(),m=0;for(let g=-a.getRowHeadersCount();g<c;g++){let C=a.columnFilter.renderedToSource(g);if(!(C<o||C>i)){for(let v=-u;v<0;v++){if(v<t||v>n)continue;let y=v+u,R=a.getColumnHeader(C,y),O=gt(Er,this).getSetting("onBeforeHighlightingColumnHeader",C,y,{selectionType:gt(To,this).settings.selectionType,columnCursor:m,selectionWidth:i-o+1});O!==null&&(O!==C&&(R=a.getColumnHeader(O,y)),e(R))}m+=1}}}scanRowsInHeadersRange(e){let[t,o,n,i]=gt(To,this).getCorners(),{wtTable:a}=gt(Er,this),c=a.getRenderedRowsCount(),u=a.getRowHeadersCount(),m=0;for(let g=-a.getColumnHeadersCount();g<c;g++){let C=a.rowFilter.renderedToSource(g);if(!(C<t||C>n)){for(let v=-u;v<0;v++){if(v<o||v>i)continue;let y=v+u,R=a.getRowHeader(C,y),O=gt(Er,this).getSetting("onBeforeHighlightingRowHeader",C,y,{selectionType:gt(To,this).settings.selectionType,rowCursor:m,selectionHeight:n-t+1});O!==null&&(O!==C&&(R=a.getRowHeader(O,y)),e(R))}m+=1}}}scanCellsRange(e){let[t,o,n,i]=gt(To,this).getCorners(),{wtTable:a}=gt(Er,this);xl(ud,this,Xm).call(this,(c,u)=>{if(c>=t&&c<=n&&u>=o&&u<=i){let m=a.getCell(gt(Er,this).createCellCoords(c,u)),g=gt(Er,this).getSetting("onAfterDrawSelection",c,u,gt(To,this).settings.layerLevel);typeof g=="string"&&se(m,g),e(m)}})}scanRowsInCellsRange(e){let[t,,o]=gt(To,this).getCorners(),{wtTable:n}=gt(Er,this);xl(ud,this,Xm).call(this,(i,a)=>{if(i>=t&&i<=o){let c=n.getCell(gt(Er,this).createCellCoords(i,a));e(c)}})}scanColumnsInCellsRange(e){let[,t,,o]=gt(To,this).getCorners(),{wtTable:n}=gt(Er,this);xl(ud,this,Xm).call(this,(i,a)=>{if(a>=t&&a<=o){let c=n.getCell(gt(Er,this).createCellCoords(i,a));e(c)}})}};function Xm(r){let{wtTable:e}=gt(Er,this),t=e.getRenderedRowsCount(),o=e.getRenderedColumnsCount();for(let n=0;n<t;n+=1){let i=e.rowFilter.renderedToSource(n);for(let a=0;a<o;a+=1)r(i,e.columnFilter.renderedToSource(a))}}var Qm=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ws,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,o=this.main.childNodes.length;t<o;t++){let n=this.main.childNodes[t];this.eventManager.addEventListener(n,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),zi(e);let o=this,n=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none";function a(u){if(u.clientY<Math.floor(i.top)||u.clientY>Math.ceil(i.top+i.height)||u.clientX<Math.floor(i.left)||u.clientX>Math.ceil(i.left+i.width))return!0}function c(u){a(u)&&(o.eventManager.removeEventListener(n,"mousemove",c),t.style.display="block")}this.eventManager.addEventListener(n,"mousemove",c)}createBorders(e){let{rootDocument:t}=this.wot;this.main=t.createElement("div");let o=["top","start","bottom","end","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let c=0;c<5;c++){let u=o[c],m=t.createElement("div");m.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(m.className+=" hidden"),n=m.style,n.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,n.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,n.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(m)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ui()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:i}=this.wot,a=i.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",i.bordersHolder=a,i.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};let t=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let n={position:"absolute",height:`${o}px`,width:`${o}px`,"border-radius":`${parseInt(o/1.5,10)}px`};be(n,(a,c)=>{this.selectionHandles.styles.bottomHitArea[c]=a,this.selectionHandles.styles.topHitArea[c]=a});let i={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};be(i,(a,c)=>{this.selectionHandles.styles.bottom[c]=a,this.selectionHandles.styles.top[c]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){let o=this.wot.selectionManager.getAreaSelection();return!!(o.cellRange&&(e!==o.cellRange.to.row||t!==o.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,o,n,i,a){let u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:m,topHitArea:g,bottom:C,bottomHitArea:v}=this.selectionHandles.styles,y=parseInt(m.borderWidth,10),R=parseInt(m.width,10),O=parseInt(g.width,10),N=this.wot.wtTable.getWidth(),I=this.wot.wtTable.getHeight();m.top=`${parseInt(o-R-1,10)}px`,m[u]=`${parseInt(n-R-1,10)}px`,g.top=`${parseInt(o-O/4*3,10)}px`,g[u]=`${parseInt(n-O/4*3,10)}px`;let j=Math.min(parseInt(n+i,10),N-R-y*2),ie=Math.min(parseInt(n+i-O/4,10),N-O-y*2);C[u]=`${j}px`,v[u]=`${ie}px`;let ue=Math.min(parseInt(o+a,10),I-R-y*2),de=Math.min(parseInt(o+a-O/4,10),I-O-y*2);C.top=`${ue}px`,v.top=`${de}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(m.display="block",g.display="block",this.isPartRange(e,t)?(C.display="none",v.display="none"):(C.display="block",v.display="block")):(m.display="none",C.display="none",g.display="none",v.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(m.zIndex="9999",g.zIndex="9999"):(m.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let{wtTable:t,rootDocument:o,rootWindow:n}=this.wot,i,a,c,u,m,g,C=t.getRenderedRowsCount();for(let F=0;F<C;F+=1){let ae=t.rowFilter.renderedToSource(F);if(ae>=e[0]&&ae<=e[2]){i=ae,m=e[0];break}}for(let F=C-1;F>=0;F-=1){let ae=t.rowFilter.renderedToSource(F);if(ae>=e[0]&&ae<=e[2]){a=ae;break}}let v=t.getRenderedColumnsCount();for(let F=0;F<v;F+=1){let ae=t.columnFilter.renderedToSource(F);if(ae>=e[1]&&ae<=e[3]){c=ae,g=e[1];break}}for(let F=v-1;F>=0;F-=1){let ae=t.columnFilter.renderedToSource(F);if(ae>=e[1]&&ae<=e[3]){u=ae;break}}if(i===void 0||c===void 0){this.disappear();return}let y=t.getCell(this.wot.createCellCoords(i,c)),R=i!==a||c!==u,O=R?t.getCell(this.wot.createCellCoords(a,u)):y,N=Yt(y),I=R?Yt(O):N,j=Yt(t.TABLE),ie=Ke(t.TABLE),ue=N.top,de=N.left,J=this.wot.wtSettings.getSetting("rtlMode"),te=0,q=0;if(J){let F=Ke(y),ae=n.innerWidth-j.left-ie;q=de+F-I.left,te=n.innerWidth-de-F-ae-1}else q=I.left+Ke(O)-de,te=de-j.left-1;if(this.isEntireColumnSelected(i,a)){let F=this.getDimensionsFromHeader("columns",c,u,m,j),ae=null;F&&([ae,te,q]=F),ae&&(y=ae)}let at=ue-j.top-1,rt=I.top+Rt(O)-ue;if(this.isEntireRowSelected(c,u)){let F=this.getDimensionsFromHeader("rows",i,a,g,j),ae=null;F&&([ae,at,rt]=F),ae&&(y=ae)}let Ne=Ur(y,n);parseInt(Ne.borderTopWidth,10)>0&&(at+=1,rt=rt>0?rt-1:0),parseInt(Ne[J?"borderRightWidth":"borderLeftWidth"],10)>0&&(te+=1,q=q>0?q-1:0);let Kt=J?"right":"left";this.topStyle.top=`${at}px`,this.topStyle[Kt]=`${te}px`,this.topStyle.width=`${q}px`,this.topStyle.display="block",this.startStyle.top=`${at}px`,this.startStyle[Kt]=`${te}px`,this.startStyle.height=`${rt}px`,this.startStyle.display="block";let Ir=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${at+rt-Ir}px`,this.bottomStyle[Kt]=`${te}px`,this.bottomStyle.width=`${q}px`,this.bottomStyle.display="block",this.endStyle.top=`${at}px`,this.endStyle[Kt]=`${te+q-Ir}px`,this.endStyle.height=`${rt+1}px`,this.endStyle.display="block";let Me=this.settings.border.cornerVisible;Me=typeof Me=="function"?Me(this.settings.layerLevel):Me;let At=this.wot.getSetting("onModifyGetCellCoords",a,u),[Ge,Bt]=[a,u];if(At&&Array.isArray(At)&&([,,Ge,Bt]=At),ui()||!Me||this.isPartRange(Ge,Bt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${at+rt+this.cornerCenterPointOffset-1}px`,this.cornerStyle[Kt]=`${te+q+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let F=Sn(t.TABLE),ae=F===n;ae&&(F=o.documentElement);let Nt=parseInt(this.cornerDefaultStyle.width,10)/2,f=parseInt(this.cornerDefaultStyle.height,10)/2;if(u===this.wot.getSetting("totalColumns")-1){let p=ae?O.getBoundingClientRect().left:O.offsetLeft,w=!1,E=0;J?(E=p-parseInt(this.cornerDefaultStyle.width,10)/2,w=E<0):(E=p+Ke(O)+parseInt(this.cornerDefaultStyle.width,10)/2,w=E>=du(F)),w&&(this.cornerStyle[Kt]=`${Math.floor(te+q+this.cornerCenterPointOffset-Nt)}px`,this.cornerStyle[J?"borderLeftWidth":"borderRightWidth"]=0)}a===this.wot.getSetting("totalRows")-1&&(ae?O.getBoundingClientRect().top:O.offsetTop)+Rt(O)+parseInt(this.cornerDefaultStyle.height,10)/2>=ci(F)&&(this.cornerStyle.top=`${Math.floor(at+rt+this.cornerCenterPointOffset-f)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}ui()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(a,u,at,te,q,rt)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,o,n,i){let{wtTable:a}=this.wot,c=a.wtRootElement.parentNode,u=null,m=null,g=null,C=null,v=null,y=null,R=null,O=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},m=function(){return Rt(...arguments)},g="ht__selection--rows",y="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},m=function(){return Ke(...arguments)},g="ht__selection--columns",y="left";break;default:}if(c.classList.contains(g)){let N=this.wot.getSetting("columnHeaders").length;if(R=u(t,N-n),O=u(o,N-n),!R||!O)return!1;let I=Yt(R),j=Yt(O);return R&&O&&(C=I[y]-i[y]-1,v=j[y]+m(O)-I[y]),[R,C,v]}return!1}changeBorderStyle(e,t){let o=this[e].style,n=t[e];!n||n.hide?se(this[e],"hidden"):(He(this[e],"hidden")&&Fe(this[e],"hidden"),o.backgroundColor=n.color,(e==="top"||e==="bottom")&&(o.height=`${n.width}px`),(e==="start"||e==="end")&&(o.width=`${n.width}px`))}changeBorderToDefaultStyle(e){let t={width:1,color:"#000"},o=this[e].style;o.backgroundColor=t.color,o.width=`${t.width}px`,o.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?se(this[e],"hidden"):Fe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ui()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},Zm=Qm;function QV(r,e){rE(r,e),e.add(r)}function Bs(r,e,t){rE(r,e),e.set(r,t)}function rE(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(r,e){return r.get(tp(r,e))}function eE(r,e,t){return r.set(tp(r,e),t),t}function tp(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hr=new WeakMap,_r=new WeakMap,Jm=new WeakMap,El=new WeakMap,ep=new WeakMap,Pn=new WeakMap,tE=new WeakSet,hd=class{constructor(e){QV(this,tE),Bs(this,hr,void 0),Bs(this,_r,void 0),Bs(this,Jm,new dd),Bs(this,El,new WeakMap),Bs(this,ep,new WeakSet),Bs(this,Pn,new Map),eE(_r,this,e)}setActiveOverlay(e){return eE(hr,this,e),ge(Jm,this).setActiveOverlay(ge(hr,this)),ge(El,this).has(ge(hr,this))||ge(El,this).set(ge(hr,this),new Set),this}getFocusSelection(){return ge(_r,this)!==null?ge(_r,this).getFocus():null}getAreaSelection(){return ge(_r,this)!==null?ge(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ge(Pn,this).has(e)){let o=ge(Pn,this).get(e);if(o.has(ge(hr,this)))return o.get(ge(hr,this));let n=new Zm(ge(hr,this),e.settings);return o.set(ge(hr,this),n),n}let t=new Zm(ge(hr,this),e.settings);return ge(Pn,this).set(e,new Map([[ge(hr,this),t]])),t}getBorderInstances(e){var t,o;return Array.from((t=(o=ge(Pn,this).get(e))===null||o===void 0?void 0:o.values())!==null&&t!==void 0?t:[])}destroyBorders(e){ge(Pn,this).get(e).forEach(t=>t.destroy()),ge(Pn,this).delete(e)}render(e){if(ge(_r,this)===null)return;e&&tp(tE,this,ZV).call(this);let t=Array.from(ge(_r,this)),o=new Map,n=new Map;for(let i=0;i<t.length;i++){let a=t[i],{className:c,headerAttributes:u,createLayers:m,selectionType:g}=a.settings;ge(ep,this).has(a)||(ge(ep,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));let C=this.getBorderInstance(a);if(a.isEmpty()){C?.disappear();continue}c&&ge(Jm,this).setActiveSelection(a).scan().forEach(R=>{if(o.has(R)){let O=o.get(R);O.has(c)&&m===!0?O.set(c,O.get(c)+1):O.set(c,1)}else o.set(R,new Map([[c,1]]));u&&(n.has(R)||n.set(R,[]),R.nodeName==="TH"&&n.get(R).push(...u))});let v=a.getCorners();ge(hr,this).getSetting("onBeforeDrawBorders",v,g),C?.appear(v)}o.forEach((i,a)=>{var c;let u=Array.from(i).map(m=>{let[g,C]=m;return C===1?g:[g,...Array.from({length:C-1},(v,y)=>`${g}-${y+1}`)]}).flat();u.forEach(m=>ge(El,this).get(ge(hr,this)).add(m)),se(a,u),a.nodeName==="TD"&&Array.isArray((c=ge(_r,this).options)===null||c===void 0?void 0:c.cellAttributes)&&Se(a,ge(_r,this).options.cellAttributes)}),Array.from(n.keys()).forEach(i=>{Se(i,[...n.get(i)])})}};function ZV(){let r=ge(El,this).get(ge(hr,this)),e=ge(hr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)r.add(e[t]);r.forEach(t=>{var o,n;let i=ge(hr,this).wtTable.TABLE.querySelectorAll(`.${t}`),a=[];Array.isArray((o=ge(_r,this).options)===null||o===void 0?void 0:o.cellAttributes)&&(a=ge(_r,this).options.cellAttributes.map(c=>c[0])),Array.isArray((n=ge(_r,this).options)===null||n===void 0?void 0:n.headerAttributes)&&(a=[...a,...ge(_r,this).options.headerAttributes.map(c=>c[0])]);for(let c=0,u=i.length;c<u;c++)Fe(i[c],t),ko(i[c],a)}),r.clear()}var _l=class extends Xr{constructor(e,t,o,n){super(e,t,So,o,n)}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new $x(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),i=0;this.trimmingContainer===t&&(!n||n!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),xs(o,`${i}px`,"0px")):(i=this.getScrollPosition(),Ui(o));let a=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),a}setScrollPosition(e){let{rootWindow:t}=this.domBindings,o=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,sm(t)),o=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){let o=this.wtSettings.getSetting("defaultColumnWidth"),n=e,i=0;for(;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:t,rootWindow:o}=this.domBindings,n=Xe(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||c==="vertical"){let m=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(m-=n),m=Math.min(m,e.wtRootElement.scrollHeight),a.height=`${m}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;let u=Ke(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Ws.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let{wtSettings:o}=this,n=o.getSetting("rowHeaders"),i=o.getSetting("fixedColumnsStart"),c=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=i===0&&n.length>0&&!He(c.parentNode,"innerBorderInlineStart")?1:0,m=this.getTableParentOffset(),g=0;if(t){let C=this.wot.wtTable.getColumnWidth(e),v=this.wot.wtViewport.getViewportWidth();C>v&&(t=!1)}return t&&c.offsetWidth!==c.clientWidth&&(g=Xe(this.domBindings.rootDocument)),t?(m+=this.sumCellSizes(0,e+1),m-=this.wot.wtViewport.getViewportWidth(),m+=u):m+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),m+=g,XR(this.mainTableScrollableElement)===m-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(m)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(uu(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?o=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let n=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),a=n-i;o>a&&(o=0)}return o}adjustHeaderBordersPosition(e){let{wtSettings:t}=this,o=this.wot.wtTable.holder.parentNode,n=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),a=t.getSetting("totalRows"),c=t.getSetting("preventOverflow")==="vertical";a?Fe(o,"emptyRows"):se(o,"emptyRows");let u=!1;if(!c){if(i&&!n.length)se(o,"innerBorderLeft innerBorderInlineStart");else if(!i&&n.length){let m=He(o,"innerBorderInlineStart");e?(se(o,"innerBorderLeft innerBorderInlineStart"),u=!m):(Fe(o,"innerBorderLeft innerBorderInlineStart"),u=m)}}return u}};var a4=S(V(),1);var JV="stickyRowsTop",oE={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lr(oE,"MIXIN_NAME",JV,{writable:!1,enumerable:!1});var fd=oE;var Ol=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,Bo)}};Te(Ol,fd);Te(Ol,Ls);var iE=Ol;function nE(r,e,t){return(e=eW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function eW(r){var e=tW(r,"string");return typeof e=="symbol"?e:e+""}function tW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Ml=class extends Xr{constructor(e,t,o,n,i,a){super(e,t,Bo,o,n),nE(this,"topOverlay",void 0),nE(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new iE(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let n=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();xs(e,`${n}px`,`${i}px`)}else Ui(e);let t=Rt(this.clone.wtTable.TABLE),o=Ke(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${o}px`,!1}};var C4=S(V(),1);var Il=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,yo)}};Te(Il,fd);Te(Il,Fs);var sE=Il;function rW(r,e,t){return(e=oW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function oW(r){var e=iW(r,"string");return typeof e=="symbol"?e:e+""}function iW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Hl=class extends Xr{constructor(e,t,o,n){super(e,t,yo,o,n),rW(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new sE(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow"),n=0,i=!1;if(this.trimmingContainer===t&&(!o||o!=="vertical")){let{wtTable:c}=this.wot,u=c.hider.getBoundingClientRect(),m=Math.ceil(u.bottom),g=e.offsetHeight;i=m===g,n=this.getOverlayOffset(),xs(e,"0px",`${n}px`)}else n=this.getScrollPosition(),Ui(e);let a=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),a}setScrollPosition(e){let t=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(za(t),e),o=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let o=this.wtSettings.getSetting("defaultRowHeight"),n=e,i=0;for(;n<t;){let a=this.wot.wtTable.getRowHeight(n);i+=a===void 0?o:a,n+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:t,rootWindow:o}=this.domBindings,n=Xe(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||c==="horizontal"){let m=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(m-=n),m=Math.min(m,e.wtRootElement.scrollWidth),a.width=`${m}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Ws.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let{wot:o,wtSettings:n}=this,a=(o.cloneSource?o.cloneSource:o).wtTable.holder,c=n.getSetting("columnHeaders"),m=n.getSetting("fixedRowsTop")===0&&c.length>0&&!He(a.parentNode,"innerBorderTop")?1:0,g=this.getTableParentOffset(),C=0;if(t){let v=this.wot.wtTable.getRowHeight(e),y=this.wot.wtViewport.getViewportHeight();v>y&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(C=Xe(this.domBindings.rootDocument)),t){let v=n.getSetting("fixedRowsBottom"),y=n.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=o.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),g+=1,g+=m}else g+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return g+=C,KR(this.mainTableScrollableElement)===g-m&&m>0&&this.wot.wtOverlays.expandHiderVerticallyBy(m),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rs(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){let n=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),a=n-i;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>a&&(o=0)}return o}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,{wtSettings:o}=this,n=this.wot.wtTable.holder.parentNode,i=o.getSetting("totalColumns"),a=o.getSetting("preventOverflow")==="horizontal";i?Fe(n,"emptyColumns"):se(n,"emptyColumns");let c=!1;if(!t&&!a){let u=o.getSetting("fixedRowsTop"),m=this.cachedFixedRowsTop!==u,g=o.getSetting("columnHeaders");if((m||u===0)&&g.length>0){let C=He(n,"innerBorderTop");this.cachedFixedRowsTop=o.getSetting("fixedRowsTop"),e||o.getSetting("totalRows")===0?(se(n,"innerBorderTop"),c=!C):(Fe(n,"innerBorderTop"),c=C)}}return c}};function md(r,e,t){nW(r,e),e.set(r,t)}function nW(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fi(r,e,t){return(e=sW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function sW(r){var e=aW(r,"string");return typeof e=="symbol"?e:e+""}function aW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Dn(r,e,t){return r.set(aE(r,e),t),t}function mi(r,e){return r.get(aE(r,e))}function aE(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Us=new WeakMap,pd=new WeakMap,js=new WeakMap,gd=new WeakMap,rp=class{constructor(e,t,o,n,i,a){fi(this,"wot",null),md(this,Us,[]),fi(this,"topOverlay",null),fi(this,"bottomOverlay",null),fi(this,"inlineStartOverlay",null),fi(this,"topInlineStartCornerOverlay",null),fi(this,"bottomInlineStartCornerOverlay",null),fi(this,"browserLineHeight",void 0),fi(this,"wtSettings",null),md(this,pd,!1),md(this,js,0),md(this,gd,null),fi(this,"resizeObserver",new ResizeObserver(g=>{ST(()=>{!Array.isArray(g)||!g.length||(Dn(js,this,mi(js,this)+1),mi(js,this)===100&&(Dr("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),mi(gd,this)!==null&&clearTimeout(mi(gd,this)),Dn(gd,this,setTimeout(()=>{Dn(js,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=n,this.domBindings=o,this.facadeGetter=t,this.wtTable=a;let{rootDocument:c,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Xe(c);let m=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=m?a.holder:Ts(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=[...mi(Us,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){let{rootWindow:e,rootDocument:t}=this.domBindings,o=e.getComputedStyle(t.body),n=parseInt(o.lineHeight,10),i=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=n||i}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Hl(...e),this.bottomOverlay=new Rl(...e),this.inlineStartOverlay=new _l(...e),this.topInlineStartCornerOverlay=new Ml(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new yl(...e,this.bottomOverlay,this.inlineStartOverlay),Dn(Us,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Dn(pd,this,mi(Us,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),mi(Us,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),mi(Us,this).forEach(e=>{let t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",C=>this.onKeyDown(C)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(o,"scroll",C=>this.onTableScroll(C),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",C=>this.onTableScroll(C),{passive:!0});let i=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,c=this.wtSettings.getSetting("preventWheel"),u={passive:a};(c||i||!xT())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",C=>this.onCloneWheel(C,c),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(C=>{if(C&&C.needFullRender){let{holder:v}=C.clone.wtTable;this.eventManager.addEventListener(v,"wheel",y=>this.onCloneWheel(y,c),u)}});let g;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(g),g=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Dn(js,this,0)},200)}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){let t=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(n!==t&&i!==t&&!e.target.contains(n)||o!==t&&i!==t&&!e.target.contains(o))||this.syncScrollPositions(e)}onCloneWheel(e,t){let{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=e.target,c=i!==o&&a!==o&&!a.contains(i),u=n!==o&&a!==o&&!a.contains(n);if(this.keyPressed&&(c||u)||this.scrollableElement===o)return;let m=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==o&&m)&&e.preventDefault()}onKeyDown(e){this.keyPressed=AT(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,o=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(o+=o*this.browserLineHeight,t+=t*this.browserLineHeight);let n=this.scrollVertically(t),i=this.scrollHorizontally(o);return n||i}scrollVertically(e){let t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){let t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==n||this.lastScrollX!==e.scrollX,this.verticalScrolling=o.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=n;let a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!mi(pd,this))return;let e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:o}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o),Dn(pd,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Ts(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,t=e.clientWidth,o=e.clientHeight,n=t!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=o),n}adjustElementsSize(){let{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:o}=this.domBindings,n=this.scrollableElement===o,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),c=e.getRowHeaderWidth(),m=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,g=c+this.inlineStartOverlay.sumCellSizes(0,i),v=t.hider.style,y=()=>n?!1:this.scrollableElement.scrollTop>Math.max(0,m-t.holder.clientHeight),R=()=>n?!1:this.scrollableElement.scrollLeft>Math.max(0,g-t.holder.clientWidth),O=y()?1:0,N=R()?1:0;if(v.width=`${g+N}px`,v.height=`${m+O}px`,this.scrollbarSize>0){let{scrollHeight:I,scrollWidth:j}=t.wtRootElement,{scrollHeight:ie,scrollWidth:ue}=t.holder;this.hasScrollbarRight=I<ie,this.hasScrollbarBottom=j<ue,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>j?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>I&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){let{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){let{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return re(t,n=>{n&&n.clone&&n.clone.wtTable.TABLE.contains(e)&&(o=n.clone)}),o}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];re(t,o=>{o&&(o.clone.wtTable.TABLE.className=e.className)})}},lE=rp;var j4=S(V(),1);function cE(r,e,t){return(e=lW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function lW(r){var e=cW(r,"string");return typeof e=="symbol"?e:e+""}function cW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var wd=class{constructor(e){cE(this,"settings",{}),cE(this,"defaults",Object.freeze(this.getDefaults())),be(this.defaults,(t,o)=>{if(e[o]!==void 0)this.settings[o]=e[o];else{if(t===void 0)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,o)=>{let n=this.getSetting("data",e,t);li(o,n??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?be(e,(o,n)=>{this.settings[n]=o}):this.settings[e]=t,this}getSetting(e,t,o,n,i){return typeof this.settings[e]=="function"?this.settings[e](t,o,n,i):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};var Al=class extends Kr{constructor(e,t,o,n){super(e,t,o,n,"master")}alignOverlaysWithTrimmingContainer(){let e=Sn(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let o=e.parentElement,n=Ya(e,"height",t),i=Ya(e,"overflow",t),a=this.holder.style,{scrollWidth:c,scrollHeight:u}=e,m=e.offsetWidth,g=e.offsetHeight;if(o&&["auto","hidden","scroll"].includes(i)){let v=e.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",e.nextElementSibling?o.insertBefore(v,e.nextElementSibling):o.appendChild(v);let y=parseInt(Ur(v,t).height,10);o.removeChild(v),y===0&&(g=0)}g=Math.min(g,u),a.height=n==="auto"?"auto":`${g}px`,m=Math.min(m,c),a.width=`${m}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:g>0,this.hasTableWidth=m>0}this.isTableVisible=Wi(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,o="master",i=e.getSetting("columnHeaders").length;if(i&&!t.hasOversizedColumnHeadersMarked[o]){let c=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let m=0;m<i;m++)for(let g=-1*c;g<u;g++)this.markIfOversizedColumnHeader(g);t.hasOversizedColumnHeadersMarked[o]=!0}}};Te(Al,rd);Te(Al,Fs);var uE=Al;var op=class{constructor(e,t,o,n,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=o,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new ul:new hl],["fullyVisible",()=>new il],["partiallyVisible",()=>new _n]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new ll:new dl],["fullyVisible",()=>new rl],["partiallyVisible",()=>new En]]),this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,o=0;return t===this.domBindings.rootWindow?o=e.documentElement.clientHeight:o=Rt(t)>0&&t.clientHeight>0?t.clientHeight:1/0,o}getWorkspaceWidth(){let{wtSettings:e}=this,{rootDocument:t,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,a=e.getSetting("totalColumns"),c=e.getSetting("preventOverflow"),u=e.getSetting("rtlMode"),m=this.wtTable.TABLE.getBoundingClientRect(),g=u?m.right-i:m.left,C=i-g,v,y;if(c)return Ke(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?v=Math.min(C,i):v=Math.min(this.getContainerFillWidth(),C,i),n===o&&a>0&&this.sumColumnWidths(0,a-1)>v)return t.documentElement.clientWidth;if(n!==o&&(y=Ya(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,n.clientWidth);let R=e.getSetting("stretchH");return R==="none"||!R?Math.max(v,Ke(this.wtTable.TABLE)):v}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let o=0,n=e;for(;n<t;)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);let o=t.offsetWidth;return this.containerWidth=o,e.removeChild(t),o}getWorkspaceOffset(){return Yt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Rt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let o=0,n=t.length;o<n;o++)this.rowHeaderWidth+=e[o]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,i=t.length;n<i;n++)o?(this.rowHeaderWidth+=Ke(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:t,wtTable:o}=this,n=this.getViewportHeight(),i,a;this.rowHeaderWidth=NaN;let c=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=t.getSetting("fixedRowsTop"),m=t.getSetting("fixedRowsBottom"),g=t.getSetting("totalRows");return u&&c>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),c+=a,n-=a),m&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(g-m,g),n-=a),o.holder.clientHeight===o.holder.offsetHeight?i=0:i=Xe(this.domBindings.rootDocument),new As({calculationTypes:e.map(C=>[C,this.rowsCalculatorTypes.get(C)()]),viewportHeight:n,scrollOffset:c,totalRows:t.getSetting("totalRows"),rowHeightFn:C=>o.getRowHeight(C),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:t,wtTable:o}=this,n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let a=t.getSetting("fixedColumnsStart");if(a&&i>=0){let c=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=c,n-=c}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=Xe(this.domBindings.rootDocument)),new Hs({calculationTypes:e.map(c=>[c,this.columnsCalculatorTypes.get(c)()]),viewportWidth:n,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:c=>o.getColumnWidth(c),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:t}=this,o=this.createRowsCalculator(),n=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){let i=o.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(i)}if(e&&!t.getSetting("renderAllColumns")){let i=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(i)}return e||(this.rowsRenderCalculator=o.getResultsFor("rendered"),this.columnsRenderCalculator=n.getResultsFor("rendered")),this.rowsVisibleCalculator=o.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){let e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:o}=e;if(t===null&&o===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,o=this.rowsPartiallyVisibleCalculator.endRow}let{startRow:n,endRow:i}=this.rowsRenderCalculator;return t<n||t===n&&t>0?!1:!(o>i||o===i&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:o}=e;if(t===null&&o===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,o=this.columnsPartiallyVisibleCalculator.endColumn}let{startColumn:n,endColumn:i}=this.columnsRenderCalculator;return t<n||t===n&&t>0?!1:!(o>i||o===i&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){be(this.hasOversizedColumnHeadersMarked,(e,t,o)=>{o[t]=void 0})}},dE=op;var bd=class extends Ki{constructor(e,t){super(e,new wd(t));let o=this.wtSettings.getSetting("facade",this);this.wtTable=new uE(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new dE(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new hd(this.wtSettings.getSetting("selections")),this.wtEvent=new Nu(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new lE(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],o=[];be(e,(n,i)=>{this.wtSettings.getSetting(i).length&&o.push(n),t.push(n)}),Fe(this.wtTable.wtRootElement.parentNode,t),se(this.wtTable.wtRootElement.parentNode,o)}getOverlayByName(e){var t;if(!Ju.includes(e))return null;let o=e.replace(/_([a-z])/g,n=>n[1].toUpperCase());return(t=this.wtOverlays[`${o}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}};var Nl=class r{constructor(e){e instanceof Ki?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{let o=new r(t);return()=>o},this._wot=new bd(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,o){return this._wot.createCellRange(e,t,o)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,o,n,i){return this._wot.scrollViewport(e,t,o,n,i)}scrollViewportHorizontally(e,t,o){return this._wot.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return this._wot.scrollViewportVertically(e,t,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,o,n,i){return this._wot.wtSettings.getSetting(e,t,o,n,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}};function hE(r){let{isShiftKey:e,isLeftClick:t,isRightClick:o,coords:n,selection:i,controller:a,cellCoordsFactory:c}=r,u=i.isSelected()?i.getSelectedRange().current():null,m=i.isSelectedByCorner(),g=i.isSelectedByRowHeader();if(i.markSource("mouse"),e&&u)n.row>=0&&n.col>=0&&!a.cell?i.setRangeEnd(n):(m||g)&&n.row>=0&&n.col>=0&&!a.cell?i.setRangeEnd(c(n.row,n.col)):m&&n.row<0&&!a.column?i.setRangeEnd(c(u.to.row,n.col)):g&&n.col<0&&!a.row?i.setRangeEnd(c(n.row,u.to.col)):(!m&&!g&&n.col<0||m&&n.col<0)&&!a.row?i.selectRows(Math.max(u.from.row,0),n.row,n.col):(!m&&!g&&n.row<0||g&&n.row<0)&&!a.column&&i.selectColumns(Math.max(u.from.col,0),n.col,n.row);else{let C=!i.inInSelection(n),v=t||o&&C;n.row<0&&n.col>=0&&!a.column?v&&i.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!a.row?v&&i.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!a.cell?v&&i.setRangeStart(n):n.col<0&&n.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}i.markEndSource()}function uW(r){let{isLeftClick:e,coords:t,selection:o,controller:n,cellCoordsFactory:i}=r;if(!e)return;let a=o.isSelectedByRowHeader(),c=o.isSelectedByColumnHeader(),u=o.tableProps.countCols(),m=o.tableProps.countRows();o.markSource("mouse"),c&&!n.column?o.setRangeEnd(i(m-1,t.col)):a&&!n.row?o.setRangeEnd(i(t.row,u-1)):n.cell||o.setRangeEnd(t),o.markEndSource()}var dW=new Map([["mousedown",hE],["mouseover",uW],["touchstart",hE]]);function ip(r,e){let{coords:t,selection:o,controller:n,cellCoordsFactory:i}=e;dW.get(r.type)({coords:t,selection:o,controller:n,cellCoordsFactory:i,isShiftKey:r.shiftKey,isLeftClick:yu(r)||r.type==="touchstart",isRightClick:Ka(r)})}var fE=new WeakMap,Cd=Symbol("rootInstance");function mE(r){fE.set(r,!0)}function pE(r){return r===Cd}function zs(r){return fE.has(r)}function hW(r,e){gE(r,e),e.add(r)}function Ln(r,e,t){gE(r,e),e.set(r,t)}function gE(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(r,e,t){return(e=fW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function fW(r){var e=mW(r,"string");return typeof e=="symbol"?e:e+""}function mW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Vt(r,e){return r.get(kl(r,e))}function Qr(r,e,t){return r.set(kl(r,e),t),t}function kl(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var np=new WeakMap,vd=new WeakMap,yd=new WeakMap,pi=new WeakMap,xo=new WeakMap,sp=new WeakMap,ap=new WeakMap,Sd=new WeakSet,lp=class{constructor(e){hW(this,Sd),Qi(this,"hot",void 0),Qi(this,"eventManager",void 0),Qi(this,"settings",void 0),Qi(this,"THEAD",void 0),Qi(this,"TBODY",void 0),Qi(this,"_wt",void 0),Qi(this,"activeWt",void 0),Ln(this,np,0),Ln(this,vd,0),Qi(this,"postponedAdjustElementsSize",!1),Ln(this,yd,!1),Ln(this,pi,void 0),Ln(this,xo,void 0),Ln(this,sp,0),Ln(this,ap,0),this.hot=e,this.eventManager=new wo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){let o=this._wt.getCell(e,t);return o<0?null:o}scrollViewport(e,t,o,n,i){return this._wt.scrollViewport(e,t,o,n,i)}scrollViewportHorizontally(e,t,o){return this._wt.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return this._wt.scrollViewportVertically(e,t,o)}createElements(){let{rootElement:e,rootDocument:t}=this.hot,o=e.getAttribute("style");o&&e.setAttribute("data-originalstyle",o),se(e,"handsontable"),Qr(xo,this,t.createElement("TABLE")),se(Vt(xo,this),"htCore"),this.hot.getSettings().tableClassName&&se(Vt(xo,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Se(Vt(xo,this),[Pr()]),Se(e,[DR(),au(-1),vs(this.hot.countCols()),UR()])),this.THEAD=t.createElement("THEAD"),Vt(xo,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),Vt(xo,this).appendChild(this.TBODY),this.hot.table=Vt(xo,this),this.hot.container.insertBefore(Vt(xo,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:e,rootDocument:t,selection:o,rootWindow:n}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",c=>{Qr(yd,this,!0),this.isTextSelectionAllowed(c.target)||(am(n),c.preventDefault(),n.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Qr(yd,this,!1)}),this.eventManager.addEventListener(e,"mousemove",c=>{Vt(yd,this)&&!this.isTextSelectionAllowed(c.target)&&(this.settings.fragmentSelection&&am(n),c.preventDefault())}),this.eventManager.addEventListener(i,"keyup",c=>{o.isInProgress()&&!c.shiftKey&&o.finish()}),this.eventManager.addEventListener(i,"mouseup",c=>{o.isInProgress()&&yu(c)&&o.finish(),Qr(pi,this,!1);let u=fu(t.activeElement);qa(t.activeElement)&&!u||(u||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!e.contains(c.target)&&!Ka(c))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",c=>{o.isInProgress()&&Ka(c)&&(o.finish(),Qr(pi,this,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{o.isInProgress()&&o.finish(),Qr(pi,this,!1)}),this.eventManager.addEventListener(i,"mousedown",c=>{let u=c.target,m=c.x||c.clientX,g=c.y||c.clientY,C=c.target;if(Vt(pi,this)||!e||!this.hot.view)return;let{holder:v}=this._wt.wtTable;if(C===v){let R=Xe(t);if(t.elementFromPoint(m+R,g)!==v||t.elementFromPoint(m,g+R)!==v)return}else for(;C!==i;){if(C===null){if(c.isTargetWebComponent)break;return}if(C===e)return;C=C.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Ss(n);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Ss(a);this.eventManager.addEventListener(Vt(xo,this),"selectstart",c=>{this.settings.fragmentSelection||qa(c.target)||c.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:o}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,o))}translateFromRenderableToVisualIndex(e,t){let o=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return o===null&&(o=e),n===null&&(n=t),[o,n]}countRenderableIndexes(e,t){let o=Math.min(e.getNotTrimmedIndexesLength(),t),n=e.getNearestNotHiddenIndex(o-1,-1);return n===null?0:e.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,o,n){if(isNaN(e)||e<0)return 0;let i=o.getNearestNotHiddenIndex(e,t),a=o.getRenderableFromVisualIndex(i);if(!Number.isInteger(a))return 0;let c=0;return t<0?c=a+1:t>0&&(c=n-a),c}countNotHiddenFixedColumnsStart(){let e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){let e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){let e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let o=0;for(let n=e;n<=t;n++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)!==null&&(o+=1);return o}countRenderableRowsInRange(e,t){let o=0;for(let n=e;n<=t;n++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)!==null&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){let e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Vt(xo,this),isDataViewInstance:()=>zs(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(i,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(i,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let i=[];return this.hot.hasRowHeaders()&&i.push((a,c)=>{let u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,c)}),this.hot.runHooks("afterGetRowHeaderRenderers",i),Qr(vd,this,i.length),this.hot.getSettings().ariaTags&&kl(Sd,this,wE).call(this)===this.hot.countCols()&&kl(Sd,this,pW).call(this,Vt(vd,this)),i},columnHeaders:()=>{let i=[];return this.hot.hasColHeaders()&&i.push((a,c)=>{let u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,c)}),this.hot.runHooks("afterGetColumnHeaderRenderers",i),Qr(np,this,i.length),i},columnWidth:i=>{let a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getColWidth(a===null?i:a)},rowHeight:i=>{let a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getRowHeight(a===null?i:a)},rowHeightByOverlayName:(i,a)=>{let c=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),u=c===null?i:c;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(i,a,c)=>{let[u,m]=this.translateFromRenderableToVisualIndex(i,a),g=this.hot.runHooks("modifyGetCellCoords",u,m),C=u,v=m;Array.isArray(g)&&([C,v]=g);let y=this.hot.getCellMeta(C,v),R=this.hot.colToProp(v),O=this.hot.getDataAtRowProp(C,R);this.hot.hasHook("beforeValueRender")&&(O=this.hot.runHooks("beforeValueRender",O,y)),this.hot.runHooks("beforeRenderer",c,u,m,R,O,y),this.hot.getCellRenderer(y)(this.hot,c,u,m,R,O,y),this.hot.runHooks("afterRenderer",c,u,m,R,O,y)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Wi(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(i,a,c,u)=>{let m=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,Qr(pi,this,!0),this.hot.runHooks("beforeOnCellMouseDown",i,m,c,g),!Lo(i)&&(ip(i,{coords:m,selection:this.hot.selection,controller:g,cellCoordsFactory:(C,v)=>this.hot._createCellCoords(C,v)}),this.hot.runHooks("afterOnCellMouseDown",i,m,c),this.activeWt=this._wt)},onCellContextMenu:(i,a,c,u)=>{let m=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,Qr(pi,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",i,m,c),!Lo(i)&&(this.hot.runHooks("afterOnCellContextMenu",i,m,c),this.activeWt=this._wt)},onCellMouseOut:(i,a,c,u)=>{let m=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",i,m,c),!Lo(i)&&(this.hot.runHooks("afterOnCellMouseOut",i,m,c),this.activeWt=this._wt)},onCellMouseOver:(i,a,c,u)=>{let m=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",i,m,c,g),!Lo(i)&&(Vt(pi,this)&&ip(i,{coords:m,selection:this.hot.selection,controller:g,cellCoordsFactory:(C,v)=>this.hot._createCellCoords(C,v)}),this.hot.runHooks("afterOnCellMouseOver",i,m,c),this.activeWt=this._wt)},onCellMouseUp:(i,a,c,u)=>{let m=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",i,m,c),!(Lo(i)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",i,m,c),this.activeWt=this._wt)},onCellCornerMouseDown:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",i)},onCellCornerDblClick:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",i)},beforeDraw:(i,a)=>this.beforeRender(i,a),onDraw:i=>this.afterRender(i),onBeforeViewportScrollVertically:i=>{let a=this.hot.rowIndexMapper,c=i<0,u=i;return!c&&(u=a.getVisualFromRenderableIndex(i),u===null)?i:(u=this.hot.runHooks("beforeViewportScrollVertically",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:i=>{let a=this.hot.columnIndexMapper,c=i<0,u=i;return!c&&(u=a.getVisualFromRenderableIndex(i),u===null)?i:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(i,a,c)=>{let u=this.hot.rowIndexMapper,m=i<0,g=i;m||(g=u.getVisualFromRenderableIndex(i));let C=this.hot.runHooks("beforeHighlightingRowHeader",g,a,c);return m?C:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1))},onBeforeHighlightingColumnHeader:(i,a,c)=>{let u=this.hot.columnIndexMapper,m=i<0,g=i;m||(g=u.getVisualFromRenderableIndex(i));let C=this.hot.runHooks("beforeHighlightingColumnHeader",g,a,c);return m?C:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1))},onAfterDrawSelection:(i,a,c)=>{let u,[m,g]=this.translateFromRenderableToVisualIndex(i,a),C=this.hot.selection.getSelectedRange();if(C.size()>0){let y=C.peekByIndex(c??0);u=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.hot.runHooks("afterDrawSelection",m,g,u,c)},onBeforeDrawBorders:(i,a)=>{let[c,u,m,g]=i,C=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(m),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",C,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(i,a)=>{let c=this.hot.columnIndexMapper.getVisualFromRenderableIndex(a);return this.hot.runHooks("beforeStretchingColumnWidth",i,c)},onModifyRowHeaderWidth:i=>this.hot.runHooks("modifyRowHeaderWidth",i),onModifyGetCellCoords:(i,a,c)=>{let u=this.hot.rowIndexMapper,m=this.hot.columnIndexMapper,g=a>=0?m.getVisualFromRenderableIndex(a):a,C=i>=0?u.getVisualFromRenderableIndex(i):i,v=this.hot.runHooks("modifyGetCellCoords",C,g,c);if(Array.isArray(v)){let[y,R,O,N]=v;return[y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,1)):y,R>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(R,1)):R,O>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(O,-1)):O,N>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(N,-1)):N]}},viewportRowCalculatorOverride:i=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){let c=this.countRenderableRows(),u=i.startRow,m=i.endRow;if(typeof a=="number")i.startRow=Math.max(u-a,0),i.endRow=Math.min(m+a,c-1);else if(a==="auto"){let g=Math.ceil(m/c*12);i.startRow=Math.max(u-g,0),i.endRow=Math.min(m+g,c-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:i=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){let c=this.countRenderableColumns(),u=i.startColumn,m=i.endColumn;if(typeof a=="number"&&(i.startColumn=Math.max(u-a,0),i.endColumn=Math.min(m+a,c-1)),a==="auto"){let g=Math.ceil(m/c*6);i.startColumn=Math.max(u-g,0),i.endColumn=Math.min(m+g,c-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let i=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||i}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Nl(e),this.activeWt=this._wt;let t=this._wt.wtTable.spreader,{width:o,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,n),this.eventManager.addEventListener(t,"mousedown",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(qa(e))return!0;let t=ja(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Vt(pi,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){let e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){let o=t.firstChild;if(!He(o,"relative")){Po(t),this.appendRowHeader(e,t);return}this.updateCellHeader(o.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{let{rootDocument:o,getRowHeader:n}=this.hot,i=o.createElement("div"),a=o.createElement("span");i.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,n),i.appendChild(a),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=()=>{let a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(t.firstChild){let a=t.firstChild;He(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,o,n),a.className="",se(a,["relative",...i()])):(Po(t),this.appendColHeader(e,t,o,n))}else{let{rootDocument:a}=this.hot,c=a.createElement("div"),u=a.createElement("span"),m=i();c.classList.add("relative",...m),u.className="colHeader",this.settings.ariaTags&&(Se(c,...Pr()),Se(u,...Pr())),this.updateCellHeader(u,e,o,n),c.appendChild(u),t.appendChild(c)}this.hot.runHooks("afterGetColHeader",e,t,n)}updateCellHeader(e,t,o){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=t,a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(He(e,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(t):He(e,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(t))),i>-1?$R(e,o(t,n)):(li(e,"\xA0"),se(e,"cornerHeader"))}maximumVisibleElementWidth(e){let o=this._wt.wtViewport.getWorkspaceWidth()-e;return o>0?o:0}maximumVisibleElementHeight(e){let o=this._wt.wtViewport.getWorkspaceHeight()-e;return o>0?o:0}setLastSize(e,t){Qr(sp,this,e),Qr(ap,this,t)}getLastSize(){return{width:Vt(sp,this),height:Vt(ap,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Vt(np,this)}getRowHeadersCount(){return Vt(vd,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function wE(){return parseInt(this.hot.rootElement.getAttribute(vs()[0]),10)}function pW(r){let e=kl(Sd,this,wE).call(this)+r;Se(this.hot.rootElement,...vs(e))}var bE=lp;var W6=S(V(),1),B6=S(me(),1);var L6=S(me(),1);var gW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",CE=gW.length;function vE(r){let e=r+1,t="",o;for(;e>0;)o=(e-1)%CE,t=String.fromCharCode(65+o)+t,e=parseInt((e-o)/CE,10);return t}function Rd(r){let e=0;return Array.isArray(r)&&(r[0]&&Array.isArray(r[0])?e=r[0].length:r[0]&&qt(r[0])&&(e=Es(r[0]))),e}function Pl(r,e,t){return(e=wW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function wW(r){var e=bW(r,"string");return typeof e=="symbol"?e:e+""}function bW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var cp=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Pl(this,"hot",void 0),Pl(this,"data",void 0),Pl(this,"dataType","array"),Pl(this,"colToProp",()=>{}),Pl(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){let t=[];return re(this.data,(o,n)=>{let i=this.getAtCell(n,e);t.push(i)}),t}getAtRow(e,t,o){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=t===void 0&&o===void 0,{dataDotNotation:a}=this.hot.getSettings(),c=null,u=null;if(c=this.modifyRowData(e),Array.isArray(c))u=[],i?c.forEach((m,g)=>{u[g]=this.getAtPhysicalCell(e,g,c)}):$t(t,o,m=>{u[m-t]=this.getAtPhysicalCell(e,m,c)});else if(qt(c)||Re(c))if(n?u=[]:u={},!i||n){let g=this.countFirstRowKeys()-1;$t(0,g,C=>{let v=this.colToProp(C);if(C>=(t||0)&&C<=(o||g)&&!Number.isInteger(v)){let y=this.getAtPhysicalCell(e,v,c);n?u.push(y):a?gu(u,v,y):u[v]=y}})}else be(c,(m,g)=>{let C=this.getAtPhysicalCell(e,g,c);a?gu(u,g,C):u[g]=C});return u}setAtCell(e,t,o){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=cr(o);this.hot.runHooks("modifySourceData",e,t,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(t)?this.data[e][t]=o:gu(this.data[e],t,o)}}getAtPhysicalCell(e,t,o){let n=null;if(o)if(typeof t=="string"){let{dataDotNotation:i}=this.hot.getSettings();n=i?yT(o,t):o[t]}else typeof t=="function"?n=t(o):n=o[t];if(this.hot.hasHook("modifySourceData")){let i=cr(n);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(n=i.value)}return n}getAtCell(e,t){let o=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),o)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=!1,i=null,a=null,c=null,u=null;e===null||t===null?(n=!0,i=0,c=this.countRows()-1):(i=Math.min(e.row,t.row),a=Math.min(e.col,t.col),c=Math.max(e.row,t.row),u=Math.max(e.col,t.col));let m=[];return $t(i,c,g=>{m.push(n?this.getAtRow(g,void 0,void 0,o):this.getAtRow(g,a,u,o))}),m}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Rd(this.data)}destroy(){this.data=null,this.hot=null}},yE=cp;var g9=S(V(),1),w9=S(tr(),1),b9=S(rr(),1),C9=S(or(),1),v9=S(ir(),1),y9=S(nr(),1),S9=S(sr(),1),R9=S(ar(),1);var N8=S(V(),1);var a8=S(me(),1);var $6=S(V(),1),K6=S(me(),1);function SE(r,e,t){return(e=CW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function CW(r){var e=vW(r,"string");return typeof e=="symbol"?e:e+""}function vW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Eo=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;SE(this,"indexedValues",[]),SE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Re(this.initValueOrFn)?$t(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):$t(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};Te(Eo,dr);function Td(r,e,t,o){let n=t.length?t[0]:void 0;return[...r.slice(0,n),...t.map((i,a)=>Re(o)?o(i,a):o),...n===void 0?[]:r.slice(n)]}function xd(r,e){return bs(r,(t,o)=>e.includes(o)===!1)}var Zi=class extends Eo{insert(e,t){this.indexedValues=Td(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=xd(this.indexedValues,e),super.remove(e)}};var Ys=class extends Zi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Fi(this.getValues(),(e,t,o)=>(t&&e.push(o),e),[])}};var p8=S(V(),1);function Ed(r,e,t){return[...r.slice(0,e),...t,...r.slice(e)]}function Fn(r,e){return bs(r,t=>e.includes(t)===!1)}function Dl(r,e){return po(r,t=>t-e.filter(o=>o<t).length)}function Ll(r,e){let t=e[0],o=e.length;return po(r,n=>n>=t?n+o:n)}function yW(r,e,t){return(e=SW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function SW(r){var e=RW(r,"string");return typeof e=="symbol"?e:e+""}function RW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var _d=class extends Eo{constructor(){super(...arguments),yW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(o,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Fn(this.orderOfIndexes,[e]),Re(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Td(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Ll(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=xd(this.indexedValues,e),this.orderOfIndexes=Fn(this.orderOfIndexes,e),this.orderOfIndexes=Dl(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}};var S8=S(me(),1);var qs=class extends Zi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Fi(this.getValues(),(e,t,o)=>(t&&e.push(o),e),[])}};var E8=S(V(),1);var Od=class extends Eo{constructor(){super(e=>e)}insert(e,t){let o=Ll(this.indexedValues,t);this.indexedValues=Ed(o,e,t),super.insert(e,t)}remove(e){let t=Fn(this.indexedValues,e);this.indexedValues=Dl(t,e),super.remove(e)}};var RE=new Map([["hiding",Ys],["index",Eo],["linkedPhysicalIndexToValue",_d],["physicalIndexToValue",Zi],["trimming",qs]]);function TE(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!RE.has(r))throw new Error(`The provided map type ("${r}") does not exist.`);return new(RE.get(r))(e)}var G8=S(V(),1),$8=S(me(),1);var U8=S(V(),1);function TW(r,e,t){return(e=xW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function xW(r){var e=EW(r,"string");return typeof e=="symbol"?e:e+""}function EW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var xE=0,Vn=class{constructor(){TW(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),xE+=1)}unregister(e){let t=this.collection.get(e);oe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),xE-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return pt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(o=>{o.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}};Te(Vn,dr);function up(r,e,t){return(e=_W(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _W(r){var e=OW(r,"string");return typeof e=="symbol"?e:e+""}function OW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Fl=class extends Vn{constructor(e,t){super(),up(this,"mergedValuesCache",[]),up(this,"aggregationFunction",void 0),up(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];let t=po(this.get(),i=>i.getValues()),o=[],n=oe(t[0])&&t[0].length||0;for(let i=0;i<n;i+=1){let a=[];for(let c=0;c<this.getLength();c+=1)a.push(t[c][i]);o.push(a)}return po(o,this.aggregationFunction)}getMergedValueAtIndex(e,t){let o=this.getMergedValues(t)[e];return oe(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};var n9=S(V(),1),s9=S(tr(),1),a9=S(rr(),1),l9=S(or(),1),c9=S(ir(),1),u9=S(nr(),1),d9=S(sr(),1),h9=S(ar(),1);var J8=S(V(),1);function MW(r,e,t){IW(r,e),e.set(r,t)}function IW(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HW(r,e,t){return r.set(EE(r,e),t),t}function AW(r,e){return r.get(EE(r,e))}function EE(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var dp=new WeakMap,Vl=class{constructor(){MW(this,dp,[])}subscribe(e){return this.addLocalHook("change",e),this._write(AW(dp,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){HW(dp,this,e)}};Te(Vl,dr);var o9=S(me(),1);function hp(r,e){let t=[],o=0,n=0;for(;o<r.length&&n<e.length;o++,n++)r[o]!==e[n]&&t.push({op:"replace",index:n,oldValue:r[o],newValue:e[n]});for(;o<e.length;o++)t.push({op:"insert",index:o,oldValue:void 0,newValue:e[o]});for(;n<r.length;n++)t.push({op:"remove",index:n,oldValue:r[n],newValue:void 0});return t}function Wl(r,e,t){NW(r,e),e.set(r,t)}function NW(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zr(r,e){return r.get(_E(r,e))}function Md(r,e,t){return r.set(_E(r,e),t),t}function _E(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Id=new WeakMap,Bl=new WeakMap,Hd=new WeakMap,Ad=new WeakMap,Nd=new WeakMap,kd=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wl(this,Id,new Set),Wl(this,Bl,[]),Wl(this,Hd,[]),Wl(this,Ad,!1),Wl(this,Nd,!1),Md(Nd,this,e??!1)}createObserver(){let e=new Vl;return Zr(Id,this).add(e),e.addLocalHook("unsubscribe",()=>{Zr(Id,this).delete(e)}),e._writeInitialChanges(hp(Zr(Bl,this),Zr(Hd,this))),e}emit(e){let t=Zr(Hd,this);(!Zr(Ad,this)||Zr(Bl,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(Zr(Nd,this)):Md(Bl,this,new Array(e.length).fill(Zr(Nd,this))),Zr(Ad,this)||(Md(Ad,this,!0),t=Zr(Bl,this)));let o=hp(t,e);Zr(Id,this).forEach(n=>n._write(o)),Md(Hd,this,e)}};function vr(r,e,t){return(e=kW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kW(r){var e=PW(r,"string");return typeof e=="symbol"?e:e+""}function PW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Wn=class{constructor(){vr(this,"indexesSequence",new Od),vr(this,"trimmingMapsCollection",new Fl(e=>e.some(t=>t===!0),!1)),vr(this,"hidingMapsCollection",new Fl(e=>e.some(t=>t===!0),!1)),vr(this,"variousMapsCollection",new Vn),vr(this,"hidingChangesObservable",new kd({initialIndexValue:!1})),vr(this,"notTrimmedIndexesCache",[]),vr(this,"notHiddenIndexesCache",[]),vr(this,"isBatched",!1),vr(this,"indexesSequenceChanged",!1),vr(this,"indexesChangeSource",void 0),vr(this,"trimmedIndexesChanged",!1),vr(this,"hiddenIndexesChanged",!1),vr(this,"renderablePhysicalIndexesCache",[]),vr(this,"fromPhysicalToVisualIndexesCache",new Map),vr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,o){return this.registerMap(e,TE(t,o))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof qs?this.trimmingMapsCollection.register(e,t):t instanceof Ys?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);let o=this.getNumberOfIndexes();return o>0&&t.init(o),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let t=this.notTrimmedIndexesCache[e];return oe(t)?t:null}getPhysicalFromRenderableIndex(e){let t=this.renderablePhysicalIndexesCache[e];return oe(t)?t:null}getVisualFromPhysicalIndex(e){let t=this.fromPhysicalToVisualIndexesCache.get(e);return oe(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let t=this.fromVisualToRenderableIndexesCache.get(e);return oe(t)?t:null}getNearestNotHiddenIndex(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let i=Array.from(this.fromVisualToRenderableIndexesCache.keys()),a=-1;return t>0?a=i.findIndex(c=>c>e):a=i.reverse().findIndex(c=>c<e),a===-1?o?this.getNearestNotHiddenIndex(e,-t,!1):null:i[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let t=this.getNumberOfIndexes();if(e<t){let o=[...Array(this.getNumberOfIndexes()-e).keys()].map(n=>n+e);this.removeIndexes(o)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(o=>this.isTrimmed(o)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(o=>this.isHidden(o)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(o=>this.isHidden(o)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);let o=po(e,m=>this.getPhysicalFromVisualIndex(m)),n=this.getNotTrimmedIndexesLength(),i=e.length,a=Fn(this.getIndexesSequence(),o),c=a.filter(m=>this.isTrimmed(m)===!1),u=a.indexOf(c[c.length-1])+1;if(t+i<n){let m=c[t];u=a.indexOf(m)}this.indexesChangeSource="move",this.setIndexesSequence(Ed(a,u,o)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){let o=this.getNotTrimmedIndexes()[e],n=oe(o)?o:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),a=po(new Array(t).fill(n),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,a),this.hidingMapsCollection.insertToEvery(i,a),this.variousMapsCollection.insertToEvery(i,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){let o=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(o,t)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){let o=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(n,t)}}};Te(Wn,dr);function OE(r,e){return be(e,(t,o)=>{pt(r[o])&&(r[o]=t)}),r}function Pd(r){let t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(r);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:r}function Dd(r){oe(r)&&GT(mt`Language with code "${r}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function fp(r,e){return Array.isArray(r)&&Number.isInteger(e)?r[e]:r}var{register:DW,getValues:LW}=Lr("phraseFormatters");function FW(r,e){DW(r,e)}function ME(){return LW()}FW("pluralize",fp);var Ld={};wI(Ld,{CHECKBOX_CHECKED:()=>Lg,CHECKBOX_RENDERER_NAMESPACE:()=>Dg,CHECKBOX_UNCHECKED:()=>Fg,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>kp,CONTEXTMENU_ITEMS_ALIGNMENT:()=>Fp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>Yp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>Wp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Up,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>Vp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>zp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>Bp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>jp,CONTEXTMENU_ITEMS_BORDERS:()=>qp,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>Kp,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>Xp,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>$p,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>Gp,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>Tp,CONTEXTMENU_ITEMS_COPY:()=>xp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>Op,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>_p,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>Ep,CONTEXTMENU_ITEMS_CUT:()=>Mp,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>Pp,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>Ip,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>eg,CONTEXTMENU_ITEMS_HIDE_ROW:()=>rg,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>wp,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>bp,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>Ap,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Jp,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>Zp,CONTEXTMENU_ITEMS_NO_ITEMS:()=>mp,CONTEXTMENU_ITEMS_READ_ONLY:()=>Rp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>Lp,CONTEXTMENU_ITEMS_REDO:()=>Sp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Qp,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>vp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>Dp,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>Cp,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>pp,CONTEXTMENU_ITEMS_ROW_BELOW:()=>gp,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>tg,CONTEXTMENU_ITEMS_SHOW_ROW:()=>og,CONTEXTMENU_ITEMS_UNDO:()=>yp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>Hp,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>Np,CONTEXT_MENU_ITEMS_NAMESPACE:()=>IE,FILTERS_BUTTONS_CANCEL:()=>Ag,FILTERS_BUTTONS_CLEAR:()=>Ig,FILTERS_BUTTONS_OK:()=>Hg,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>Ng,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>Pg,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>kg,FILTERS_BUTTONS_SELECT_ALL:()=>Mg,FILTERS_CONDITIONS_AFTER:()=>Cg,FILTERS_CONDITIONS_BEFORE:()=>vg,FILTERS_CONDITIONS_BEGINS_WITH:()=>cg,FILTERS_CONDITIONS_BETWEEN:()=>wg,FILTERS_CONDITIONS_BY_VALUE:()=>VW,FILTERS_CONDITIONS_CONTAINS:()=>dg,FILTERS_CONDITIONS_EMPTY:()=>ng,FILTERS_CONDITIONS_ENDS_WITH:()=>ug,FILTERS_CONDITIONS_EQUAL:()=>ag,FILTERS_CONDITIONS_GREATER_THAN:()=>fg,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>mg,FILTERS_CONDITIONS_LESS_THAN:()=>pg,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>gg,FILTERS_CONDITIONS_NAMESPACE:()=>ct,FILTERS_CONDITIONS_NONE:()=>ig,FILTERS_CONDITIONS_NOT_BETWEEN:()=>bg,FILTERS_CONDITIONS_NOT_CONTAIN:()=>hg,FILTERS_CONDITIONS_NOT_EMPTY:()=>sg,FILTERS_CONDITIONS_NOT_EQUAL:()=>lg,FILTERS_CONDITIONS_TODAY:()=>yg,FILTERS_CONDITIONS_TOMORROW:()=>Sg,FILTERS_CONDITIONS_YESTERDAY:()=>Rg,FILTERS_DIVS_FILTER_BY_CONDITION:()=>Tg,FILTERS_DIVS_FILTER_BY_VALUE:()=>xg,FILTERS_LABELS_CONJUNCTION:()=>Eg,FILTERS_LABELS_DISJUNCTION:()=>_g,FILTERS_NAMESPACE:()=>Or,FILTERS_VALUES_BLANK_CELLS:()=>Og});var IE="ContextMenu:items",le=IE,mp=`${le}.noItems`,pp=`${le}.insertRowAbove`,gp=`${le}.insertRowBelow`,wp=`${le}.insertColumnOnTheLeft`,bp=`${le}.insertColumnOnTheRight`,Cp=`${le}.removeRow`,vp=`${le}.removeColumn`,yp=`${le}.undo`,Sp=`${le}.redo`,Rp=`${le}.readOnly`,Tp=`${le}.clearColumn`,xp=`${le}.copy`,Ep=`${le}.copyWithHeaders`,_p=`${le}.copyWithGroupHeaders`,Op=`${le}.copyHeadersOnly`,Mp=`${le}.cut`,Ip=`${le}.freezeColumn`,Hp=`${le}.unfreezeColumn`,Ap=`${le}.mergeCells`,Np=`${le}.unmergeCells`,kp=`${le}.addComment`,Pp=`${le}.editComment`,Dp=`${le}.removeComment`,Lp=`${le}.readOnlyComment`,Fp=`${le}.align`,Vp=`${le}.align.left`,Wp=`${le}.align.center`,Bp=`${le}.align.right`,Up=`${le}.align.justify`,jp=`${le}.align.top`,zp=`${le}.align.middle`,Yp=`${le}.align.bottom`,qp=`${le}.borders`,Gp=`${le}.borders.top`,$p=`${le}.borders.right`,Kp=`${le}.borders.bottom`,Xp=`${le}.borders.left`,Qp=`${le}.borders.remove`,Zp=`${le}.nestedHeaders.insertChildRow`,Jp=`${le}.nestedHeaders.detachFromParent`,eg=`${le}.hideColumn`,tg=`${le}.showColumn`,rg=`${le}.hideRow`,og=`${le}.showRow`,Or="Filters:",ct=`${Or}conditions`,ig=`${ct}.none`,ng=`${ct}.isEmpty`,sg=`${ct}.isNotEmpty`,ag=`${ct}.isEqualTo`,lg=`${ct}.isNotEqualTo`,cg=`${ct}.beginsWith`,ug=`${ct}.endsWith`,dg=`${ct}.contains`,hg=`${ct}.doesNotContain`,VW=`${ct}.byValue`,fg=`${ct}.greaterThan`,mg=`${ct}.greaterThanOrEqualTo`,pg=`${ct}.lessThan`,gg=`${ct}.lessThanOrEqualTo`,wg=`${ct}.isBetween`,bg=`${ct}.isNotBetween`,Cg=`${ct}.after`,vg=`${ct}.before`,yg=`${ct}.today`,Sg=`${ct}.tomorrow`,Rg=`${ct}.yesterday`,Tg=`${Or}labels.filterByCondition`,xg=`${Or}labels.filterByValue`,Eg=`${Or}labels.conjunction`,_g=`${Or}labels.disjunction`,Og=`${Or}values.blankCells`,Mg=`${Or}buttons.selectAll`,Ig=`${Or}buttons.clear`,Hg=`${Or}buttons.ok`,Ag=`${Or}buttons.cancel`,Ng=`${Or}buttons.placeholder.search`,kg=`${Or}buttons.placeholder.value`,Pg=`${Or}buttons.placeholder.secondValue`,Dg="CheckboxRenderer:",Lg=`${Dg}checked`,Fg=`${Dg}unchecked`;var WW={languageCode:"en-US",[mp]:"No available options",[pp]:"Insert row above",[gp]:"Insert row below",[wp]:"Insert column left",[bp]:"Insert column right",[Cp]:["Remove row","Remove rows"],[vp]:["Remove column","Remove columns"],[yp]:"Undo",[Sp]:"Redo",[Rp]:"Read only",[Tp]:"Clear column",[Fp]:"Alignment",[Vp]:"Left",[Wp]:"Center",[Bp]:"Right",[Up]:"Justify",[jp]:"Top",[zp]:"Middle",[Yp]:"Bottom",[Ip]:"Freeze column",[Hp]:"Unfreeze column",[qp]:"Borders",[Gp]:"Top",[$p]:"Right",[Kp]:"Bottom",[Xp]:"Left",[Qp]:"Remove border(s)",[kp]:"Add comment",[Pp]:"Edit comment",[Dp]:"Delete comment",[Lp]:"Read-only comment",[Ap]:"Merge cells",[Np]:"Unmerge cells",[xp]:"Copy",[Ep]:["Copy with header","Copy with headers"],[_p]:["Copy with group header","Copy with group headers"],[Op]:["Copy header only","Copy headers only"],[Mp]:"Cut",[Zp]:"Insert child row",[Jp]:"Detach from parent",[eg]:["Hide column","Hide columns"],[tg]:["Show column","Show columns"],[rg]:["Hide row","Hide rows"],[og]:["Show row","Show rows"],[ig]:"None",[ng]:"Is empty",[sg]:"Is not empty",[ag]:"Is equal to",[lg]:"Is not equal to",[cg]:"Begins with",[ug]:"Ends with",[dg]:"Contains",[hg]:"Does not contain",[fg]:"Greater than",[mg]:"Greater than or equal to",[pg]:"Less than",[gg]:"Less than or equal to",[wg]:"Is between",[bg]:"Is not between",[Cg]:"After",[vg]:"Before",[yg]:"Today",[Sg]:"Tomorrow",[Rg]:"Yesterday",[Og]:"Blank cells",[Tg]:"Filter by condition",[xg]:"Filter by value",[Eg]:"And",[_g]:"Or",[Mg]:"Select all",[Ig]:"Clear",[Hg]:"OK",[Ag]:"Cancel",[Ng]:"Search",[kg]:"Value",[Pg]:"Second value",[Lg]:"Checked",[Fg]:"Unchecked"},Vg=WW;var HE=Ld,Wg=Vg.languageCode,{register:BW,getItem:AE,hasItem:UW,getValues:jW}=Lr("languagesDictionaries");Bg(Vg);function Bg(r,e){let t=r,o=e;return qt(r)&&(o=r,t=o.languageCode),zW(t,o),BW(t,jr(o)),jr(o)}function zW(r,e){r!==Wg&&OE(e,AE(Wg))}function Ug(r){return Fd(r)?jr(AE(r)):null}function Fd(r){return UW(r)}function NE(){return jW()}function Vd(r,e,t){let o=Ug(r);if(o===null)return null;let n=o[e];if(pt(n))return null;let i=YW(n,t);return Array.isArray(i)?i[0]:i}function YW(r,e){let t=r;return re(ME(),o=>{t=o(r,e)}),t}function kE(r){let e=Pd(r);return Fd(e)||(e=Wg,Dd(r)),e}var C7=S(V(),1),v7=S(me(),1),y7=S(tr(),1),S7=S(rr(),1),R7=S(or(),1),T7=S(ir(),1),x7=S(nr(),1),E7=S(sr(),1),_7=S(ar(),1);var V5=S(V(),1),W5=S(me(),1);var J9=S(V(),1);function qW(r,e,t){return(e=GW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function GW(r){var e=$W(r,"string");return typeof e=="symbol"?e:e+""}function $W(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var jg=class extends id{constructor(e,t){super(e,null),qW(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:o}=e,n=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(o,-1);return n===null||i===null?null:((n.row>i.row||n.col>i.col)&&(n=t,i=o),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(n===null)return null;let i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,o);return i===null?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(e,t,o){return t<0?t:e.getNearestNotHiddenIndex(t,o)}commit(){if(this.visualCellRange===null)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let t=e.from.clone().normalize(),o=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),a=null;if((i===null||i.col===null||i.row===null)&&(a=this.getNearestNotHiddenCoords(t,o,n)),a!==null&&e.overlaps(a)){let c=e.highlight.clone();if(c.row>=0&&(c.row=a.row),c.col>=0&&(c.col=a.col),this.cellRange===null){let u=this.settings.visualToRenderableCoords(c);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(c)}return this.settings.selectionType==="focus"&&i!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){let o=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(t);return o.row===null||o.col===null||n.row===null||n.col===null?null:this.settings.createCellRange(o,o,n)}},Wt=jg;function Wd(r){let o=r,{activeHeaderClassName:e}=o,t=kt(o,["activeHeaderClassName"]);return new Wt(je(pe({className:e},t),{selectionType:nd}))}function PE(r){let o=r,{areaCornerVisible:e}=o,t=kt(o,["areaCornerVisible"]);return new Wt(je(pe({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e}},t),{selectionType:Xi}))}function DE(r){let e=kt(r,[]);return new Wt(je(pe({className:"highlight"},e),{selectionType:Xi}))}function LE(r){let o=r,{columnClassName:e}=o,t=kt(o,["columnClassName"]);return new Wt(je(pe({className:e},t),{selectionType:ld}))}function FE(r){let o=r,{cellCornerVisible:e}=o,t=kt(o,["cellCornerVisible"]);return new Wt(je(pe({className:"current",headerAttributes:[cu()],border:{width:2,color:"#4b89ff",cornerVisible:e}},t),{selectionType:kn}))}function VE(r){let n=r,{border:e,visualCellRange:t}=n,o=kt(n,["border","visualCellRange"]);return new Wt(je(pe(pe({},e),o),{selectionType:cd}),t)}function WE(r){let e=kt(r,[]);return new Wt(je(pe({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:sd}))}function zg(r){let o=r,{headerClassName:e}=o,t=kt(o,["headerClassName"]);return new Wt(je(pe({className:e},t),{selectionType:Vs}))}function BE(r){let o=r,{rowClassName:e}=o,t=kt(o,["rowClassName"]);return new Wt(je(pe({className:e},t),{selectionType:ad}))}function KW(r,e){XW(r,e),e.add(r)}function XW(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(r,e,t){return(e=QW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function QW(r){var e=ZW(r,"string");return typeof e=="symbol"?e:e+""}function ZW(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gi(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Uo=new WeakSet,Yg=class{constructor(e){KW(this,Uo),Mr(this,"options",void 0),Mr(this,"layerLevel",0),Mr(this,"focus",void 0),Mr(this,"fill",void 0),Mr(this,"layeredAreas",new Map),Mr(this,"areas",new Map),Mr(this,"rowHeaders",new Map),Mr(this,"columnHeaders",new Map),Mr(this,"activeRowHeaders",new Map),Mr(this,"activeColumnHeaders",new Map),Mr(this,"activeCornerHeaders",new Map),Mr(this,"rowHighlights",new Map),Mr(this,"columnHighlights",new Map),Mr(this,"customSelections",[]),this.options=e,this.focus=FE(e),this.fill=WE(e)}isEnabledFor(e,t){let o=e;e===kn&&(o="current");let n=this.options.disabledCellSelection(t.row,t.col);return typeof n=="string"&&(n=[n]),n===!1||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return gi(Uo,this,wi).call(this,this.layeredAreas,PE)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return gi(Uo,this,wi).call(this,this.areas,DE)}getAreas(){return[...this.areas.values()]}createRowHeader(){return gi(Uo,this,wi).call(this,this.rowHeaders,zg)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return gi(Uo,this,wi).call(this,this.columnHeaders,zg)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return gi(Uo,this,wi).call(this,this.activeRowHeaders,Wd)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return gi(Uo,this,wi).call(this,this.activeColumnHeaders,Wd)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return gi(Uo,this,wi).call(this,this.activeCornerHeaders,Wd)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return gi(Uo,this,wi).call(this,this.rowHighlights,BE)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return gi(Uo,this,wi).call(this,this.columnHighlights,LE)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(VE(pe(pe({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),re(this.areas.values(),e=>void e.clear()),re(this.layeredAreas.values(),e=>void e.clear()),re(this.rowHeaders.values(),e=>void e.clear()),re(this.columnHeaders.values(),e=>void e.clear()),re(this.activeRowHeaders.values(),e=>void e.clear()),re(this.activeColumnHeaders.values(),e=>void e.clear()),re(this.activeCornerHeaders.values(),e=>void e.clear()),re(this.rowHighlights.values(),e=>void e.clear()),re(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function wi(r,e){let t=this.layerLevel;if(r.has(t))return r.get(t);let o=e(pe({layerLevel:t},this.options));return r.set(t,o),o}var UE=Yg;var e7=S(V(),1),t7=S(me(),1);function jE(r,e,t){return(e=JW(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function JW(r){var e=eB(r,"string");return typeof e=="symbol"?e:e+""}function eB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var qg=class{constructor(e){jE(this,"ranges",[]),jE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},zE=qg;var o7=S(V(),1);function tB(r,e){GE(r,e),e.add(r)}function Gg(r,e,t){GE(r,e),e.set(r,t)}function GE(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(r,e){return r.get(Tt(r,e))}function Bd(r,e,t){return r.set(Tt(r,e),t),t}function Tt(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ud=new WeakMap,qe=new WeakMap,_o=new WeakMap,Ht=new WeakSet,jd=class{constructor(e,t){tB(this,Ht),Gg(this,Ud,void 0),Gg(this,qe,void 0),Gg(this,_o,{x:0,y:0}),Bd(Ud,this,e),Bd(qe,this,t)}transformStart(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=Oe(qe,this).createCellCoords(e,t),i=Oe(Ud,this).current().highlight,a=Oe(qe,this).visualToRenderableCoords(i),c=0,u=0;if(this.runLocalHooks("beforeTransformStart",n),a.row!==null&&a.col!==null){let{width:m,height:g}=Tt(Ht,this,$E).call(this),{row:C,col:v}=Tt(Ht,this,qE).call(this,i),y=Oe(qe,this).fixedRowsBottom(),R=Oe(qe,this).minSpareRows(),O=Oe(qe,this).minSpareCols(),N=Oe(qe,this).autoWrapRow(),I=Oe(qe,this).autoWrapCol(),j=Oe(qe,this).createCellCoords(C+n.row,v+n.col);if(j.row>=g){let de=cr(o&&R>0&&y===0),J=j.col+1,te=Oe(qe,this).createCellCoords(j.row-g,J>=m?J-m:J);this.runLocalHooks("beforeColumnWrap",de,Tt(Ht,this,Gs).call(this,te),J>=m),de.value?this.runLocalHooks("insertRowRequire",Oe(qe,this).countRenderableRows()):I&&j.assign(te)}else if(j.row<0){let de=cr(I),J=j.col-1,te=Oe(qe,this).createCellCoords(g+j.row,J<0?m+J:J);this.runLocalHooks("beforeColumnWrap",de,Tt(Ht,this,Gs).call(this,te),J<0),I&&j.assign(te)}if(j.col>=m){let de=cr(o&&O>0),J=j.row+1,te=Oe(qe,this).createCellCoords(J>=g?J-g:J,j.col-m);this.runLocalHooks("beforeRowWrap",de,Tt(Ht,this,Gs).call(this,te),J>=g),de.value?this.runLocalHooks("insertColRequire",Oe(qe,this).countRenderableColumns()):N&&j.assign(te)}else if(j.col<0){let de=cr(N),J=j.row-1,te=Oe(qe,this).createCellCoords(J<0?g+J:J,m+j.col);this.runLocalHooks("beforeRowWrap",de,Tt(Ht,this,Gs).call(this,te),J<0),N&&j.assign(te)}let{rowDir:ie,colDir:ue}=Tt(Ht,this,YE).call(this,j);c=ie,u=ue,i=Tt(Ht,this,Gs).call(this,j)}return this.runLocalHooks("afterTransformStart",i,c,u),i}transformEnd(e,t){let o=Oe(qe,this).createCellCoords(e,t),n=Oe(Ud,this).current(),i=Oe(qe,this).visualToRenderableCoords(n.highlight),a=Tt(Ht,this,$g).call(this,n.to.row,n.from.row),c=Tt(Ht,this,Kg).call(this,n.to.col,n.from.col),u=n.to.clone(),m=0,g=0;if(this.runLocalHooks("beforeTransformEnd",o),i.row!==null&&i.col!==null&&a!==null&&c!==null){let{row:C,col:v}=Tt(Ht,this,qE).call(this,n.highlight),y=Oe(qe,this).createCellCoords(a+o.row,c+o.col),R=n.getTopStartCorner(),O=n.getTopEndCorner(),N=n.getBottomEndCorner();if(o.col<0&&c>=v&&y.col<v){let ue=y.col-v;y.col=Tt(Ht,this,Kg).call(this,R.col,O.col)+ue}else if(o.col>0&&c<=v&&y.col>v){let ue=Tt(Ht,this,Kg).call(this,O.col,R.col),de=Math.max(y.col-ue,1);y.col=ue+de}if(o.row<0&&a>=C&&y.row<C){let ue=y.row-C;y.row=Tt(Ht,this,$g).call(this,R.row,N.row)+ue}else if(o.row>0&&a<=C&&y.row>C){let ue=Tt(Ht,this,$g).call(this,N.row,R.row),de=Math.max(y.row-ue,1);y.row=ue+de}let{rowDir:I,colDir:j}=Tt(Ht,this,YE).call(this,y);m=I,g=j;let ie=Tt(Ht,this,Gs).call(this,y);o.row===0&&o.col!==0?u.col=ie.col:o.row!==0&&o.col===0?u.row=ie.row:(u.row=ie.row,u.col=ie.col)}return this.runLocalHooks("afterTransformEnd",u,m,g),u}setOffsetSize(e){let{x:t,y:o}=e;Bd(_o,this,{x:t,y:o})}resetOffsetSize(){Bd(_o,this,{x:0,y:0})}};function YE(r){let{width:e,height:t}=Tt(Ht,this,$E).call(this),o=0,n=0;return r.row<0?(o=-1,r.row=0):r.row>0&&r.row>=t&&(o=1,r.row=t-1),r.col<0?(n=-1,r.col=0):r.col>0&&r.col>=e&&(n=1,r.col=e-1),{rowDir:o,colDir:n}}function $E(){return{width:Oe(_o,this).x+Oe(qe,this).countRenderableColumns(),height:Oe(_o,this).y+Oe(qe,this).countRenderableRows()}}function $g(r,e){let t=Oe(qe,this).findFirstNonHiddenRenderableRow(r,e);return t===null?null:Oe(_o,this).y+t}function Kg(r,e){let t=Oe(qe,this).findFirstNonHiddenRenderableColumn(r,e);return t===null?null:Oe(_o,this).x+t}function qE(r){let{row:e,col:t}=Oe(qe,this).visualToRenderableCoords(r);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return Oe(qe,this).createCellCoords(Oe(_o,this).y+e,Oe(_o,this).x+t)}function Gs(r){let e=r.clone();return e.col=r.col-Oe(_o,this).x,e.row=r.row-Oe(_o,this).y,Oe(qe,this).renderableToVisualCoords(e)}Te(jd,dr);var Xg=jd;var a7=S(V(),1),l7=S(me(),1),c7=S(tr(),1),u7=S(rr(),1),d7=S(or(),1),h7=S(ir(),1),f7=S(nr(),1),m7=S(sr(),1),p7=S(ar(),1);var Zg=0,Jg=1,XE=2,ew=3,rB=[ew,XE],oB=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Qg=Symbol("root"),KE=Symbol("child");function tw(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qg;if(e!==Qg&&e!==KE)throw new Error("The second argument is used internally only and cannot be overwritten.");let t=Array.isArray(r),o=e===Qg,n=Zg;if(t){let i=r[0];r.length===0?n=Jg:o&&i instanceof Mn?n=ew:o&&Array.isArray(i)?n=tw(i,KE):r.length>=2&&r.length<=4&&!r.some((c,u)=>!oB[u].includes(typeof c))&&(n=XE)}return n}function QE(r){let{createCellCoords:e,createCellRange:t,keepDirection:o=!1,propToCol:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!rB.includes(r))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){let a=r===ew,c=a?i.from.row:i[0],u=a?i.from.col:i[1],m=a?i.to.row:i[2],g=a?i.to.col:i[3];if(typeof n=="function"&&(typeof u=="string"&&(u=n(u)),typeof g=="string"&&(g=n(g))),pt(m)&&(m=c),pt(g)&&(g=u),!o){let y=c,R=u,O=m,N=g;c=Math.min(y,O),u=Math.min(R,N),m=Math.max(y,O),g=Math.max(R,N)}let C=e(c,u),v=e(m,g);return t(C,C,v)}}function $s(r,e,t){iB(r,e),e.set(r,t)}function iB(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(r,e,t){return(e=nB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function nB(r){var e=sB(r,"string");return typeof e=="symbol"?e:e+""}function sB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Qe(r,e){return r.get(ZE(r,e))}function jo(r,e,t){return r.set(ZE(r,e),t),t}function ZE(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var fr=new WeakMap,Un=new WeakMap,zd=new WeakMap,Ul=new WeakMap,Yd=new WeakMap,jl=new WeakMap,qd=class{constructor(e,t){var o=this;Bn(this,"settings",void 0),Bn(this,"tableProps",void 0),Bn(this,"inProgress",!1),Bn(this,"selectedRange",new zE((n,i,a)=>this.tableProps.createCellRange(n,i,a))),Bn(this,"highlight",void 0),$s(this,fr,void 0),$s(this,Un,void 0),Bn(this,"selectedByRowHeader",new Set),Bn(this,"selectedByColumnHeader",new Set),$s(this,zd,!1),$s(this,Ul,!1),$s(this,Yd,"unknown"),$s(this,jl,-1),this.settings=e,this.tableProps=t,this.highlight=new UE({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[cu()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(n,i)=>this.tableProps.isDisabledCellSelection(n,i),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),createCellCoords:(n,i)=>this.tableProps.createCellCoords(n,i),createCellRange:(n,i,a)=>this.tableProps.createCellRange(n,i,a)}),jo(fr,this,new Xg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,i)=>this.tableProps.createCellCoords(n,i),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),jo(Un,this,new Xg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let n=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,n.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let n=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,n.getOuterBottomEndCorner().col)},visualToRenderableCoords:n=>this.tableProps.visualToRenderableCoords(n),renderableToVisualCoords:n=>this.tableProps.renderableToVisualCoords(n),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(n,i)=>this.tableProps.createCellCoords(n,i),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Qe(fr,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("beforeModifyTransformStart",...i)}),Qe(fr,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("afterModifyTransformStart",...i)}),Qe(fr,this).addLocalHook("beforeTransformEnd",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("beforeModifyTransformEnd",...i)}),Qe(fr,this).addLocalHook("afterTransformEnd",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("afterModifyTransformEnd",...i)}),Qe(fr,this).addLocalHook("insertRowRequire",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("insertRowRequire",...i)}),Qe(fr,this).addLocalHook("insertColRequire",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("insertColRequire",...i)}),Qe(fr,this).addLocalHook("beforeRowWrap",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("beforeRowWrap",...i)}),Qe(fr,this).addLocalHook("beforeColumnWrap",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("beforeColumnWrap",...i)}),Qe(Un,this).addLocalHook("beforeTransformStart",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("beforeModifyTransformFocus",...i)}),Qe(Un,this).addLocalHook("afterTransformStart",function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return o.runLocalHooks("afterModifyTransformFocus",...i)})}getSelectedRange(){return this.selectedRange}markSource(e){jo(Yd,this,e)}markEndSource(){jo(Yd,this,"unknown")}getSelectionSource(){return Qe(Yd,this)}setExpectedLayers(e){jo(jl,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,jo(jl,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=this.settings.selectionMode==="multiple",a=pt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,c=e.clone();jo(zd,this,!1),this.runLocalHooks(`beforeSetRangeStart${o?"Only":""}`,c),(!i||i&&!a&&pt(t))&&this.selectedRange.clear(),this.selectedRange.add(c).current().setHighlight(n.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(e)}setRangeStartOnly(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,o)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;let t=e.clone(),o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((o>0||n>0)&&(o===0&&t.col<0&&!i||n===0&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();let a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{let u=a.getHorizontalDirection(),m=a.getVerticalDirection(),g=this.isMultiple();a.setTo(t),g&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),g&&(m!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}o>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();let c=Qe(jl,this)===-1||this.selectedRange.size()===Qe(jl,this);this.runLocalHooks("afterSetRangeEnd",e,c)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel(),o=this.tableProps.countRows(),n=this.tableProps.countCols();t<this.highlight.layerLevel&&(re(this.highlight.getAreas(),R=>void R.clear()),re(this.highlight.getLayeredAreas(),R=>void R.clear()),re(this.highlight.getRowHeaders(),R=>void R.clear()),re(this.highlight.getColumnHeaders(),R=>void R.clear()),re(this.highlight.getActiveRowHeaders(),R=>void R.clear()),re(this.highlight.getActiveColumnHeaders(),R=>void R.clear()),re(this.highlight.getActiveCornerHeaders(),R=>void R.clear()),re(this.highlight.getRowHighlights(),R=>void R.clear()),re(this.highlight.getColumnHighlights(),R=>void R.clear())),this.highlight.useLayerLevel(t);let i=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(i.clear(),a.clear(),c.clear(),u.clear(),m.clear(),g.clear(),C.clear(),v.clear(),y.clear(),this.highlight.isEnabledFor(Xi,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),t===1)){let R=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(R.from).commit().syncWith(R),this.highlight.createLayeredArea().add(R.from).commit().syncWith(R),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(Vs,e.highlight)){if(!e.isSingleHeader()){let N=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),I=this.tableProps.createCellCoords(e.to.row,-1),j=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),ie=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(c.add(N).commit(),u.add(j).commit(),v.add(N).commit(),y.add(j).commit()):(c.add(N).add(I).commit(),u.add(j).add(ie).commit(),v.add(N).add(I).commit(),y.add(j).add(ie).commit())}let R=!Qe(Ul,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||n===0&&this.isSelectedByRowHeader()),O=!Qe(Ul,this)&&this.isEntireColumnSelected()&&(o>0&&o===e.getHeight()||o===0&&this.isSelectedByColumnHeader());R&&m.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),O&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),R&&O&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;let t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);let o=this.highlight.getFocus();o.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(kn,t.highlight)&&o.add(t.highlight).commit().syncWith(t),this.inProgress||(jo(zd,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Qe(fr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Qe(fr,this).resetOffsetSize(),this.setRangeStart(Qe(fr,this).transformStart(e,t,o))}transformEnd(e,t){this.settings.navigableHeaders?Qe(fr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Qe(fr,this).resetOffsetSize(),this.setRangeEnd(Qe(fr,this).transformEnd(e,t))}transformFocus(e,t){let o=this.selectedRange.current(),{row:n,col:i}=o.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,i-1),c=this.tableProps.countRenderableRowsInRange(0,n-1);o.highlight.isHeader()?Qe(Un,this).setOffsetSize({x:i<0?Math.abs(i):-a,y:n<0?Math.abs(n):-c}):Qe(Un,this).setOffsetSize({x:i<0?0:-a,y:n<0?0:-c});let u=Qe(Un,this).transformStart(e,t);this.setRangeFocus(u.normalize())}shiftRows(e,t){if(!this.isSelected())return;let o=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||o.getOuterTopStartCorner().row>=e){let{from:n,to:i,highlight:a}=o,c=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),m=this.isSelectedByColumnHeader(),g=m?-1:0,C=m?0:t;this.getSelectedRange().pop();let v=this.tableProps.createCellCoords(nt(n.row+C,g,c-1),n.col),y=this.tableProps.createCellCoords(nt(i.row+t,g,c-1),i.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(nt(a.row+t,0,c-1),a.col)):this.setRangeStartOnly(v,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),m&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;let o=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||o.getOuterTopStartCorner().col>=e){let{from:n,to:i,highlight:a}=o,c=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),m=this.isSelectedByColumnHeader(),g=u?-1:0,C=u?0:t;this.getSelectedRange().pop();let v=this.tableProps.createCellCoords(n.row,nt(n.col+C,g,c-1)),y=this.tableProps.createCellCoords(i.row,nt(i.col+t,g,c-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(a.row,nt(a.col+t,0,c-1))):this.setRangeStartOnly(v,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),m&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let e=cr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Qe(zd,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),t=n=>{let{col:i}=n.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countCols();return(a>0&&i<0||a===0)&&n.getWidth()===c};if(e===-1)return Array.from(this.selectedRange).some(n=>t(n));let o=this.selectedRange.peekByIndex(e);return o?t(o):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),t=n=>{let{row:i}=n.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),c=this.tableProps.countRows();return(a>0&&i<0||a===0)&&n.getHeight()===c};if(e===-1)return Array.from(this.selectedRange).some(n=>t(n));let o=this.selectedRange.peekByIndex(e);return o?t(o):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){let t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},i=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),m=o?-u:0,g=t?-c:0;if(m===0&&g===0&&(i===0||a===0))return;let C=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight,{focusPosition:v,disableHeadersHighlight:y}=n;jo(Ul,this,y),v&&Number.isInteger(v?.row)&&Number.isInteger(v?.col)&&(C=this.tableProps.createCellCoords(nt(v.row,m,i-1),nt(v.col,g,a-1)));let R=this.tableProps.createCellCoords(m,g),O=this.tableProps.createCellCoords(i-1,a-1);this.clear(),this.setRangeStartOnly(R,void 0,C),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),m<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.finish(),jo(Ul,this,!1)}selectCells(e){var t=this;let o=tw(e);if(o===Jg)return!1;if(o===Zg)throw new Error(mt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let n=QE(o,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),i=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},c=!e.some(u=>{let m=n(u),g=m.isValid(a);return!(g&&!m.containsHeaders()||g&&m.containsHeaders()&&m.isSingleHeader())});return c&&(this.clear(),this.setExpectedLayers(e.length),re(e,u=>{let{from:m,to:g}=n(u);this.setRangeStartOnly(m.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),c}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countRows(),c=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),m=u===0?0:-u,g=this.tableProps.createCellCoords(m,n),C=this.tableProps.createCellCoords(a-1,i),v=this.tableProps.createCellRange(g,g,C).isValid({countRows:a,countCols:c,countRowHeaders:0,countColHeaders:u});if(v){let y=0,R=0;Number.isInteger(o?.row)&&Number.isInteger(o?.col)?(y=nt(o.row,m,a-1),R=nt(o.col,Math.min(n,i),Math.max(n,i))):(y=nt(o,m,a-1),R=n);let O=this.tableProps.createCellCoords(y,R),N=u===0?0:nt(O.row,m,-1),I=a-1,j=this.tableProps.createCellCoords(N,n),ie=this.tableProps.createCellCoords(I,i);this.runLocalHooks("beforeSelectColumns",j,ie,O),j.row=N,ie.row=I,this.setRangeStartOnly(j,void 0,O),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(ie),this.runLocalHooks("afterSelectColumns",j,ie,O),this.finish()}return v}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=this.tableProps.countRows(),i=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=a===0?0:-a,u=this.tableProps.createCellCoords(e,c),m=this.tableProps.createCellCoords(t,i-1),g=this.tableProps.createCellRange(u,u,m).isValid({countRows:n,countCols:i,countRowHeaders:a,countColHeaders:0});if(g){let C=0,v=0;Number.isInteger(o?.row)&&Number.isInteger(o?.col)?(C=nt(o.row,Math.min(e,t),Math.max(e,t)),v=nt(o.col,c,i-1)):(C=e,v=nt(o,c,i-1));let y=this.tableProps.createCellCoords(C,v),R=a===0?0:nt(y.col,c,-1),O=i-1,N=this.tableProps.createCellCoords(e,R),I=this.tableProps.createCellCoords(t,O);this.runLocalHooks("beforeSelectRows",N,I,y),N.col=R,I.col=O,this.setRangeStartOnly(N,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectRows",N,I,y),this.finish()}return g}refresh(){if(!this.isSelected())return;let e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}let o=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:i,highlight:a}=o;this.clear(),a.assign({row:nt(a.row,-1/0,e-1),col:nt(a.col,-1/0,t-1)}),n.assign({row:nt(n.row,-1/0,e-1),col:nt(n.col,-1/0,t-1)}),i.assign({row:nt(i.row,0,e-1),col:nt(i.col,0,t-1)}),this.selectedRange.ranges.push(o),this.highlight.getFocus().add(a).commit().syncWith(o),this.applyAndCommit(o)}commit(){if(this.highlight.getCustomSelections().forEach(n=>{n.commit()}),!this.isSelected())return;let t=this.highlight.getFocus(),o=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);let i=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();i.commit(),a.commit(),c.commit(),u.commit(),m.commit(),g.commit(),C.commit(),v.commit(),y.commit()}this.highlight.useLayerLevel(o)}};Te(qd,dr);var rw=qd;var G7=S(V(),1),$7=S(me(),1);function Gd(r){let e,t,o,n,i="",a;for(e=0,t=r.length;e<t;e+=1){for(n=r[e].length,o=0;o<n;o+=1)o>0&&(i+="	"),a=r[e][o],typeof a=="string"?a.indexOf(`
`)>-1?i+=`"${a.replace(/"/g,'""')}"`:i+=a:a==null?i+="":i+=a;e!==t-1&&(i+=`
`)}return i}function jn(r,e,t){return(e=aB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function aB(r){var e=lB(r,"string");return typeof e=="symbol"?e:e+""}function lB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ow=class r{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,o){jn(this,"hot",void 0),jn(this,"metaManager",void 0),jn(this,"tableMeta",void 0),jn(this,"dataSource",void 0),jn(this,"duckSchema",void 0),jn(this,"colToPropCache",void 0),jn(this,"propToColCache",void 0),this.hot=e,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let t=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,t){let n=0,i=0,a=!1;if(typeof t=="function"){let c=Es(e);n=c>0?c:this.countFirstRowKeys(),a=!0}else{let c=this.tableMeta.maxCols;n=Math.min(c,t.length)}for(o=0;o<n;o++){let c=a?t(o):t[o];if(qt(c)){if(typeof c.data<"u"){let u=a?i:o;this.colToPropCache[u]=c.data,this.propToColCache.set(c.data,u)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Rd(this.dataSource)}recursiveDuckColumns(e,t,o){let n=t,i=o,a;return typeof n>"u"&&(n=0,i=""),typeof e=="object"&&!Array.isArray(e)&&be(e,(c,u)=>{c===null?(a=i+u,this.colToPropCache.push(a),this.propToColCache.set(a,n),n+=1):n=this.recursiveDuckColumns(c,n,`${u}.`)}),n}colToProp(e){if(Number.isInteger(e)===!1)return e;let t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&oe(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){let t=this.propToColCache.get(e);if(oe(t))return this.hot.toVisualColumn(t);let o=this.hot.toVisualColumn(e);return o===null?e:o}getSchema(){let e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Rn(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.hot.countSourceRows(),a=i,c=0,u=e;if((typeof u!="number"||u>=i)&&(u=i),u<this.hot.countRows()&&(a=this.hot.toPhysicalRow(u)),this.hot.runHooks("beforeCreateRow",u,t,o)===!1||a===null)return{delta:0};let g=this.tableMeta.maxRows,C=this.getSchema().length,v=[];for(;c<t&&i+c<g;){let R=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?R=jr(this.getSchema()):(R=[],$t(C-1,()=>R.push(null))):this.hot.dataType==="function"?R=this.tableMeta.dataSchema(u+c):(R={},lm(R,this.getSchema())),v.push(R),c+=1}this.hot.rowIndexMapper.insertIndexes(u,c),n==="below"&&(a=Math.min(a+1,i)),this.spliceData(a,0,v);let y=this.hot.toVisualRow(a);return this.hot.countSourceRows()===v.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),c>0&&(e==null?this.metaManager.createRow(null,c):o!=="auto"&&this.metaManager.createRow(a,t)),this.hot.runHooks("afterCreateRow",y,c,o),this.hot.forceFullRender=!0,{delta:c,startPhysicalIndex:a}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let i=this.dataSource,a=this.tableMeta.maxCols,c=this.hot.countSourceCols(),u=e;if((typeof u!="number"||u>=c)&&(u=c),this.hot.runHooks("beforeCreateCol",u,t,o)===!1)return{delta:0};let g=c;u<this.hot.countCols()&&(g=this.hot.toPhysicalColumn(u));let C=this.hot.countSourceRows(),v=this.hot.countCols(),y=0,R=g;n==="end"&&(R=Math.min(R+1,c));let O=R;for(;y<t&&v<a;){if(typeof u!="number"||u>=v)if(C>0)for(let I=0;I<C;I+=1)typeof i[I]>"u"&&(i[I]=[]),i[I].push(null);else i.push([null]);else for(let I=0;I<C;I++)i[I].splice(R,0,null);y+=1,R+=1,v+=1}this.hot.columnIndexMapper.insertIndexes(u,y),y>0&&(e==null?this.metaManager.createColumn(null,y):o!=="auto"&&this.metaManager.createColumn(O,t));let N=this.hot.toVisualColumn(O);return this.hot.runHooks("afterCreateCol",N,y,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:O}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t,i=this.visualRowsToPhysical(n,t),a=this.hot.countSourceRows();if(n=(a+n)%a,this.hot.runHooks("beforeRemoveRow",n,i.length,i,o)===!1)return!1;let u=i.length;if(this.filterData(n,u,i),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);let g=oe(this.tableMeta.columns)||oe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&g===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((g,C)=>C-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",n,u,i,o),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n=typeof e!="number"?-t:e;n=(this.hot.countCols()+n)%this.hot.countCols();let i=this.visualColumnsToPhysical(n,t),a=i.slice(0).sort((C,v)=>v-C);if(this.hot.runHooks("beforeRemoveCol",n,t,i,o)===!1)return!1;let u=!0,m=a.length,g=this.dataSource;for(let C=0;C<m;C++)u&&i[0]!==i[C]-C&&(u=!1);if(u)for(let C=0,v=this.hot.countSourceRows();C<v;C++)g[C].splice(i[0],t),C===0&&this.metaManager.removeColumn(i[0],t);else for(let C=0,v=this.hot.countSourceRows();C<v;C++)for(let y=0;y<m;y++)g[C].splice(a[y],1),C===0&&this.metaManager.removeColumn(a[y],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,t,i,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,o){let n=this.hot.getDataAtCol(e),i=n.slice(t,t+o),a=n.slice(t+o);for(var c=arguments.length,u=new Array(c>3?c-3:0),m=3;m<c;m++)u[m-3]=arguments[m];Xf(u,a);let g=0;for(;g<o;)u.push(null),g+=1;return ER(u),this.hot.populateFromArray(t,e,u,null,null,"spliceCol"),i}spliceRow(e,t,o){let n=this.hot.getSourceDataAtRow(e),i=n.slice(t,t+o),a=n.slice(t+o);for(var c=arguments.length,u=new Array(c>3?c-3:0),m=3;m<c;m++)u[m-3]=arguments[m];Xf(u,a);let g=0;for(;g<o;)u.push(null),g+=1;return this.hot.populateFromArray(e,t,[u],null,null,"spliceRow"),i}spliceData(e,t,o){if(this.hot.runHooks("beforeDataSplice",e,t,o)!==!1){let i=[...this.dataSource.slice(0,e),...o,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(a=>this.dataSource.push(a))}}filterData(e,t,o){let n=this.hot.runHooks("filterData",e,t,o);Array.isArray(n)===!1&&(n=this.dataSource.filter((i,a)=>o.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,t){let o=this.hot.toPhysicalRow(e),n=this.dataSource[o],i=this.hot.runHooks("modifyRowData",o);n=isNaN(i)?i:n;let{dataDotNotation:a}=this.hot.getSettings(),c=null;if(n&&n.hasOwnProperty&&Do(n,t))c=n[t];else if(a&&typeof t=="string"&&t.indexOf(".")>-1){let u=n;if(!u)return null;let m=t.split(".");for(let g=0,C=m.length;g<C;g++)if(u=u[m[g]],typeof u>"u")return null;c=u}else typeof t=="function"&&(c=t(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){let u=cr(c);this.hot.runHooks("modifyData",o,this.propToCol(t),u,"get"),u.isTouched()&&(c=u.value)}return c}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,o){let n=this.hot.toPhysicalRow(e),i=o,a=this.dataSource[n],c=this.hot.runHooks("modifyRowData",n);if(a=isNaN(c)?c:a,this.hot.hasHook("modifyData")){let m=cr(i);this.hot.runHooks("modifyData",n,this.propToCol(t),m,"set"),m.isTouched()&&(i=m.value)}let{dataDotNotation:u}=this.hot.getSettings();if(a&&a.hasOwnProperty&&Do(a,t))a[t]=i;else if(u&&typeof t=="string"&&t.indexOf(".")>-1){let m=a,g=0,C,v=t.split(".");for(g=0,C=v.length-1;g<C;g++)typeof m[v[g]]>"u"&&(m[v[g]]={}),m=m[v[g]];m[v[g]]=i}else typeof t=="function"?t(this.dataSource.slice(n,n+1)[0],i):a[t]=i}visualRowsToPhysical(e,t){let o=this.hot.countSourceRows(),n=[],i=(o+e)%o,a=t,c;for(;i<o&&a;)c=this.hot.toPhysicalRow(i),n.push(c),a-=1,i+=1;return n}visualColumnsToPhysical(e,t){let o=this.hot.countCols(),n=[],i=(o+e)%o,a=t;for(;i<o&&a;){let c=this.hot.toPhysicalColumn(i);n.push(c),a-=1,i+=1}return n}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){let e=this.tableMeta.maxRows,t;e<0||e===0?t=0:t=e||1/0;let o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,t)}getAll(){let e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,r.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,o){let n=[],i,a,c,u=this.tableMeta.maxRows,m=this.tableMeta.maxCols;if(u===0||m===0)return[];let g=o===r.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,C=Math.min(Math.max(u-1,0),Math.max(e.row,t.row)),v=Math.min(Math.max(m-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=C;i++){c=[];let y=i>=0?this.hot.toPhysicalRow(i):i;for(a=Math.min(e.col,t.col);a<=v&&y!==null;a++)c.push(g.call(this,i,this.colToProp(a)));y!==null&&n.push(c)}return n}getText(e,t){return Gd(this.getRange(e,t,r.DESTINATION_RENDERER))}getCopyableText(e,t){return Gd(this.getRange(e,t,r.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},JE=ow;var nZ=S(V(),1);var TQ=S(V(),1);var uQ=S(V(),1),dQ=S(tr(),1),hQ=S(rr(),1),fQ=S(or(),1),mQ=S(ir(),1),pQ=S(nr(),1),gQ=S(sr(),1),wQ=S(ar(),1);var rQ=S(V(),1);var{register:cB,getItem:uB,hasItem:dB,getNames:aQ,getValues:lQ}=Lr("cellTypes");function e0(r){if(!dB(r))throw Error(`You declared cell type "${r}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return uB(r)}function t0(r,e){typeof r!="string"&&(e=r,r=e.CELL_TYPE);let{editor:t,renderer:o,validator:n}=e;t&&Cm(r,t),o&&vx(r,o),n&&Sx(r,n),cB(r,e)}function hB(r,e){var t;return r==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(r))||!Do(e,r)}function Ji(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r,o=typeof e.type=="string"?e0(e.type):e.type;if(r._automaticallyAssignedMetaProps&&be(e,(i,a)=>void r._automaticallyAssignedMetaProps.delete(a)),!qt(o))return;t===r&&!r._automaticallyAssignedMetaProps&&(r._automaticallyAssignedMetaProps=new Set);let n={};be(o,(i,a)=>{if(hB(a,t)){var c;n[a]=i,(c=r._automaticallyAssignedMetaProps)===null||c===void 0||c.add(a)}}),go(r,n)}function r0(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}vT(t,r);for(let o=0;o<e.length;o++)t.prototype[e[o]]=void 0;return t}function Ks(r){return Number.isInteger(r)&&r>=0}function Xs(r,e){if(!r())throw new Error(`Assertion failed: ${e}`)}function zl(r){return r==null}var Yl=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(r){let e,t,o;for(e=0,t=this.countRows();e<t;e++)if(o=this.getDataAtCell(e,r),ai(o)===!1)return!1;return!0},isEmptyRow(r){let e,t,o,n;for(e=0,t=this.countCols();e<t;e++)if(o=this.getDataAtCell(r,e),ai(o)===!1)return typeof o=="object"?(n=this.getCellMeta(r,e),pu(this.getSchema()[n.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function o0(r,e,t){return(e=fB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function fB(r){var e=mB(r,"string");return typeof e=="symbol"?e:e+""}function mB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function pB(){return class{}}var $d=class{constructor(e){o0(this,"metaCtor",pB()),o0(this,"meta",void 0),this.meta=this.metaCtor.prototype,go(this.meta,Yl()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;go(this.meta,e),Ji(this.meta,je(pe({},e),{type:(t=e.type)!==null&&t!==void 0?t:this.meta.type}),e)}};var HQ=S(V(),1);function gB(r,e,t){return(e=wB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function wB(r){var e=bB(r,"string");return typeof e=="symbol"?e:e+""}function bB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Kd=class{constructor(e){gB(this,"meta",void 0);let t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){go(this.meta,e),Ji(this.meta,e,e)}};var GQ=S(V(),1);var PQ=S(V(),1),DQ=S(me(),1),LQ=S(tr(),1),FQ=S(rr(),1),VQ=S(or(),1),WQ=S(ir(),1),BQ=S(nr(),1),UQ=S(sr(),1),jQ=S(ar(),1);function Xd(r,e,t){return(e=CB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function CB(r){var e=vB(r,"string");return typeof e=="symbol"?e:e+""}function vB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var en=class{constructor(e){Xd(this,"valueFactory",void 0),Xd(this,"data",[]),Xd(this,"index",[]),Xd(this,"holes",new Set),this.valueFactory=e}obtain(e){Xs(()=>Ks(e),"Expecting an unsigned number.");let t=this._getStorageIndexByKey(e),o;if(t>=0)o=this.data[t],o===void 0&&(o=this.valueFactory(e),this.data[t]=o);else if(o=this.valueFactory(e),this.holes.size>0){let n=this.holes.values().next().value;this.holes.delete(n),this.data[n]=o,this.index[e]=n}else this.data.push(o),this.index[e]=this.data.length-1;return o}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xs(()=>Ks(e)||zl(e),"Expecting an unsigned number or null/undefined argument.");let o=[],n=this.data.length;for(let a=0;a<t;a++)o.push(n+a),this.data.push(void 0);let i=zl(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...o,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xs(()=>Ks(e)||zl(e),"Expecting an unsigned number or null/undefined argument.");let o=this.index.splice(zl(e)?this.index.length-t:e,t);for(let n=0;n<o.length;n++){let i=o[n];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return bs(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){let e=[];for(let o=0;o<this.data.length;o++){let n=this._getKeyByStorageIndex(o);n!==-1&&e.push([n,this.data[o]])}let t=0;return{next:()=>{if(t<e.length){let o=e[t];return t+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}};function i0(r,e,t){return(e=yB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function yB(r){var e=SB(r,"string");return typeof e=="symbol"?e:e+""}function SB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var RB=["data","width"],Qd=class{constructor(e){i0(this,"globalMeta",void 0),i0(this,"metas",new en(()=>this._createMeta())),this.globalMeta=e,this.metas=new en(()=>this._createMeta())}updateMeta(e,t){let o=this.getMeta(e);go(o,t),Ji(o,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return r0(this.globalMeta.getMetaConstructor(),RB).prototype}};var ZQ=S(V(),1),JQ=S(me(),1);function n0(r,e,t){return(e=TB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function TB(r){var e=xB(r,"string");return typeof e=="symbol"?e:e+""}function xB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Zd=class{constructor(e){n0(this,"columnMeta",void 0),n0(this,"metas",new en(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,o){let n=this.getMeta(e,t);go(n,o),Ji(n,o)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(e,t)}getMeta(e,t,o){let n=this.metas.obtain(e).obtain(t);return o===void 0?n:n[o]}setMeta(e,t,o,n){var i;let a=this.metas.obtain(e).obtain(t);(i=a._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(o),a[o]=n}removeMeta(e,t,o){let n=this.metas.obtain(e).obtain(t);delete n[o]}getMetas(){let e=[],t=Array.from(this.metas.values());for(let o=0;o<t.length;o++)oe(t[o])&&e.push(...t[o].values());return e}getMetasAtRow(e){Xs(()=>Ks(e),"Expecting an unsigned number.");let t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new en(e=>this._createMeta(e))}_createMeta(e){let t=this.columnMeta.getMetaConstructor(e);return new t}};var Qs=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new $d(e),this.tableMeta=new Kd(this.globalMeta),this.columnMeta=new Qd(this.globalMeta),this.cellMeta=new Zd(this.columnMeta),o.forEach(n=>new n(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,o){let{visualRow:n,visualColumn:i}=o,a=this.cellMeta.getMeta(e,t);return a.visualRow=n,a.visualCol=i,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,o)}setCellMeta(e,t,o,n){this.cellMeta.setMeta(e,t,o,n)}updateCellMeta(e,t,o){this.cellMeta.updateMeta(e,t,o)}removeCellMeta(e,t,o){this.cellMeta.removeMeta(e,t,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};Te(Qs,dr);var fZ=S(V(),1),mZ=S(me(),1);function Jd(r,e,t,o){let{hotInstance:n,dataMap:i,dataSource:a,internalSource:c,source:u,metaManager:m,firstRun:g}=o,C=Cs(c),v=n.getSettings();Array.isArray(v.dataSchema)?n.dataType="array":Re(v.dataSchema)?n.dataType="function":n.dataType="object",i&&i.destroy(),r=n.runHooks(`before${C}`,r,g,u);let y=new JE(n,r,m);if(e(y),typeof r=="object"&&r!==null)r.push&&r.splice||(r=[r]);else if(r===null){let R=y.getSchema();r=[];let O,N=0,I=0;for(N=0,I=v.startRows;N<I;N++)if((n.dataType==="object"||n.dataType==="function")&&v.dataSchema)O=jr(R),r.push(O);else if(n.dataType==="array")O=jr(R[0]),r.push(O);else{O=[];for(let j=0,ie=v.startCols;j<ie;j++)O.push(null);r.push(O)}}else throw new Error(`${c} only accepts array of objects or array of arrays (${typeof r} given)`);Array.isArray(r[0])&&(n.dataType="array"),v.data=r,y.dataSource=r,a.data=r,a.dataType=n.dataType,a.colToProp=y.colToProp.bind(y),a.propToCol=y.propToCol.bind(y),a.countCachedColumns=y.countCachedColumns.bind(y),t(y),n.runHooks(`after${C}`,r,g,u),g||(n.runHooks("afterChange",null,c),n.render()),n.getSettings().ariaTags&&Se(n.rootElement,[au(-1),vs(n.countCols()+(n.view?n.countRowHeaders():0))])}var SZ=S(V(),1),RZ=S(tr(),1),TZ=S(rr(),1),xZ=S(or(),1),EZ=S(ir(),1),_Z=S(nr(),1),OZ=S(sr(),1),MZ=S(ar(),1);function s0(r,e,t){return(e=EB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function EB(r){var e=_B(r,"string");return typeof e=="symbol"?e:e+""}function _B(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ql=class{constructor(e){s0(this,"metaManager",void 0),s0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Gt.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;let{row:o,col:n}=e;if((t=this.metaSyncMemo.get(o))!==null&&t!==void 0&&t.has(n))return;let{visualRow:i,visualCol:a}=e,c=this.metaManager.hot,u=c.colToProp(a);e.prop=u,c.runHooks("beforeGetCellMeta",i,a,e);let m=Do(e,"type")?e.type:null,g=Re(e.cells)?e.cells(o,n,u):null;if(m)if(g){var C;g.type=(C=g.type)!==null&&C!==void 0?C:m}else g={type:m};g&&this.metaManager.updateCellMeta(o,n,g),c.runHooks("afterGetCellMeta",i,a,e),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}};var kZ=S(V(),1),PZ=S(me(),1),DZ=S(tr(),1),LZ=S(rr(),1),FZ=S(or(),1),VZ=S(ir(),1),WZ=S(nr(),1),BZ=S(sr(),1),UZ=S(ar(),1);function OB(r,e,t){MB(r,e),e.set(r,t)}function MB(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iw(r,e,t){return(e=IB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function IB(r){var e=HB(r,"string");return typeof e=="symbol"?e:e+""}function HB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function AB(r,e){return r.get(NB(r,e))}function NB(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var a0=new WeakMap,Gl=class{constructor(e){iw(this,"metaManager",void 0),iw(this,"usageTracker",new Set),iw(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),OB(this,a0,(t,o,n)=>{if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{let{initOnly:o,target:n,onChange:i}=e,a=typeof n=="string",c=a?n:t,u=`_${c}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[c],i?(this.installPropWatcher(t,u,i),a&&this.installPropWatcher(n,u,i)):o&&(this.installPropWatcher(t,u,AB(a0,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,o){let n=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){let a=!n.usageTracker.has(e);n.usageTracker.add(e),o.call(n,e,i,a),this[t]=i},enumerable:!0,configurable:!0})}};var eh="gridDefault",th="editorManager.handlingEditor";var l0={name:"editorCloseAndSave",callback(r){r._getEditorManager().closeEditorAndSaveChanges()}};var rJ=S(V(),1);var ZZ=S(me(),1);var kB="hooksRefRegisterer",c0={_hooksStorage:Object.create(null),addHook(r,e){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,e),this._hooksStorage[r].push(e),this},removeHooksByKey(r){re(this._hooksStorage[r]||[],e=>{this.hot.removeHook(r,e)})},clearHooks(){be(this._hooksStorage,(r,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};lr(c0,"MIXIN_NAME",kB,{writable:!1,enumerable:!1});var u0=c0;function Oo(r,e,t){return(e=PB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function PB(r){var e=DB(r,"string");return typeof e=="symbol"?e:e+""}function DB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var d0="base",st=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),tn=class{static get EDITOR_TYPE(){return d0}constructor(e){Oo(this,"hot",void 0),Oo(this,"state",st.VIRGIN),Oo(this,"_opened",!1),Oo(this,"_fullEditMode",!1),Oo(this,"_closeCallback",null),Oo(this,"TD",null),Oo(this,"row",null),Oo(this,"col",null),Oo(this,"prop",null),Oo(this,"originalValue",null),Oo(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,o,n,i,a){this.TD=n,this.row=e,this.col=t,this.prop=o,this.originalValue=i,this.cellProperties=a,this.state=this.isOpened()?this.state:st.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let o,n,i,a;if(t){let u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),n=Math.max(Math.min(u[1],u[3]),0),i=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[o,n,i,a]=[this.row,this.col,null,null];let c=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(c)&&([o,n]=c),this.hot.populateFromArray(o,n,e,i,a,"edit")}beginEditing(e,t){if(this.state!==st.VIRGIN)return;let o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,i)),this.state=st.EDITING,this.isInFullEditMode()){let a=typeof e=="string"?e:ou(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,o){let n;if(o){let i=this._closeCallback;this._closeCallback=a=>{i&&i(a),o(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===st.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===st.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();this.cellProperties.trimWhitespace?n=[[typeof i=="string"?String.prototype.trim.call(i||""):i]]:n=[[i]],this.state=st.WAITING,this.saveValue(n,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=st.FINISHED,this.discardEditor(a)}):(this.state=st.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=st.FINISHED,this.discardEditor()}discardEditor(e){this.state===st.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=st.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=st.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===st.WAITING}getEditedCellRect(){var e;let t=this.getEditedCell();if(!t)return;let{wtOverlays:o,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,a=Yt(t),c=Ke(t),u=Yt(this.hot.rootElement),m=Ke(this.hot.rootElement),g=o.topOverlay.holder,C=o.inlineStartOverlay.holder,v=g!==i?g.scrollTop:0,y=C!==i?C.scrollLeft:0,R=i.innerWidth-u.left-m,{wtTable:O}=(e=o.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,N=O.name,I=["master","inline_start"].includes(N)?v:0,j=["master","top","bottom"].includes(N)?y:0,ie=a.top===u.top?0:1,ue=a.top-u.top-ie-I,de=0;this.hot.isRtl()?de=i.innerWidth-a.left-c-R-1+j:de=a.left-u.left-1-j,["top","top_inline_start_corner"].includes(N)&&(ue+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(N)&&(de+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));let J=this.hot.hasColHeaders(),te=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),rt=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(J&&te<=0||te===rt)&&(ue+=1),q<=0&&(de+=1);let Ne=n.rowsRenderCalculator.startPosition,Kt=n.columnsRenderCalculator.startPosition,Ir=Math.abs(o.inlineStartOverlay.getScrollPosition()),Me=o.topOverlay.getScrollPosition(),At=Xe(this.hot.rootDocument),Ge=t.offsetTop;if(["inline_start","master"].includes(N)&&(Ge+=Ne-Me),["bottom","bottom_inline_start_corner"].includes(N)){let{wtViewport:L,wtTable:K}=o.bottomOverlay.clone;Ge+=L.getWorkspaceHeight()-K.getHeight()-At}let Bt=t.offsetLeft;this.hot.isRtl()?(Bt>=0?Bt=O.getWidth()-t.offsetLeft:Bt=Math.abs(Bt),Bt+=Kt-Ir-c):["top","master","bottom"].includes(N)&&(Bt+=Kt-Ir);let F=Ur(this.TD,this.hot.rootWindow),ae=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Nt=parseInt(F[ae],10)>0?0:1,f=parseInt(F.borderTopWidth,10)>0?0:1,p=Ke(t)+Nt,w=Rt(t)+f,E=ZR(g)?At:0,_=JR(C)?At:0,M=this.hot.view.maximumVisibleElementWidth(Bt)-E+Nt,P=Math.max(this.hot.view.maximumVisibleElementHeight(Ge)-_+f,23);return{top:ue,start:de,height:w,maxHeight:P,width:p,maxWidth:M}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}};Te(tn,u0);var h0={name:"editorCloseAndSaveByArrowKeys",callback(r,e,t){let o=r._getEditorManager(),n=o.getActiveEditor();n.isInFullEditMode()&&n.state===st.EDITING||(o.closeEditorAndSaveChanges(),r.getSelected()&&(t.includes("arrowdown")?r.selection.transformStart(1,0):t.includes("arrowup")?r.selection.transformStart(-1,0):t.includes("arrowleft")?r.selection.transformStart(0,-1*r.getDirectionFactor()):t.includes("arrowright")&&r.selection.transformStart(0,r.getDirectionFactor())),e.preventDefault())}};var f0={name:"editorCloseAndSaveByEnter",callback(r,e){let t=r._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}};var m0={name:"editorCloseWithoutSaving",callback(r){let e=r._getEditorManager();e.closeEditorAndRestoreOriginalValue(r.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}};var p0={name:"editorFastOpen",callback(r,e){let{highlight:t}=r.getSelectedRangeLast();t.isHeader()||r._getEditorManager().openEditor(null,e,!0)}};var g0={name:"editorOpen",callback(r,e,t){let o=r._getEditorManager(),n=r.getSelectedRangeLast(),{highlight:i}=n;if(r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0){let a=r.getSettings(),c=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;t.includes("shift")?r.selection.transformFocus(-c.row,-c.col):r.selection.transformFocus(c.row,c.col);return}i.isHeader()||(r.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter(e):o.openEditor(null,e,!0):o.moveSelectionAfterEnter(e),zi(e))}};function w0(){return[l0,h0,f0,m0,p0,g0]}var b0={name:"extendCellsSelectionDown",callback(r){let{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(1,0)}};var C0={name:"extendCellsSelectionDownByViewportHeight",callback(r){let{to:e}=r.getSelectedRangeLast(),t=Math.min(e.row+r.countVisibleRows(),r.countRows()-1),o=r.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(o!==null){let n=r._createCellCoords(o,e.col),i=e.row-r.view.getFirstFullyVisibleRow(),a=Math.min(n.row-i,r.countRows()-1);r.selection.setRangeEnd(n),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};var v0={name:"extendCellsSelectionLeft",callback(r){let{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,-1*r.getDirectionFactor())}};var y0={name:"extendCellsSelectionRight",callback(r){let{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,r.getDirectionFactor())}};var S0={name:"extendCellsSelectionToColumns",callback(r){let{highlight:e,from:t,to:o}=r.getSelectedRangeLast();r.selection.isSelectedByRowHeader()?r.selection.selectAll(!0,!0):r.selectColumns(t.col,o.col,e)}};var R0={name:"extendCellsSelectionToMostBottom",callback(r){let{selection:e,rowIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast(),a=o.isHeader()&&r.selection.isSelectedByRowHeader();if(o.isCell()||a){let c=t.getNearestNotHiddenIndex(r.countRows()-1,-1),u=n.clone();u.row=o.row,e.setRangeStart(u,void 0,!1,o.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(c,i.col))}}};var T0={name:"extendCellsSelectionToMostInlineEnd",callback(r){let{selection:e,columnIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&o.isCell()){let a=t.getNearestNotHiddenIndex(r.countCols()-1,-1),c=n.clone();c.col=o.col,e.setRangeStart(c,void 0,!1,o.clone()),e.setRangeEnd(r._createCellCoords(i.row,a))}}};var x0={name:"extendCellsSelectionToMostInlineStart",callback(r){let{selection:e,columnIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&o.isCell()){let a=parseInt(r.getSettings().fixedColumnsStart,10),c=t.getNearestNotHiddenIndex(a,1),u=n.clone();u.col=o.col,e.setRangeStart(u,void 0,!1,o.clone()),e.setRangeEnd(r._createCellCoords(i.row,c))}}};var E0={name:"extendCellsSelectionToMostLeft",callback(r){let{selection:e,columnIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast(),a=o.isHeader()&&r.selection.isSelectedByColumnHeader();if(o.isCell()||a){let c=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]),u=n.clone();u.col=o.col,e.setRangeStart(u,void 0,!1,o.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(i.row,c))}}};var _0={name:"extendCellsSelectionToMostRight",callback(r){let{selection:e,columnIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast(),a=o.isHeader()&&r.selection.isSelectedByColumnHeader();if(o.isCell()||a){let c=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]),u=n.clone();u.col=o.col,e.setRangeStart(u,void 0,!1,o.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(i.row,c))}}};var O0={name:"extendCellsSelectionToMostTop",callback(r){let{selection:e,rowIndexMapper:t}=r,{highlight:o,from:n,to:i}=r.getSelectedRangeLast(),a=o.isHeader()&&r.selection.isSelectedByRowHeader();if(o.isCell()||a){let c=t.getNearestNotHiddenIndex(0,1),u=n.clone();u.row=o.row,e.setRangeStart(u,void 0,!1,o.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(c,i.col))}}};var M0={name:"extendCellsSelectionToRows",callback(r){let{highlight:e,from:t,to:o}=r.getSelectedRangeLast();r.selection.isSelectedByColumnHeader()?r.selection.selectAll(!0,!0):r.selectRows(t.row,o.row,e)}};var I0={name:"extendCellsSelectionUp",callback(r){let{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(-1,0)}};var H0={name:"extendCellsSelectionUpByViewportHeight",callback(r){let{to:e}=r.getSelectedRangeLast(),t=Math.max(e.row-r.countVisibleRows(),0),o=r.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(o!==null){let n=r._createCellCoords(o,e.col),i=e.row-r.view.getFirstFullyVisibleRow(),a=Math.max(n.row-i,0);r.selection.setRangeEnd(n),r.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};function A0(){return[b0,C0,v0,y0,S0,R0,T0,x0,E0,_0,O0,M0,I0,H0]}var N0={name:"moveCellSelectionDown",callback(r){let{selection:e}=r;e.transformStart(1,0)}};var k0={name:"moveCellSelectionDownByViewportHeight",callback(r){let{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:o}=r.getSelectedRangeLast().highlight,n=r.countVisibleRows()+t;o===r.countRows()-1?n=1:o+n>r.countRows()&&(n=r.countRows()-o-1),r.selection.transformStart(n,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}};var P0={name:"moveCellSelectionInlineEnd",callback(r,e){let t=r.getSettings(),o=r.getSelectedRangeLast(),n=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!o.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(-n.row,-n.col):r.selection.transformStart(-n.row,-n.col)}};var D0={name:"moveCellSelectionInlineStart",callback(r,e){let t=r.getSettings(),o=r.getSelectedRangeLast(),n=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!o.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(n.row,n.col):r.selection.transformStart(n.row,n.col)}};var L0={name:"moveCellSelectionLeft",callback(r){r.selection.transformStart(0,-1*r.getDirectionFactor())}};var F0={name:"moveCellSelectionRight",callback(r){r.selection.transformStart(0,r.getDirectionFactor())}};var V0={name:"moveCellSelectionToMostBottom",callback(r){let{col:e}=r.getSelectedRangeLast().highlight,t=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);t===null&&(t=-1),r.selection.setRangeStart(r._createCellCoords(t,e))}};var W0={name:"moveCellSelectionToMostBottomInlineEnd",callback(r){let{selection:e,rowIndexMapper:t,columnIndexMapper:o}=r,n=parseInt(r.getSettings().fixedRowsBottom,10),i=t.getNearestNotHiddenIndex(r.countRows()-n-1,-1),a=o.getNearestNotHiddenIndex(r.countCols()-1,-1);e.setRangeStart(r._createCellCoords(i,a))}};var B0={name:"moveCellSelectionToMostInlineEnd",callback(r){let{selection:e,columnIndexMapper:t}=r;e.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(r.countCols()-1,-1)))}};var U0={name:"moveCellSelectionToMostInlineStart",callback(r){let{selection:e,columnIndexMapper:t}=r,o=parseInt(r.getSettings().fixedColumnsStart,10),n=r.getSelectedRangeLast().highlight.row,i=t.getNearestNotHiddenIndex(o,1);e.setRangeStart(r._createCellCoords(n,i))}};var j0={name:"moveCellSelectionToMostLeft",callback(r){let{selection:e,columnIndexMapper:t}=r,o=r.getSelectedRangeLast().highlight.row,n=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);n===null&&(n=r.isRtl()?-1:-r.countRowHeaders()),e.setRangeStart(r._createCellCoords(o,n))}};var z0={name:"moveCellSelectionToMostRight",callback(r){let{selection:e,columnIndexMapper:t}=r,{row:o}=r.getSelectedRangeLast().highlight,n=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);n===null&&(n=r.isRtl()?-r.countRowHeaders():-1),e.setRangeStart(r._createCellCoords(o,n))}};var Y0={name:"moveCellSelectionToMostTop",callback(r){let{col:e}=r.getSelectedRangeLast().highlight,t=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-r.countColHeaders()),r.selection.setRangeStart(r._createCellCoords(t,e))}};var q0={name:"moveCellSelectionToMostTopInlineStart",callback(r){let{selection:e,rowIndexMapper:t,columnIndexMapper:o}=r,n=parseInt(r.getSettings().fixedRowsTop,10),i=parseInt(r.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(n,1),c=o.getNearestNotHiddenIndex(i,1);e.setRangeStart(r._createCellCoords(a,c))}};var G0={name:"moveCellSelectionUp",callback(r){let{selection:e}=r;e.transformStart(-1,0)}};var $0={name:"moveCellSelectionUpByViewportHight",callback(r){let{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:o}=r.getSelectedRangeLast().highlight,n=-(r.countVisibleRows()+t);o===-t?n=-1:o+n<t&&(n=-(o+t)),r.selection.transformStart(n,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}};function K0(){return[N0,k0,P0,D0,L0,F0,V0,W0,B0,U0,j0,z0,Y0,q0,G0,$0]}var X0={name:"emptySelectedCells",callback(r){r.emptySelectedCells(),r._getEditorManager().prepareEditor()}};var Q0={name:"scrollToFocusedCell",callback(r){let{highlight:e}=r.getSelectedRangeLast(),t=r.view.getFirstFullyVisibleRow()-1,o=r.view.getFirstFullyVisibleColumn()-1,n=r.view.getLastFullyVisibleRow()+1,i=r.view.getLastFullyVisibleColumn()+1,a=r._createCellCoords(t,o),c=r._createCellCoords(n,i);if(!r._createCellRange(a,a,c).includes(e)&&(e.row>=0||e.col>=0)){let m={};if(e.col>=0){let g=Math.floor(r.countVisibleCols()/2);m.col=Math.max(e.col-g,0)}if(e.row>=0){let g=Math.floor(r.countVisibleRows()/2);m.row=Math.max(e.row-g,0)}r.scrollViewportTo(je(pe({},m),{verticalSnap:"top",horizontalSnap:"start"}))}}};var Z0={name:"selectAllCells",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}};var J0={name:"selectAllCellsAndHeaders",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}};var e_={name:"populateSelectedCellsData",callback(r){let e=r.getSelectedRange(),{row:t,col:o}=e[e.length-1].highlight.normalize(),n=r.getDataAtCell(t,o),i=new Map;for(let a=0;a<e.length;a++)e[a].forAll((c,u)=>{if(c>=0&&u>=0&&(c!==t||u!==o)){let{readOnly:m}=r.getCellMeta(c,u);m||i.set(`${c}x${u}`,[c,u,n])}});r.setDataAtCell(Array.from(i.values()))}};var LB=[...w0(),...A0(),...K0(),X0,Q0,Z0,J0,e_];function rh(r){let e={};return LB.forEach(t=>{let{name:o,callback:n}=t;e[o]=function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return n(r,...a)}}),e}function t_(r){let e=r.getShortcutManager().addContext("editor"),t=rh(r),o={group:th};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(n,i)=>t.editorCloseAndSaveByEnter(n,i)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(n,i)=>t.editorCloseAndSaveByEnter(n,i)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:r.getShortcutManager().getContext("grid"),callback:(n,i)=>t.editorCloseAndSave(n,i)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(n,i)=>t.editorCloseAndSaveByArrowKeys(n,i)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],o)}function r_(r){let e=r.getShortcutManager().addContext("grid"),t=rh(r),o={runOnlyIf:()=>{let{navigableHeaders:n}=r.getSettings();return oe(r.getSelected())&&(n||!n&&r.countRenderedRows()>0&&r.countRenderedCols()>0)},group:eh};e.addShortcuts([{keys:[["F2"]],callback:n=>t.editorFastOpen(n)},{keys:[["Enter"],["Enter","Shift"]],callback:(n,i)=>t.editorOpen(n,i)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:th,runOnlyIf:()=>oe(r.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var n;return!((n=r.getSelectedRangeLast())!==null&&n!==void 0&&n.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var n;return(n=r.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var n,i;return!((n=r.getSelectedRangeLast())!==null&&n!==void 0&&n.highlight.isHeader())&&((i=r.getSelectedRangeLast())===null||i===void 0?void 0:i.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:n=>t.moveCellSelectionInlineStart(n)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:n=>t.moveCellSelectionInlineEnd(n)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],o)}function o_(r){[r_,t_].forEach(e=>e(r))}function n_(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.rootElement,o=i_(r),n=i_(r);return o.addEventListener("focus",()=>e?.onFocusFromTop()),n.addEventListener("focus",()=>e?.onFocusFromBottom()),t.firstChild.before(o),t.lastChild.after(n),{activate(){r._registerTimeout(()=>{o.tabIndex=0,n.tabIndex=0},10)},deactivate(){r._registerTimeout(()=>{o.tabIndex=-1,n.tabIndex=-1},10)}}}function i_(r){let t=r.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),r.getSettings().ariaTags&&Se(t,[Pr(),su()]),t}function s_(r){let e=FB(r),t,{activate:o,deactivate:n}=n_(r,{onFocusFromTop(){var C;let v=(C=e(t))!==null&&C!==void 0?C:nw(r);v&&(r.runHooks("modifyFocusOnTabNavigation","from_above",v),r.selectCell(v.row,v.col)),r.listen()},onFocusFromBottom(){var C;let v=(C=e(t))!==null&&C!==void 0?C:sw(r);v&&(r.runHooks("modifyFocusOnTabNavigation","from_below",v),r.selectCell(v.row,v.col)),r.listen()}}),i={wrapped:!1,flipped:!1},a=!0,c=!1,u=!1;r.addHook("afterListen",()=>n()),r.addHook("afterUnlisten",()=>o()),r.addHook("afterSelection",(C,v,y,R,O)=>{if(c&&(i.wrapped&&i.flipped||u)&&(u=!1,O.value=!0),a){var N;t=(N=r.getSelectedRangeLast())===null||N===void 0?void 0:N.highlight}}),r.addHook("beforeRowWrap",(C,v,y)=>{i.wrapped=!0,i.flipped=y});function m(){i.wrapped=!1,i.flipped=!1,r.deselectCell(),r.unlisten()}let g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:eh,group:"focusCatcher"};r.getShortcutManager().getContext("grid").addShortcuts([je(pe({},g),{callback:()=>{let{tabNavigation:C}=r.getSettings();c=!0,r.getSelectedRangeLast()&&!C&&(a=!1),C||(u=!0)},position:"before"}),je(pe({},g),{callback:C=>{let{tabNavigation:v,autoWrapRow:y}=r.getSettings();if(c=!1,a=!0,!v||!r.selection.isSelected()||y&&i.wrapped&&i.flipped||!y&&i.wrapped)return y&&i.wrapped&&i.flipped&&(t=C.shiftKey?nw(r):sw(r)),m(),!1;C.preventDefault()},position:"after"})])}function nw(r){let{rowIndexMapper:e,columnIndexMapper:t}=r,{navigableHeaders:o}=r.getSettings(),n=o&&r.countColHeaders()>0?-r.countColHeaders():0,i=o&&r.countRowHeaders()>0?-r.countRowHeaders():0;return n===0&&(n=e.getVisualFromRenderableIndex(n)),i===0&&(i=t.getVisualFromRenderableIndex(i)),n===null||i===null?null:r._createCellCoords(n,i)}function sw(r){var e,t;let{rowIndexMapper:o,columnIndexMapper:n}=r,{navigableHeaders:i}=r.getSettings(),a=o.getRenderableIndexesLength()-1,c=n.getRenderableIndexesLength()-1;if(a<0){if(!i||r.countColHeaders()===0)return null;a=-1}if(c<0){if(!i||r.countColHeaders()===0)return null;c=-1}return r._createCellCoords((e=o.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(t=n.getVisualFromRenderableIndex(c))!==null&&t!==void 0?t:c)}function FB(r){return e=>{if(!e)return null;let t=nw(r),o=sw(r);return e.col<t.col&&(e.col=t.col),e.col>o.col&&(e.col=o.col),e.row<t.row&&(e.row=t.row),e.row>o.row&&(e.row=o.row),e}}function a_(r){return e=>{let{col:t}=e;r.scrollViewportTo({col:t})}}function l_(){return()=>{}}function c_(r){return e=>{r.scrollViewportTo(e.toObject())}}function u_(r){return e=>{r.scrollViewportTo(e.toObject())}}function d_(r){return e=>{r.scrollViewportTo(e.toObject())}}function h_(r){return e=>{let{row:t}=e;r.scrollViewportTo({row:t})}}function f_(r){return e=>{let t=r.selection.getSelectionSource(),{row:o,col:n}=e;if(o<0&&n>=0)r.scrollViewportTo({col:n});else if(n<0&&o>=0)r.scrollViewportTo({row:o});else{if(t==="mouse"&&(n===r.view.getLastPartiallyVisibleColumn()||o===r.view.getLastPartiallyVisibleRow()))return;r.scrollViewportTo({row:o,col:n})}}}function m_(r){let{selection:e}=r,t=!1,o=!1;return{resume(){o=!1},suspend(){o=!0},skipNextScrollCycle(){t=!0},scrollTo(n){var i;if(t||o){t=!1;return}let a;e.isFocusSelectionChanged()?a=c_(r):e.isSelectedByCorner()?a=l_(r):e.isSelectedByRowHeader()?a=h_(r):e.isSelectedByColumnHeader()?a=a_(r):e.getSelectedRange().size()===1&&e.isMultiple()?a=u_(r):e.getSelectedRange().size()===1&&!e.isMultiple()?a=f_(r):e.getSelectedRange().size()>1&&(a=d_(r)),(i=a)===null||i===void 0||i(n)}}}var Zte=S(V(),1);var Ote=S(V(),1),Mte=S(me(),1);var p_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),$l=r=>r.map(e=>{let t=e.toLowerCase();return p_.has(t)?p_.get(t):t}).sort().join("+"),w_=r=>r.split("+"),g_=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),oh=r=>{let{which:e,key:t}=r;if(g_.has(e))return g_.get(e);let o=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(o)?o:t.toLowerCase()};var b_=Symbol("shortcut-context");function aw(r){return qt(r)&&r.__kindOf===b_}var C_=r=>{let e=qi({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${r}" context.`}),t=function(){let{keys:u,callback:m,group:g,runOnlyIf:C=()=>!0,captureCtrl:v=!1,preventDefault:y=!0,stopPropagation:R=!1,relativeToGroup:O,position:N,forwardToContext:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(pt(g))throw new Error("You need to define the shortcut's group.");if(Re(m)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(mt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let j={callback:m,group:g,runOnlyIf:C,captureCtrl:v,preventDefault:y,stopPropagation:R};oe(O)&&(j.relativeToGroup=O,j.position=N),aw(I)&&(j.forwardToContext=I),u.forEach(ie=>{let ue=$l(ie);if(e.hasItem(ue)){let J=e.getItem(ue),te=J.findIndex(q=>q.group===O);te!==-1?N==="before"?te-=1:te+=1:te=J.length,J.splice(te,0,j)}else e.addItem(ue,[j])})},o=function(u){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(g=>{be(m,(C,v)=>{Object.prototype.hasOwnProperty.call(g,v)===!1&&(g[v]=m[v])}),t(g)})},n=u=>{let m=$l(u);e.removeItem(m)};return{__kindOf:b_,addShortcut:t,addShortcuts:o,getShortcuts:u=>{let m=$l(u),g=e.getItem(m);return oe(g)?g.slice():[]},hasShortcut:u=>{let m=$l(u);return e.hasItem(m)},removeShortcutsByKeys:n,removeShortcutsByGroup:u=>{e.getItems().forEach(g=>{let[C,v]=g,y=v.filter(R=>R.group!==u);y.length===0?n(w_(C)):(v.length=0,v.push(...y))})}}};var Yte=S(me(),1);var Lte=S(tr(),1),Fte=S(rr(),1),Vte=S(or(),1),Wte=S(ir(),1),Bte=S(nr(),1),Ute=S(sr(),1),jte=S(ar(),1);function v_(){let r=new Set;return{press(e){r.add(e)},release(e){r.delete(e)},releaseAll(){r.clear()},isPressed(e){return r.has(e)}}}var VB=["meta","alt","shift","control"],Kl=v_(),Xl=[],ih=0;function y_(r,e,t,o,n){let i=y=>VB.includes(y),a=function(y){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=[];return y.altKey&&O.push("alt"),R&&(y.ctrlKey||y.metaKey)?O.push("control/meta"):(y.ctrlKey&&O.push("control"),y.metaKey&&O.push("meta")),y.shiftKey&&O.push("shift"),O},c=y=>{if(e(y)===!1)return;let R=t(y);if(y.keyCode===229||R===!1||Lo(y))return;let O=oh(y),N=[];i(O)||(N=a(y));let I=[O].concat(N);!n(y,I)&&(vu()&&N.includes("meta")||!vu()&&N.includes("control"))&&n(y,[O].concat(a(y,!0))),o(y)},u=y=>{if(y.key){let R=oh(y);i(R)&&Kl.press(R)}},m=y=>{if(y.key){let R=oh(y);i(R)&&Kl.release(R)}},g=()=>{Kl.releaseAll()};return{mount:()=>{let y=r;for(ih+=1;y;)ih===1&&(y.document.documentElement.addEventListener("keydown",u),Xl.push({event:"keydown",listener:u}),y.document.documentElement.addEventListener("keyup",m),Xl.push({event:"keyup",listener:m})),y.document.documentElement.addEventListener("keydown",c),y.document.documentElement.addEventListener("blur",g),y=Ss(y)},unmount:()=>{let y=r;for(ih-=1;y;){if(ih===0){for(let R=0;R<Xl.length;R++){let{event:O,listener:N}=Xl[R];y.document.documentElement.removeEventListener(O,N)}Xl.length=0}y.document.documentElement.removeEventListener("keydown",c),y.document.documentElement.removeEventListener("blur",g),y=Ss(y)}},isPressed:y=>Kl.isPressed(y),releasePressedKeys:()=>Kl.releaseAll()}}var lw=r=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:o,afterKeyDown:n}=r,i=qi({errorIdExists:R=>`The "${R}" context name is already registered.`}),a="grid",c=R=>{let O=C_(R);return i.addItem(R,O),O},u=()=>a,m=R=>i.getItem(R),g=R=>{if(!i.hasItem(R))throw new Error(mt`You've tried to activate the "${R}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=R},C=!1,v=function(R,O){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u(),I=aw(N)?N:m(N),j=!1;if(!I.hasShortcut(O))return j;let ie=I.getShortcuts(O);for(let ue=0;ue<ie.length;ue++){let{callback:de,runOnlyIf:J,preventDefault:te,stopPropagation:q,captureCtrl:at,forwardToContext:rt}=ie[ue];if(J(R)===!0){if(C=at,j=de(R,O)===!1,C=!1,te&&R.preventDefault(),q&&(zi(R),R.stopPropagation()),j)break;rt&&v(R,O,rt)}}return j},y=y_(e,t,o,n,v);return y.mount(),{addContext:c,getActiveContextName:u,getContext:m,setActiveContextName:g,isCtrlPressed:()=>!C&&(y.isPressed("control")||y.isPressed("meta")),releasePressedKeys:()=>y.releasePressedKeys(),destroy:()=>y.unmount()}};var cw=null,uw=new Map;function nh(r,e){var t,o=this;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this,a=new wo(i),c,u,m,g,C,v,y=!0;pE(n)&&mE(this),this.rootElement=r,this.rootDocument=r.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let R=(t=e?.layoutDirection)!==null&&t!==void 0?t:"inherit",O=["rtl","ltr"].includes(R)?R:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",O),this.isRtl=function(){return O==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},e.language=kE(e.language);let N=new Qs(i,e,[ql,Gl]),I=N.getTableMeta(),j=N.getGlobalMeta(),ie=qi();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,r.insertBefore(this.container,r.firstChild),zs(this)&&AR(e.licenseKey,r),this.guid=`ht_${iu()}`,uw.set(this.guid,this),this.columnIndexMapper=new Wn,this.rowIndexMapper=new Wn,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{i.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{i.runHooks("afterRowSequenceChange",f)}),u=new yE(i),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);let ue=f=>{let{row:p,col:w}=f;return i._createCellCoords(p>=0?i.rowIndexMapper.getRenderableFromVisualIndex(p):p,w>=0?i.columnIndexMapper.getRenderableFromVisualIndex(w):w)},de=f=>{let{row:p,col:w}=f;return i._createCellCoords(p>=0?i.rowIndexMapper.getVisualFromRenderableIndex(p):p,w>=0?i.columnIndexMapper.getVisualFromRenderableIndex(w):w)},J=(f,p)=>{let w=p>f?1:-1,E=Math.min(f,p),_=Math.max(f,p),M=i.rowIndexMapper.getNearestNotHiddenIndex(f,w);return M===null||w===1&&M>_||w===-1&&M<E?null:M>=0?i.rowIndexMapper.getRenderableFromVisualIndex(M):M},te=(f,p)=>{let w=p>f?1:-1,E=Math.min(f,p),_=Math.max(f,p),M=i.columnIndexMapper.getNearestNotHiddenIndex(f,w);return M===null||w===1&&M>_||w===-1&&M<E?null:M>=0?i.columnIndexMapper.getRenderableFromVisualIndex(M):M},q=new rw(I,{rowIndexMapper:i.rowIndexMapper,columnIndexMapper:i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:f=>c.propToCol(f),isEditorOpened:()=>i.getActiveEditor()?i.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return o.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return o.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(f,p)=>i._createCellCoords(f,p),createCellRange:(f,p,w)=>i._createCellRange(f,p,w),visualToRenderableCoords:ue,renderableToVisualCoords:de,findFirstNonHiddenRenderableRow:J,findFirstNonHiddenRenderableColumn:te,isDisabledCellSelection:(f,p)=>f<0||p<0?i.getSettings().disableVisualSelection:i.getCellMeta(f,p).disableVisualSelection});this.selection=q;let at=f=>{let{hiddenIndexesChanged:p}=f;p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",at),this.rowIndexMapper.addLocalHook("cacheUpdated",at),this.selection.addLocalHook("afterSetRangeEnd",(f,p)=>{let w=cr(!1),E=this.selection.getSelectedRange(),{from:_,to:M}=E.current(),P=E.size()-1;this.runHooks("afterSelection",_.row,_.col,M.row,M.col,w,P),this.runHooks("afterSelectionByProp",_.row,i.colToProp(_.col),M.row,i.colToProp(M.col),w,P),p&&(!w.isTouched()||w.isTouched()&&!w.value)&&v.scrollTo(f);let L=q.isSelectedByRowHeader(),K=q.isSelectedByColumnHeader();L&&K?se(this.rootElement,["ht__selection--rows","ht__selection--columns"]):L?(Fe(this.rootElement,"ht__selection--columns"),se(this.rootElement,"ht__selection--rows")):K?(Fe(this.rootElement,"ht__selection--rows"),se(this.rootElement,"ht__selection--columns")):Fe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),q.getSelectionSource()!=="shift"&&g.closeEditor(null),i.view.render(),g.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{let p=cr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&v.scrollTo(f),g.closeEditor(),i.view.render(),g.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{let p=f.length-1,{from:w,to:E}=f[p];this.runHooks("afterSelectionEnd",w.row,w.col,E.row,E.col,p),this.runHooks("afterSelectionEndByProp",w.row,i.colToProp(w.col),E.row,i.colToProp(E.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{let p=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{g.closeEditor(),i.view.render(),Fe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,p=new Array(f),w=0;w<f;w++)p[w]=arguments[w];return o.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),m={alter(f,p){var w,E;let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,M=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0,L=K=>{if(K.length===0)return[];let Q=[...K];return Q.sort((Ce,ke)=>{let[ve]=Ce,[ze]=ke;return ve===ze?0:ve>ze?1:-1}),Fi(Q,(Ce,ke)=>{let[ve,ze]=ke,xt=Ce[Ce.length-1],[Et,wt]=xt,Ae=Et+wt;if(ve<=Ae){let Ut=Math.max(ze-(Ae-ve),0);xt[1]+=Ut}else Ce.push([ve,ze]);return Ce},[Q[0]])};switch(f){case"insert_row_below":case"insert_row_above":let K=i.countSourceRows();if(I.maxRows===K)return;let Q=f==="insert_row_below"?"below":"above";p=(w=p)!==null&&w!==void 0?w:Q==="below"?K:0;let{delta:z,startPhysicalIndex:Ce}=c.createRow(p,_,{source:M,mode:Q});q.shiftRows(i.toVisualRow(Ce),z);break;case"insert_col_start":case"insert_col_end":let ke=f==="insert_col_end"?"end":"start";p=(E=p)!==null&&E!==void 0?E:ke==="end"?i.countSourceCols():0;let{delta:ve,startPhysicalIndex:ze}=c.createCol(p,_,{source:M,mode:ke});if(ve){if(Array.isArray(I.colHeaders)){let wt=[i.toVisualColumn(ze),0];wt.length+=ve,Array.prototype.splice.apply(I.colHeaders,wt)}q.shiftColumns(i.toVisualColumn(ze),ve)}break;case"remove_row":let xt=wt=>{let Ae=0;re(wt,Ut=>{let[We,bt]=Ut,mr=ai(We)?i.countRows()-1:Math.max(We-Ae,0);if(Number.isInteger(We)&&(We=Math.max(We-Ae,0)),!c.removeRow(We,bt,M))return;if(q.isSelected()){let{row:U}=i.getSelectedRangeLast().highlight;U>=We&&U<=We+bt-1&&g.closeEditor(!0)}let Jr=i.countRows();Jr===0?q.deselect():M==="ContextMenu.removeRow"?q.refresh():q.shiftRows(We,-bt);let B=I.fixedRowsTop;B>=mr+1&&(I.fixedRowsTop-=Math.min(bt,B-mr));let W=I.fixedRowsBottom;W&&mr>=Jr-W&&(I.fixedRowsBottom-=Math.min(bt,W)),Ae+=bt})};Array.isArray(p)?xt(L(p)):xt([[p,_]]);break;case"remove_col":let Et=wt=>{let Ae=0;re(wt,Ut=>{let[We,bt]=Ut,mr=ai(We)?i.countCols()-1:Math.max(We-Ae,0),Be=i.toPhysicalColumn(mr);if(Number.isInteger(We)&&(We=Math.max(We-Ae,0)),!c.removeCol(We,bt,M))return;if(q.isSelected()){let{col:U}=i.getSelectedRangeLast().highlight;U>=We&&U<=We+bt-1&&g.closeEditor(!0)}i.countCols()===0?q.deselect():M==="ContextMenu.removeColumn"?q.refresh():q.shiftColumns(We,-bt);let W=I.fixedColumnsStart;W>=mr+1&&(I.fixedColumnsStart-=Math.min(bt,W-mr)),Array.isArray(I.colHeaders)&&(typeof Be>"u"&&(Be=-1),I.colHeaders.splice(Be,bt)),Ae+=bt})};Array.isArray(p)?Et(L(p)):Et([[p,_]]);break;default:throw new Error(`There is no such action "${f}"`)}i.view.render(),P||m.adjustRowsAndCols()},adjustRowsAndCols(){let f=I.minRows,p=I.minSpareRows,w=I.minCols,E=I.minSpareCols;if(f){let _=i.countRows();_<f&&c.createRow(_,f-_,{source:"auto"})}if(p){let _=i.countEmptyRows(!0);if(_<p){let M=p-_,P=Math.min(M,I.maxRows-i.countSourceRows());c.createRow(i.countRows(),P,{source:"auto"})}}{let _;(w||E)&&(_=i.countEmptyCols(!0));let M=i.countCols();if(w&&!I.columns&&M<w){let P=w-M;_+=P,c.createCol(M,P,{source:"auto"})}if(E&&!I.columns&&i.dataType==="array"&&_<E){M=i.countCols();let P=E-_,L=Math.min(P,I.maxCols-M);c.createCol(M,L,{source:"auto"})}}i.view&&i.view.adjustElementsSize()},populateFromArray(f,p,w,E,_){let M,P,L,K,Q=[],z={},Ce=[],ke=f.row,ve=f.col;if(P=p.length,P===0)return!1;let ze=0,xt=0;switch(qt(w)&&(ze=w.col-ve+1,xt=w.row-ke+1),_){case"shift_down":let Et=tu(p),wt=Et.length,Ae=Math.max(wt,ze),Ut=i.getData().slice(ke),We=tu(Ut).slice(ve,ve+Ae);for(L=0;L<Ae;L+=1)if(L<wt){for(M=0,P=Et[L].length;M<xt-P;M+=1)Et[L].push(Et[L][M%P]);L<We.length?Ce.push(Et[L].concat(We[L])):Ce.push(Et[L].concat(new Array(Ut.length).fill(null)))}else Ce.push(Et[L%wt].concat(We[L]));i.populateFromArray(ke,ve,tu(Ce));break;case"shift_right":let bt=p.length,mr=Math.max(bt,xt),Be=i.getData().slice(ke).map(Ue=>Ue.slice(ve));for(M=0;M<mr;M+=1)if(M<bt){for(L=0,K=p[M].length;L<ze-K;L+=1)p[M].push(p[M][L%K]);if(M<Be.length)for(let Ue=0;Ue<Be[M].length;Ue+=1)p[M].push(Be[M][Ue]);else p[M].push(...new Array(Be[0].length).fill(null))}else p.push(p[M%P].slice(0,mr).concat(Be[M]));i.populateFromArray(ke,ve,p);break;case"overwrite":default:z.row=f.row,z.col=f.col;let Jr=0,B=0,W=!0,U,he=function(Ct){let dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Xt=p[Ct%p.length];return dt!==null?Xt[dt%Xt.length]:Xt},Ye=p.length,ut=w?w.row-f.row+1:0;for(w?P=ut:P=Math.max(Ye,ut),M=0;M<P&&!(w&&z.row>w.row&&ut>Ye||!I.allowInsertRow&&z.row>i.countRows()-1||z.row>=I.maxRows);M++){let Ue=M-Jr,Ct=he(Ue).length,dt=w?w.col-f.col+1:0;if(w?K=dt:K=Math.max(Ct,dt),z.col=f.col,U=i.getCellMeta(z.row,z.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&U.skipRowOnPaste){Jr+=1,z.row+=1,P+=1;continue}for(B=0,L=0;L<K&&!(w&&z.col>w.col&&dt>Ct||!I.allowInsertColumn&&z.col>i.countCols()-1||z.col>=I.maxCols);L++){if(U=i.getCellMeta(z.row,z.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&U.skipColumnOnPaste){B+=1,z.col+=1,K+=1;continue}if(U.readOnly&&E!=="UndoRedo.undo"){z.col+=1;continue}let Xt=L-B,yr=he(Ue,Xt),jt=i.getDataAtCell(z.row,z.col);if(yr!==null&&typeof yr=="object")if(Array.isArray(yr)&&jt===null&&(jt=[]),jt===null||typeof jt!="object")W=!1;else{let Yn=Rn(Array.isArray(jt)?jt:jt[0]||jt),Hr=Rn(Array.isArray(yr)?yr:yr[0]||yr);pu(Yn,Hr)||Array.isArray(Yn)&&Array.isArray(Hr)?yr=jr(yr):W=!1}else jt!==null&&typeof jt=="object"&&(W=!1);W&&Q.push([z.row,z.col,yr]),W=!0,z.col+=1}z.row+=1}i.setDataAtCell(Q,null,null,E||"populateFromArray");break}}};function rt(f){let p=Pd(f);Fd(p)?(i.runHooks("beforeLanguageChange",p),j.language=p,i.runHooks("afterLanguageChange",p)):Dd(f)}function Ne(f,p){let w=f==="className"?i.rootElement:i.table;if(y)se(w,p);else{let E=[],_=[];j[f]&&(E=Array.isArray(j[f])?j[f]:Zf(j[f])),p&&(_=Array.isArray(p)?p:Zf(p));let M=Qf(E,_),P=Qf(_,E);M.length&&Fe(w,M),P.length&&se(w,P)}j[f]=p}this.init=function(){u.setData(I.data),i.runHooks("beforeInit"),(ui()||MT())&&se(i.rootElement,"mobile"),this.updateSettings(I,!0),this.view=new bE(this),g=ZT.getInstance(i,I,q),v=m_(i),C=new Hu(i),zs(this)&&s_(i),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),y&&i.rootElement.offsetParent===null&&eT(i.rootElement,()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()}),typeof y=="object"&&(i.runHooks("afterChange",y[0],y[1]),y=!1),i.runHooks("afterInit")};function Kt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Ir(f){let p=f.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):f}function Me(f,p,w){if(!f.length){w();return}let E=i.getActiveEditor(),_=new Kt,M=!0;_.onQueueEmpty=()=>{E&&M&&E.cancelChanges(),w()};for(let P=f.length-1;P>=0;P--){let[L,K,,Q]=f[P],z=c.propToCol(K),Ce;Number.isInteger(z)?Ce=i.getCellMeta(L,z):Ce=pe(pe({},Object.getPrototypeOf(I)),I),Ce.type==="numeric"&&typeof Q=="string"&&fx(Q)&&(f[P][3]=Ir(Q)),i.getCellValidator(Ce)&&(_.addValidatorToQueue(),i.validateCell(f[P][3],Ce,function(ke,ve){return function(ze){if(typeof ze!="boolean")throw new Error("Validation error: result is not boolean");ze===!1&&ve.allowInvalid===!1&&(M=!1,f.splice(ke,1),ve.valid=!0),_.removeValidatorFormQueue()}}(P,Ce),p))}_.checkIfQueueIsEmpty()}function At(f,p){for(let E=f.length-1;E>=0;E--){let _=!1;if(f[E]===null){f.splice(E,1);continue}if(!((f[E][2]===null||f[E][2]===void 0)&&(f[E][3]===null||f[E][3]===void 0))){if(I.allowInsertRow)for(;f[E][0]>i.countRows()-1;){let{delta:M}=c.createRow(void 0,void 0,{source:p});if(M===0){_=!0;break}}if(i.dataType==="array"&&(!I.columns||I.columns.length===0)&&I.allowInsertColumn)for(;c.propToCol(f[E][1])>i.countCols()-1;){let{delta:M}=c.createCol(void 0,void 0,{source:p});if(M===0){_=!0;break}}_||c.set(f[E][0],f[E][1],f[E][3])}}let w=f.length>0;if(i.forceFullRender=!0,w){m.adjustRowsAndCols(),i.runHooks("beforeChangeRender",f,p),g.closeEditor(),i.view.render(),g.prepareEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",f,p||"edit");let E=i.getActiveEditor();E&&oe(E.refreshValue)&&E.refreshValue()}else i.view.render()}this._createCellCoords=function(f,p){return i.view._wt.createCellCoords(f,p)},this._createCellRange=function(f,p,w){return i.view._wt.createCellRange(f,p,w)},this.validateCell=function(f,p,w,E){let _=i.getCellValidator(p);function M(P){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){w(P);return}let K=p.visualCol,Q=p.visualRow,z=i.getCell(Q,K,!0);if(z&&z.nodeName!=="TH"){let Ce=i.rowIndexMapper.getRenderableFromVisualIndex(Q),ke=i.columnIndexMapper.getRenderableFromVisualIndex(K);i.view._wt.getSetting("cellRenderer",Ce,ke,z)}w(P)}HR(_)&&(_=function(P){return function(L,K){K(P.test(L))}}(_)),Re(_)?(f=i.runHooks("beforeValidate",f,p.visualRow,p.prop,E),i._registerImmediate(()=>{_.call(p,f,P=>{i&&(P=i.runHooks("afterValidate",P,f,p.visualRow,p.prop,E),p.valid=P,M(P),i.runHooks("postAfterValidate",P,f,p.visualRow,p.prop,E))})})):i._registerImmediate(()=>{p.valid=!0,M(p.valid,!1)})};function Ge(f,p,w){return Array.isArray(f)?f:[[f,p,w]]}function Bt(f,p){let w=i.getActiveEditor(),E=i.runHooks("beforeChange",f,p||"edit"),_=f.filter(M=>M!==null);return E===!1||_.length===0?(w&&w.cancelChanges(),[]):_}this.setDataAtCell=function(f,p,w,E){let _=Ge(f,p,w),M=[],P=E,L,K,Q;for(L=0,K=_.length;L<K;L++){if(typeof _[L]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof _[L][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");_[L][1]>=this.countCols()?Q=_[L][1]:Q=c.colToProp(_[L][1]),M.push([_[L][0],Q,u.getAtCell(this.toPhysicalRow(_[L][0]),_[L][1]),_[L][2]])}!P&&typeof f=="object"&&(P=p);let z=Bt(M,E);i.runHooks("afterSetDataAtCell",z,P),Me(z,P,()=>{At(z,P)})},this.setDataAtRowProp=function(f,p,w,E){let _=Ge(f,p,w),M=[],P=E,L,K;for(L=0,K=_.length;L<K;L++)M.push([_[L][0],_[L][1],u.getAtCell(this.toPhysicalRow(_[L][0]),_[L][1]),_[L][2]]);!P&&typeof f=="object"&&(P=p);let Q=Bt(M,E);i.runHooks("afterSetDataAtRowProp",Q,P),Me(Q,P,()=>{At(Q,P)})},this.listen=function(){i&&!i.isListening()&&(uw.forEach(f=>{i!==f&&f.unlisten()}),cw=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(cw=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return cw===i.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.closeEditor(f),i.view.render(),p&&q.isSelected()&&g.prepareEditor()},this.populateFromArray=function(f,p,w,E,_,M,P){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");let L=typeof E=="number"?i._createCellCoords(E,_):null;return m.populateFromArray(i._createCellCoords(f,p),w,L,M,P)},this.spliceCol=function(f,p,w){for(var E=arguments.length,_=new Array(E>3?E-3:0),M=3;M<E;M++)_[M-3]=arguments[M];return c.spliceCol(f,p,w,..._)},this.spliceRow=function(f,p,w){for(var E=arguments.length,_=new Array(E>3?E-3:0),M=3;M<E;M++)_[M-3]=arguments[M];return c.spliceRow(f,p,w,..._)},this.getSelected=function(){if(q.isSelected())return po(q.getSelectedRange(),f=>{let{from:p,to:w}=f;return[p.row,p.col,w.row,w.col]})},this.getSelectedLast=function(){let f=this.getSelected(),p;return f&&f.length>0&&(p=f[f.length-1]),p},this.getSelectedRange=function(){if(q.isSelected())return Array.from(q.getSelectedRange())},this.getSelectedRangeLast=function(){let f=this.getSelectedRange(),p;return f&&f.length>0&&(p=f[f.length-1]),p},this.emptySelectedCells=function(f){if(!q.isSelected()||this.countRows()===0||this.countCols()===0)return;let p=[];re(q.getSelectedRange(),w=>{if(w.isSingleHeader())return;let E=w.getTopStartCorner(),_=w.getBottomEndCorner();$t(E.row,_.row,M=>{$t(E.col,_.col,P=>{this.getCellMeta(M,P).readOnly||p.push([M,P,null])})})}),p.length>0&&this.setDataAtCell(p,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():i.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||i.view.render())},this.batchRender=function(f){this.suspendRender();let p=f();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();let w=f();return this.resumeExecution(p),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();let p=f();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!i.view)return;let{width:f,height:p}=i.view.getLastSize(),{width:w,height:E}=i.rootElement.getBoundingClientRect(),_=w!==f||E!==p;i.runHooks("beforeRefreshDimensions",{width:f,height:p},{width:w,height:E},_)!==!1&&((_||i.view._wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(w,E),i.render()),i.runHooks("afterRefreshDimensions",{width:f,height:p},{width:w,height:E},_))},this.updateData=function(f,p){Jd(f,w=>{c=w},w=>{c=w,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),m.adjustRowsAndCols(),q.refresh()},{hotInstance:i,dataMap:c,dataSource:u,internalSource:"updateData",source:p,metaManager:N,firstRun:y})},this.loadData=function(f,p){Jd(f,w=>{c=w},()=>{N.clearCellsCache(),i.initIndexMappers(),m.adjustRowsAndCols(),q.refresh(),y&&(y=[null,"loadData"])},{hotInstance:i,dataMap:c,dataSource:u,internalSource:"loadData",source:p,metaManager:N,firstRun:y})},this.getInitialColumnCount=function(){let f=I.columns,p=0;if(Array.isArray(f))p=f.length;else if(Re(f))if(i.dataType==="array"){let w=this.countSourceCols();for(let E=0;E<w;E+=1)f(E)&&(p+=1)}else(i.dataType==="object"||i.dataType==="function")&&(p=c.colToPropCache.length);else if(oe(I.dataSchema)){let w=c.getSchema();p=Array.isArray(w)?w.length:Es(w)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,p,w,E){return pt(f)?c.getAll():c.getRange(i._createCellCoords(f,p),i._createCellCoords(w,E),c.DESTINATION_RENDERER)},this.getCopyableText=function(f,p,w,E){return c.getCopyableText(i._createCellCoords(f,p),i._createCellCoords(w,E))},this.getCopyableData=function(f,p){return c.getCopyable(f,c.colToProp(p))},this.getSchema=function(){return c.getSchema()},this.updateSettings=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=(y?i.loadData:i.updateData).bind(this),E=!1,_,M;if(oe(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(oe(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(oe(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in f)_==="data"||(_==="language"?rt(f.language):_==="className"?Ne("className",f.className):_==="tableClassName"&&i.table?(Ne("tableClassName",f.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):Gt.getSingleton().isRegistered(_)||Gt.getSingleton().isDeprecated(_)?(Re(f[_])||Array.isArray(f[_]))&&(f[_].initialHook=!0,i.addHook(_,f[_])):!p&&Do(f,_)&&(j[_]=f[_]));f.data===void 0&&I.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(c.createMap(),i.initIndexMappers());let P=i.countCols(),L=I.columns;if(L&&Re(L)&&(E=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&N.clearCache(),P>0)for(_=0,M=0;_<P;_++){if(L){let z=E?L(_):L[M];z&&N.updateColumnMeta(M,z)}M+=1}oe(f.cell)&&be(f.cell,z=>{i.setCellMetaObject(z.row,z.col,z)}),i.runHooks("afterCellMetaReset");let K=i.rootElement.style.height;K!==""&&(K=parseInt(i.rootElement.style.height,10));let Q=f.height;if(Re(Q)&&(Q=Q()),p&&i.rootElement.getAttribute("style")&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style")),Q===null){let z=i.rootElement.getAttribute("data-initialstyle");z&&(z.indexOf("height")>-1||z.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",z):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else Q!==void 0&&(i.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,i.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let z=f.width;Re(z)&&(z=z()),i.rootElement.style.width=isNaN(z)?`${z}`:`${z}px`}p||(i.view&&(i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames()),i.runHooks("afterUpdateSettings",f)),m.adjustRowsAndCols(),i.view&&!y&&(i.forceFullRender=!0,i.view.render(),i.view._wt.wtOverlays.adjustElementsSize()),!p&&i.view&&(K===""||Q===""||Q===void 0)&&K!==Q&&i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let f=i.getSelectedLast();if(I.getValue){if(Re(I.getValue))return I.getValue.call(i);if(f)return i.getData()[f[0][0]][I.getValue]}else if(f)return i.getDataAtCell(f[0],f[1])},this.getSettings=function(){return I},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,p,w,E,_){m.alter(f,p,w,E,_)},this.getCell=function(f,p){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=p,_=f;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||E===null||_===void 0||E===void 0?null:i.view.getCellAtCoords(i._createCellCoords(_,E),w)},this.getCoords=function(f){let p=this.view._wt.wtTable.getCoords(f);if(p===null)return null;let{row:w,col:E}=p,_=w,M=E;return w>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(w)),E>=0&&(M=this.columnIndexMapper.getVisualFromRenderableIndex(E)),i._createCellCoords(_,M)},this.colToProp=function(f){return c.colToProp(f)},this.propToCol=function(f){return c.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,p){return c.get(f,c.colToProp(p))},this.getDataAtRowProp=function(f,p){return c.get(f,p)},this.getDataAtCol=function(f){let p=[],w=c.getRange(i._createCellCoords(0,f),i._createCellCoords(I.data.length-1,f),c.DESTINATION_RENDERER);for(let E=0;E<w.length;E+=1)for(let _=0;_<w[E].length;_+=1)p.push(w[E][_]);return p},this.getDataAtProp=function(f){let p=[],w=c.getRange(i._createCellCoords(0,c.propToCol(f)),i._createCellCoords(I.data.length-1,c.propToCol(f)),c.DESTINATION_RENDERER);for(let E=0;E<w.length;E+=1)for(let _=0;_<w[E].length;_+=1)p.push(w[E][_]);return p},this.getSourceData=function(f,p,w,E){let _;return f===void 0?_=u.getData():_=u.getByRange(i._createCellCoords(f,p),i._createCellCoords(w,E)),_},this.getSourceDataArray=function(f,p,w,E){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(i._createCellCoords(f,p),i._createCellCoords(w,E),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,p,w,E){let _=Ge(f,p,w),M=this.hasHook("afterSetSourceDataAtCell"),P=[];M&&re(_,K=>{let[Q,z,Ce]=K;P.push([Q,z,u.getAtCell(Q,z),Ce])}),re(_,K=>{let[Q,z,Ce]=K;u.setAtCell(Q,z,Ce)}),M&&this.runHooks("afterSetSourceDataAtCell",P,E),this.render();let L=i.getActiveEditor();L&&oe(L.refreshValue)&&L.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,p){return u.getAtCell(f,p)},this.getDataAtRow=function(f){return c.getRange(i._createCellCoords(f,0),i._createCellCoords(f,this.countCols()-1),c.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,p,w,E){let _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,p,w,E],[M,P]=_,[,,L,K]=_,Q=null,z=null;L===void 0&&(L=M),K===void 0&&(K=P);let Ce="mixed";return $t(Math.max(Math.min(M,L),0),Math.max(M,L),ke=>{let ve=!0;return $t(Math.max(Math.min(P,K),0),Math.max(P,K),ze=>(z=this.getCellMeta(ke,ze).type,Q?ve=Q===z:Q=z,ve)),Ce=ve?z:"mixed",ve}),Ce},this.removeCellMeta=function(f,p,w){let[E,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(p)],M=N.getCellMetaKeyValue(E,_,w);i.runHooks("beforeRemoveCellMeta",f,p,w,M)!==!1&&(N.removeCellMeta(E,_,w),i.runHooks("afterRemoveCellMeta",f,p,w,M)),M=null},this.spliceCellsMeta=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,E=new Array(w>2?w-2:0),_=2;_<w;_++)E[_-2]=arguments[_];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&N.removeRow(this.toPhysicalRow(f),p),E.length>0&&re(E.reverse(),M=>{N.createRow(this.toPhysicalRow(f)),re(M,(P,L)=>this.setCellMetaObject(f,L,P))}),i.render()},this.setCellMetaObject=function(f,p,w){typeof w=="object"&&be(w,(E,_)=>{this.setCellMeta(f,p,_,E)})},this.setCellMeta=function(f,p,w,E){if(i.runHooks("beforeSetCellMeta",f,p,w,E)===!1)return;let M=f,P=p;f<this.countRows()&&(M=this.toPhysicalRow(f)),p<this.countCols()&&(P=this.toPhysicalColumn(p)),N.setCellMeta(M,P,w,E),i.runHooks("afterSetCellMeta",f,p,w,E)},this.getCellsMeta=function(){return N.getCellsMeta()},this.getCellMeta=function(f,p){let w=this.toPhysicalRow(f),E=this.toPhysicalColumn(p);return w===null&&(w=f),E===null&&(E=p),N.getCellMeta(w,E,{visualRow:f,visualColumn:p})},this.getColumnMeta=function(f){return N.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return N.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||I.columns)},this.getCellRenderer=function(f,p){let w=typeof f=="number"?i.getCellMeta(f,p).renderer:f.renderer;return typeof w=="string"?Nm(w):pt(w)?Nm("text"):w},this.getCellEditor=function(f,p){let w=typeof f=="number"?i.getCellMeta(f,p).editor:f.editor;return typeof w=="string"?bm(w):pt(w)?bm("text"):w},this.getCellValidator=function(f,p){let w=typeof f=="number"?i.getCellMeta(f,p).validator:f.validator;return typeof w=="string"?yx(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,p){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,f)},this.validateColumns=function(f,p){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,f)},this._validateCells=function(f,p,w){let E=new Kt;f&&(E.onQueueEmpty=f);let _=i.countRows()-1;for(;_>=0;){if(p!==void 0&&p.indexOf(_)===-1){_-=1;continue}let M=i.countCols()-1;for(;M>=0;){if(w!==void 0&&w.indexOf(M)===-1){M-=1;continue}E.addValidatorToQueue(),i.validateCell(i.getDataAtCell(_,M),i.getCellMeta(_,M),P=>{if(typeof P!="boolean")throw new Error("Validation error: result is not boolean");P===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),M-=1}_-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let p=I.rowHeaders,w=f;return w!==void 0&&(w=i.runHooks("modifyRowHeader",w)),w===void 0?(p=[],$t(i.countRows()-1,E=>{p.push(i.getRowHeader(E))})):Array.isArray(p)&&p[w]!==void 0?p=p[w]:Re(p)?p=p(w):p&&typeof p!="string"&&typeof p!="number"&&(p=w+1),p},this.hasRowHeaders=function(){return!!I.rowHeaders},this.hasColHeaders=function(){if(I.colHeaders!==void 0&&I.colHeaders!==null)return!!I.colHeaders;for(let f=0,p=i.countCols();f<p;f++)if(i.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,w=i.runHooks("modifyColHeader",f);if(w===void 0){let L=[],K=i.countCols();for(let Q=0;Q<K;Q++)L.push(i.getColHeader(Q));return L}let E=I.colHeaders,_=function(L){let K=[],Q=i.countCols(),z=0;for(;z<Q;z++)Re(I.columns)&&I.columns(z)&&K.push(z);return K[L]},M=i.toPhysicalColumn(w),P=_(M);return I.colHeaders===!1?E=null:I.columns&&Re(I.columns)&&I.columns(P)&&I.columns(P).title?E=I.columns(P).title:I.columns&&I.columns[M]&&I.columns[M].title?E=I.columns[M].title:Array.isArray(I.colHeaders)&&I.colHeaders[M]!==void 0?E=I.colHeaders[M]:Re(I.colHeaders)?E=I.colHeaders(M):I.colHeaders&&typeof I.colHeaders!="string"&&typeof I.colHeaders!="number"&&(E=vE(w)),E=i.runHooks("modifyColumnHeaderValue",E,f,p),E},this._getColWidthFromSettings=function(f){let p;if(f>=0&&(p=i.getCellMeta(0,f).width),(p===void 0||p===I.width)&&(p=I.colWidths),p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break;default:break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(f){let p=i._getColWidthFromSettings(f);return p=i.runHooks("modifyColWidth",p,f),p===void 0&&(p=On),p},this._getRowHeightFromSettings=function(f){let p=I.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break;default:break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(f){let p=i._getRowHeightFromSettings(f);return p=i.runHooks("modifyRowHeight",p,f),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return c.getLength()},this.countCols=function(){let f=I.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,p)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Hm(i.countRows()-1,w=>{if(i.isEmptyRow(w))p+=1;else if(f===!0)return!1}),p},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Hm(i.countCols()-1,w=>{if(i.isEmptyCol(w))p+=1;else if(f===!0)return!1}),p},this.isEmptyRow=function(f){return I.isEmptyRow.call(i,f)},this.isEmptyCol=function(f){return I.isEmptyCol.call(i,f)},this.selectCell=function(f,p,w,E){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,M=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return pt(f)||pt(p)?!1:this.selectCells([[f,p,w,E]],_,M)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&v.suspend();let E=q.selectCells(f);return E&&w&&i.listen(),v.resume(),E},this.selectColumns=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return q.selectColumns(f,p,w)},this.selectRows=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return q.selectRows(f,p,w)},this.deselectCell=function(){q.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;v.skipNextScrollCycle(),q.selectAll(f,p,w)};let F=(f,p)=>f.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(f){var p;if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}let{row:E,col:_,verticalSnap:M,horizontalSnap:P,considerHiddenIndexes:L}=(p=f)!==null&&p!==void 0?p:{},K,Q,z,Ce;M!==void 0&&(K=M==="top",Q=!K),P!==void 0&&(z=P==="start",Ce=!z);let ke=E,ve=_;if(L===void 0||L){let Et=Number.isInteger(E)&&E>=0,wt=Number.isInteger(_)&&_>=0,Ae=Et?F(this.rowIndexMapper,E):void 0,Ut=wt?F(this.columnIndexMapper,_):void 0;if(Ae===null||Ut===null)return!1;ke=Et?i.rowIndexMapper.getRenderableFromVisualIndex(Ae):E,ve=wt?i.columnIndexMapper.getRenderableFromVisualIndex(Ut):_}let ze=Number.isInteger(ke),xt=Number.isInteger(ve);return ze&&ke>=0&&xt&&ve>=0?i.view.scrollViewport(i._createCellCoords(ke,ve),K,Ce,Q,z):ze&&ke>=0&&(xt&&ve<0||!xt)?i.view.scrollViewportVertically(ke,K,Q):xt&&ve>=0&&(ze&&ke<0||!ze)?i.view.scrollViewportHorizontally(ve,Ce,z):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);let{highlight:p}=this.getSelectedRangeLast();this.scrollViewportTo(p.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),N.clearCache(),uw.delete(this.guid),zs(i)){let f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}Po(i.rootElement),a.destroy(),g&&g.destroy(),i.batchExecution(()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),ie.getItems().forEach(f=>{let[,p]=f;p.destroy()}),ie.clear(),i.runHooks("afterDestroy")},!0),Gt.getSingleton().destroy(i),be(i,(f,p,w)=>{Re(f)?w[p]=ae(p):p!=="guid"&&(w[p]=null)}),i.isDestroyed=!0,c&&c.destroy(),c=null,m=null,q=null,g=null,i=null};function ae(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return i.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return i.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return i.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return i.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return i.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return i.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return i.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return i.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return i.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return i.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return i.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return i.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){let p=Cs(f);return p==="UndoRedo"?this.undoRedo:ie.getItem(p)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:ie.getId(f)},this.getInstance=function(){return i},this.addHook=function(f,p,w){Gt.getSingleton().add(f,p,i,w)},this.hasHook=function(f){return Gt.getSingleton().has(f,i)||Gt.getSingleton().has(f)},this.addHookOnce=function(f,p,w){Gt.getSingleton().once(f,p,i,w)},this.removeHook=function(f,p){Gt.getSingleton().remove(f,p,i)},this.runHooks=function(f,p,w,E,_,M,P){return Gt.getSingleton().run(i,f,p,w,E,_,M,P)},this.getTranslatedPhrase=function(f,p){return Vd(I.language,f,p)},this.toHTML=()=>Mm(this),this.toTableElement=()=>{let f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",Mm(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,p)),this.timeouts.push(w)},this._clearTimeouts=function(){re(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){re(this.immediates,f=>{clearImmediate(f)})},this._getEditorManager=function(){return g},this.isRtl=function(){return i.rootWindow.getComputedStyle(i.rootElement).direction==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1};let Nt=lw({handleEvent(){return i.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Nt.releasePressedKeys()}),this.getShortcutManager=function(){return Nt},this.getFocusManager=function(){return C},bx().forEach(f=>{let p=Cx(f);ie.addItem(f,new p(this))}),o_(i),Nt.setActiveContextName("grid"),Gt.getSingleton().run(i,"construct")}var Jre=S(V(),1);function S_(r,e,t){r.addEventListener(e,t,!1)}function R_(r,e,t){r.removeEventListener(e,t,!1)}function T_(r){return r.ownerDocument.defaultView.getComputedStyle(r)}function x_(r){let e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=r.body,o=r.createTextNode(""),n=r.createElement("span"),i;function a(){o.textContent=i.value,n.style.position="absolute",n.style.fontSize=T_(i).fontSize,n.style.fontFamily=T_(i).fontFamily,n.style.whiteSpace="pre",t.appendChild(n);let g=n.clientWidth+2;t.removeChild(n);let C=i.style;C.height=`${e.minHeight}px`,e.minWidth>g?C.width=`${e.minWidth}px`:g>e.maxWidth?C.width=`${e.maxWidth}px`:C.width=`${g}px`;let v=i.scrollHeight?i.scrollHeight-1:0;e.minHeight>v?C.height=`${e.minHeight}px`:e.maxHeight<v?(C.height=`${e.maxHeight}px`,C.overflowY="visible"):C.height=`${v}px`}function c(){r.defaultView.setTimeout(a,0)}function u(g){if(g&&g.minHeight)if(g.minHeight==="inherit")e.minHeight=i.clientHeight;else{let C=parseInt(g.minHeight,10);isNaN(C)||(e.minHeight=C)}if(g&&g.maxHeight)if(g.maxHeight==="inherit")e.maxHeight=i.clientHeight;else{let C=parseInt(g.maxHeight,10);isNaN(C)||(e.maxHeight=C)}if(g&&g.minWidth)if(g.minWidth==="inherit")e.minWidth=i.clientWidth;else{let C=parseInt(g.minWidth,10);isNaN(C)||(e.minWidth=C)}if(g&&g.maxWidth)if(g.maxWidth==="inherit")e.maxWidth=i.clientWidth;else{let C=parseInt(g.maxWidth,10);isNaN(C)||(e.maxWidth=C)}n.firstChild||(n.className="autoResize",n.style.display="inline-block",n.appendChild(o))}function m(g,C){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i=g,u(C),i.nodeName==="TEXTAREA"&&(i.style.resize="none",i.style.height=`${e.minHeight}px`,i.style.minWidth=`${e.minWidth}px`,i.style.maxWidth=`${e.maxWidth}px`,i.style.overflowY="hidden"),v&&(S_(i,"input",a),S_(i,"keydown",c)),a()}return{init:m,resize:a,unObserve(){R_(i,"input",a),R_(i,"keydown",c)}}}function dw(r,e){let t=QR(e),o=e.value.split(`
`),n=t,i=0;for(let a=0;a<o.length;a++){let c=o[a];a!==0&&(i+=o[a-1].length+1);let u=i+c.length;if(r==="home"?n=i:r==="end"&&(n=u),t<=u)break}hu(e,n)}function zn(r,e,t){return(e=WB(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function WB(r){var e=BB(r,"string");return typeof e=="symbol"?e:e+""}function BB(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var o=t.call(r,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var UB="ht_editor_visible",sh="ht_editor_hidden",E_="textEditor",__="text",Ql=class extends tn{static get EDITOR_TYPE(){return __}constructor(e){super(e),zn(this,"eventManager",new wo(this)),zn(this,"autoResize",x_(this.hot.rootDocument)),zn(this,"TEXTAREA",void 0),zn(this,"textareaStyle",void 0),zn(this,"TEXTAREA_PARENT",void 0),zn(this,"textareaParentStyle",void 0),zn(this,"layerClass",void 0),this.eventManager=new wo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),zR(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,o,n,i,a){let c=this.state;if(super.prepare(e,t,o,n,i,a),!a.readOnly){this.refreshDimensions(!0);let{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),c!==st.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===st.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),hu(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Se(this.TEXTAREA,[["data-hot-input",""],Vi(-1)]),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[su()]),se(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),se(this.TEXTAREA_PARENT,"handsontableInputHolder"),He(this.TEXTAREA_PARENT,this.layerClass)&&Fe(this.TEXTAREA_PARENT,this.layerClass),se(this.TEXTAREA_PARENT,sh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){OT()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Fe(this.TEXTAREA_PARENT,this.layerClass),se(this.TEXTAREA_PARENT,sh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let e=this.TEXTAREA_PARENT.childNodes,t=!1;$t(e.length-1,o=>{let n=e[o];if(He(n,"handsontableEditor"))return t=!0,!1}),He(this.TEXTAREA_PARENT,sh)&&Fe(this.TEXTAREA_PARENT,sh),t?(this.layerClass=UB,se(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),se(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){let e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==st.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:t,start:o,width:n,maxWidth:i,height:a,maxHeight:c}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();let u=Ur(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let m=Ur(this.TEXTAREA),g=parseInt(m.paddingLeft,10)+parseInt(m.paddingRight,10),C=parseInt(m.paddingTop,10)+parseInt(m.paddingBottom,10),v=n-g,y=a-C,R=i-g,O=c-C;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(v,R),minHeight:Math.min(y,O),maxWidth:R,maxHeight:O},!0)}bindEvents(){Cu()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===st.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===st.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor"),o={runOnlyIf:()=>oe(this.hot.getSelected()),group:E_},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:i=>!this.hot.selection.isMultiple()&&!i.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(i,a)=>{let[c]=a;dw(c,this.TEXTAREA)}},{keys:[["End"]],callback:(i,a)=>{let[c]=a;dw(c,this.TEXTAREA)}}],o)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(E_)}};var hoe=S(me(),1);var O_="base";function ah(r,e,t,o,n,i,a){let c=a.ariaTags,u=[],m=[],g=[],C=[];a.className&&se(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),c&&C.push(tm())):c&&g.push(tm()[0]),a.valid===!1&&a.invalidCellClassName?(u.push(a.invalidCellClassName),c&&C.push(rm())):(m.push(a.invalidCellClassName),c&&g.push(rm()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!i&&a.placeholder&&u.push(a.placeholderCellClassName),Fe(e,m),se(e,u),ko(e,g),Se(e,C)}ah.RENDERER_TYPE=O_;var M_="text";function lh(r,e,t,o,n,i,a){ah.apply(this,[r,e,t,o,n,i,a]);let c=i;if(!c&&a.placeholder&&(c=a.placeholder),c=ou(c),a.trimWhitespace&&(c=c.trim()),a.rendererTemplate){Po(e);let u=r.rootDocument.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=r.getSourceDataAtRow(t),e.appendChild(u)}else li(e,c)}lh.RENDERER_TYPE=M_;var I_="text",hw={CELL_TYPE:I_,editor:Ql,renderer:lh};t0(hw);Mo.editors={BaseEditor:tn};function Mo(r,e){let t=new nh(r,e||{},Cd);return t.init(),t}Mo.Core=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new nh(r,e,Cd)};Mo.DefaultSettings=Yl();Mo.hooks=Gt.getSingleton();Mo.CellCoords=Gi;Mo.CellRange=Mn;Mo.packageName="handsontable";Mo.buildDate="30/09/2024 12:33:10";Mo.version="14.6.0";Mo.languages={dictionaryKeys:HE,getLanguageDictionary:Ug,getLanguagesDictionaries:NE,registerLanguageDictionary:Bg,getTranslatedPhrase:Vd};var ch=Mo;var jB=["container"],fw=new Map,N_="The Handsontable instance bound to this component was destroyed and cannot be used properly.",mw=(()=>{class r{getInstance(t){let o=fw.get(t);return o.isDestroyed?(console.warn(N_),null):o}registerInstance(t,o){return fw.set(t,o)}removeInstance(t){return fw.delete(t)}static \u0275fac=function(o){return new(o||r)};static \u0275prov=Nh({token:r,factory:r.\u0275fac})}return r})(),zB=Object.keys(ch.DefaultSettings),H_=ch.hooks.getRegistered(),A_=(()=>{class r{mergeSettings(t){let o="settings"in t&&typeof t.settings=="object",n=o?t.settings:{};return H_.concat(zB).forEach(a=>{let c=H_.indexOf(a)>-1,u;o&&c&&(u=t.settings[a]),t[a]!==void 0&&(u=t[a]),u!==void 0&&("ngZone"in t&&typeof u=="function"&&c?n[a]=function(...m){return t.ngZone.run(()=>u.apply(this,m))}:n[a]=u)}),n}prepareChanges(t){let o={};return Object.keys(t).forEach(i=>{t.hasOwnProperty(i)&&(o[i]=t[i].currentValue)}),o}static \u0275fac=function(o){return new(o||r)};static \u0275prov=Nh({token:r,factory:r.\u0275fac})}return r})(),k_=(()=>{class r{_hotTableRegisterer;_hotSettingsResolver;ngZone;container;__hotInstance=null;columnsComponents=[];settings;hotId="";activeHeaderClassName;allowEmpty;allowHtml;allowInsertColumn;allowInsertRow;allowInvalid;allowRemoveColumn;allowRemoveRow;ariaTags;autoColumnSize;autoRowSize;autoWrapCol;autoWrapRow;bindRowsWithHeaders;cell;cells;checkedTemplate;className;colHeaders;collapsibleColumns;columnHeaderHeight;columns;columnSorting;columnSummary;colWidths;commentedCellClassName;comments;contextMenu;copyable;copyPaste;correctFormat;currentColClassName;currentHeaderClassName;currentRowClassName;customBorders;data;dataDotNotation;dataSchema;dateFormat;datePickerConfig;defaultDate;tabNavigation;disableVisualSelection;dragToScroll;dropdownMenu;editor;enterBeginsEditing;enterMoves;fillHandle;filter;filteringCaseSensitive;filters;fixedColumnsLeft;fixedColumnsStart;fixedRowsBottom;fixedRowsTop;formulas;fragmentSelection;headerClassName;height;hiddenColumns;hiddenRows;invalidCellClassName;imeFastEdit;label;language;layoutDirection;licenseKey;locale;manualColumnFreeze;manualColumnMove;manualColumnResize;manualRowMove;manualRowResize;maxCols;maxRows;mergeCells;minCols;minRows;minSpareCols;minSpareRows;multiColumnSorting;navigableHeaders;nestedHeaders;nestedRows;noWordWrapClassName;numericFormat;observeDOMVisibility;outsideClickDeselects;persistentState;placeholder;placeholderCellClassName;preventOverflow;preventWheel;readOnly;readOnlyCellClassName;renderAllColumns;renderAllRows;renderer;rowHeaders;rowHeaderWidth;rowHeights;search;selectionMode;selectOptions;skipColumnOnPaste;skipRowOnPaste;sortByRelevance;source;startCols;startRows;stretchH;strict;tableClassName;tabMoves;title;trimDropdown;trimRows;trimWhitespace;type;uncheckedTemplate;undo;validator;viewportColumnRenderingOffset;viewportRowRenderingOffset;visibleRows;width;wordWrap;afterAddChild;afterAutofill;afterBeginEditing;afterCellMetaReset;afterChange;afterChangesObserved;afterColumnCollapse;afterColumnExpand;afterColumnFreeze;afterColumnMove;afterColumnResize;afterColumnSequenceChange;afterColumnSort;afterColumnUnfreeze;afterContextMenuDefaultOptions;afterContextMenuHide;afterContextMenuShow;afterCopy;afterCopyLimit;afterCreateCol;afterCreateRow;afterCut;afterDeselect;afterDestroy;afterDetachChild;afterDocumentKeyDown;afterDrawSelection;afterDropdownMenuDefaultOptions;afterDropdownMenuHide;afterDropdownMenuShow;afterFilter;afterFormulasValuesUpdate;afterGetCellMeta;afterGetColHeader;afterGetColumnHeaderRenderers;afterGetRowHeader;afterGetRowHeaderRenderers;afterHideColumns;afterHideRows;afterInit;afterLanguageChange;afterListen;afterLoadData;afterMergeCells;afterModifyTransformEnd;afterModifyTransformFocus;afterModifyTransformStart;afterMomentumScroll;afterNamedExpressionAdded;afterNamedExpressionRemoved;afterOnCellContextMenu;afterOnCellCornerDblClick;afterOnCellCornerMouseDown;afterOnCellMouseDown;afterOnCellMouseOut;afterOnCellMouseOver;afterOnCellMouseUp;afterPaste;afterPluginsInitialized;afterRedo;afterRedoStackChange;afterRefreshDimensions;afterRemoveCellMeta;afterRemoveCol;afterRemoveRow;afterRender;afterRenderer;afterRowMove;afterRowResize;afterRowSequenceChange;afterScrollHorizontally;afterScrollVertically;afterScroll;afterSelectColumns;afterSelection;afterSelectionByProp;afterSelectionEnd;afterSelectionEndByProp;afterSelectionFocusSet;afterSelectRows;afterSetCellMeta;afterSetDataAtCell;afterSetDataAtRowProp;afterSetSourceDataAtCell;afterSheetAdded;afterSheetRenamed;afterSheetRemoved;afterTrimRow;afterUndo;afterUndoStackChange;afterUnhideColumns;afterUnhideRows;afterUnlisten;afterUnmergeCells;afterUntrimRow;afterUpdateData;afterUpdateSettings;afterValidate;afterViewportColumnCalculatorOverride;afterViewportRowCalculatorOverride;afterViewRender;beforeAddChild;beforeAutofill;beforeBeginEditing;beforeCellAlignment;beforeChange;beforeChangeRender;beforeColumnCollapse;beforeColumnExpand;beforeColumnFreeze;beforeColumnMove;beforeColumnResize;beforeColumnSort;beforeColumnWrap;beforeColumnUnfreeze;beforeContextMenuSetItems;beforeContextMenuShow;beforeCopy;beforeCreateCol;beforeCreateRow;beforeCut;beforeDetachChild;beforeDrawBorders;beforeDropdownMenuSetItems;beforeDropdownMenuShow;beforeFilter;beforeGetCellMeta;beforeHideColumns;beforeHideRows;beforeHighlightingColumnHeader;beforeHighlightingRowHeader;beforeInit;beforeInitWalkontable;beforeKeyDown;beforeLanguageChange;beforeLoadData;beforeMergeCells;beforeOnCellContextMenu;beforeOnCellMouseDown;beforeOnCellMouseOut;beforeOnCellMouseOver;beforeOnCellMouseUp;beforePaste;beforeRedo;beforeRedoStackChange;beforeRefreshDimensions;beforeRemoveCellClassNames;beforeRemoveCellMeta;beforeRemoveCol;beforeRemoveRow;beforeRender;beforeRenderer;beforeRowMove;beforeRowResize;beforeRowWrap;beforeSelectColumns;beforeSelectionFocusSet;beforeSelectionHighlightSet;beforeSelectRows;beforeSetCellMeta;beforeSetRangeEnd;beforeSetRangeStart;beforeSetRangeStartOnly;beforeStretchingColumnWidth;beforeTouchScroll;beforeTrimRow;beforeUndo;beforeUndoStackChange;beforeUnhideColumns;beforeUnhideRows;beforeUnmergeCells;beforeUntrimRow;beforeUpdateData;beforeValidate;beforeValueRender;beforeViewportScroll;beforeViewportScrollHorizontally;beforeViewportScrollVertically;beforeViewRender;construct;init;modifyAutoColumnSizeSeed;modifyAutofillRange;modifyColHeader;modifyColumnHeaderHeight;modifyColumnHeaderValue;modifyColWidth;modifyCopyableRange;modifyFiltersMultiSelectValue;modifyFocusedElement;modifyData;modifyFocusOnTabNavigation;modifyGetCellCoords;modifyRowData;modifyRowHeader;modifyRowHeaderWidth;modifyRowHeight;modifyRowHeightByOverlayName;modifySourceData;modifyTransformEnd;modifyTransformFocus;modifyTransformStart;persistentStateLoad;persistentStateReset;persistentStateSave;constructor(t,o,n){this._hotTableRegisterer=t,this._hotSettingsResolver=o,this.ngZone=n}get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(this._hotTableRegisterer.removeInstance(this.hotId),console.warn(N_),null)}set hotInstance(t){this.__hotInstance=t}ngAfterViewInit(){let t=this._hotSettingsResolver.mergeSettings(this);if(this.columnsComponents.length>0){let o=[];this.columnsComponents.forEach(n=>{o.push(this._hotSettingsResolver.mergeSettings(n))}),t.columns=o}this.ngZone.runOutsideAngular(()=>{this.hotInstance=new ch.Core(this.container.nativeElement,t),this.hotId&&this._hotTableRegisterer.registerInstance(this.hotId,this.hotInstance),this.hotInstance.init()})}ngOnChanges(t){if(this.hotInstance===null)return;let o=this._hotSettingsResolver.prepareChanges(t);this.updateHotTable(o)}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{this.hotInstance&&this.hotInstance.destroy()}),this.hotId&&this._hotTableRegisterer.removeInstance(this.hotId)}updateHotTable(t){this.hotInstance&&this.ngZone.runOutsideAngular(()=>{this.hotInstance.updateSettings(t,!1)})}onAfterColumnsChange(){if(this.columnsComponents!==void 0&&this.columnsComponents.length>0){let t=[];this.columnsComponents.forEach(n=>{t.push(this._hotSettingsResolver.mergeSettings(n))});let o={columns:t};this.updateHotTable(o)}}onAfterColumnsNumberChange(){let t=[];this.columnsComponents.length>0&&this.columnsComponents.forEach(o=>{t.push(this._hotSettingsResolver.mergeSettings(o))}),this.updateHotTable({columns:t})}addColumn(t){this.columnsComponents.push(t),this.onAfterColumnsNumberChange()}removeColumn(t){let o=this.columnsComponents.indexOf(t);this.columnsComponents.splice(o,1),this.onAfterColumnsNumberChange()}static \u0275fac=function(o){return new(o||r)(De(mw),De(A_),De(Sc))};static \u0275cmp=ti({type:r,selectors:[["hot-table"]],viewQuery:function(o,n){if(o&1&&Io(jB,5),o&2){let i;so(i=ao())&&(n.container=i.first)}},inputs:{settings:"settings",hotId:"hotId",activeHeaderClassName:"activeHeaderClassName",allowEmpty:"allowEmpty",allowHtml:"allowHtml",allowInsertColumn:"allowInsertColumn",allowInsertRow:"allowInsertRow",allowInvalid:"allowInvalid",allowRemoveColumn:"allowRemoveColumn",allowRemoveRow:"allowRemoveRow",ariaTags:"ariaTags",autoColumnSize:"autoColumnSize",autoRowSize:"autoRowSize",autoWrapCol:"autoWrapCol",autoWrapRow:"autoWrapRow",bindRowsWithHeaders:"bindRowsWithHeaders",cell:"cell",cells:"cells",checkedTemplate:"checkedTemplate",className:"className",colHeaders:"colHeaders",collapsibleColumns:"collapsibleColumns",columnHeaderHeight:"columnHeaderHeight",columns:"columns",columnSorting:"columnSorting",columnSummary:"columnSummary",colWidths:"colWidths",commentedCellClassName:"commentedCellClassName",comments:"comments",contextMenu:"contextMenu",copyable:"copyable",copyPaste:"copyPaste",correctFormat:"correctFormat",currentColClassName:"currentColClassName",currentHeaderClassName:"currentHeaderClassName",currentRowClassName:"currentRowClassName",customBorders:"customBorders",data:"data",dataDotNotation:"dataDotNotation",dataSchema:"dataSchema",dateFormat:"dateFormat",datePickerConfig:"datePickerConfig",defaultDate:"defaultDate",tabNavigation:"tabNavigation",disableVisualSelection:"disableVisualSelection",dragToScroll:"dragToScroll",dropdownMenu:"dropdownMenu",editor:"editor",enterBeginsEditing:"enterBeginsEditing",enterMoves:"enterMoves",fillHandle:"fillHandle",filter:"filter",filteringCaseSensitive:"filteringCaseSensitive",filters:"filters",fixedColumnsLeft:"fixedColumnsLeft",fixedColumnsStart:"fixedColumnsStart",fixedRowsBottom:"fixedRowsBottom",fixedRowsTop:"fixedRowsTop",formulas:"formulas",fragmentSelection:"fragmentSelection",headerClassName:"headerClassName",height:"height",hiddenColumns:"hiddenColumns",hiddenRows:"hiddenRows",invalidCellClassName:"invalidCellClassName",imeFastEdit:"imeFastEdit",label:"label",language:"language",layoutDirection:"layoutDirection",licenseKey:"licenseKey",locale:"locale",manualColumnFreeze:"manualColumnFreeze",manualColumnMove:"manualColumnMove",manualColumnResize:"manualColumnResize",manualRowMove:"manualRowMove",manualRowResize:"manualRowResize",maxCols:"maxCols",maxRows:"maxRows",mergeCells:"mergeCells",minCols:"minCols",minRows:"minRows",minSpareCols:"minSpareCols",minSpareRows:"minSpareRows",multiColumnSorting:"multiColumnSorting",navigableHeaders:"navigableHeaders",nestedHeaders:"nestedHeaders",nestedRows:"nestedRows",noWordWrapClassName:"noWordWrapClassName",numericFormat:"numericFormat",observeDOMVisibility:"observeDOMVisibility",outsideClickDeselects:"outsideClickDeselects",persistentState:"persistentState",placeholder:"placeholder",placeholderCellClassName:"placeholderCellClassName",preventOverflow:"preventOverflow",preventWheel:"preventWheel",readOnly:"readOnly",readOnlyCellClassName:"readOnlyCellClassName",renderAllColumns:"renderAllColumns",renderAllRows:"renderAllRows",renderer:"renderer",rowHeaders:"rowHeaders",rowHeaderWidth:"rowHeaderWidth",rowHeights:"rowHeights",search:"search",selectionMode:"selectionMode",selectOptions:"selectOptions",skipColumnOnPaste:"skipColumnOnPaste",skipRowOnPaste:"skipRowOnPaste",sortByRelevance:"sortByRelevance",source:"source",startCols:"startCols",startRows:"startRows",stretchH:"stretchH",strict:"strict",tableClassName:"tableClassName",tabMoves:"tabMoves",title:"title",trimDropdown:"trimDropdown",trimRows:"trimRows",trimWhitespace:"trimWhitespace",type:"type",uncheckedTemplate:"uncheckedTemplate",undo:"undo",validator:"validator",viewportColumnRenderingOffset:"viewportColumnRenderingOffset",viewportRowRenderingOffset:"viewportRowRenderingOffset",visibleRows:"visibleRows",width:"width",wordWrap:"wordWrap",afterAddChild:"afterAddChild",afterAutofill:"afterAutofill",afterBeginEditing:"afterBeginEditing",afterCellMetaReset:"afterCellMetaReset",afterChange:"afterChange",afterChangesObserved:"afterChangesObserved",afterColumnCollapse:"afterColumnCollapse",afterColumnExpand:"afterColumnExpand",afterColumnFreeze:"afterColumnFreeze",afterColumnMove:"afterColumnMove",afterColumnResize:"afterColumnResize",afterColumnSequenceChange:"afterColumnSequenceChange",afterColumnSort:"afterColumnSort",afterColumnUnfreeze:"afterColumnUnfreeze",afterContextMenuDefaultOptions:"afterContextMenuDefaultOptions",afterContextMenuHide:"afterContextMenuHide",afterContextMenuShow:"afterContextMenuShow",afterCopy:"afterCopy",afterCopyLimit:"afterCopyLimit",afterCreateCol:"afterCreateCol",afterCreateRow:"afterCreateRow",afterCut:"afterCut",afterDeselect:"afterDeselect",afterDestroy:"afterDestroy",afterDetachChild:"afterDetachChild",afterDocumentKeyDown:"afterDocumentKeyDown",afterDrawSelection:"afterDrawSelection",afterDropdownMenuDefaultOptions:"afterDropdownMenuDefaultOptions",afterDropdownMenuHide:"afterDropdownMenuHide",afterDropdownMenuShow:"afterDropdownMenuShow",afterFilter:"afterFilter",afterFormulasValuesUpdate:"afterFormulasValuesUpdate",afterGetCellMeta:"afterGetCellMeta",afterGetColHeader:"afterGetColHeader",afterGetColumnHeaderRenderers:"afterGetColumnHeaderRenderers",afterGetRowHeader:"afterGetRowHeader",afterGetRowHeaderRenderers:"afterGetRowHeaderRenderers",afterHideColumns:"afterHideColumns",afterHideRows:"afterHideRows",afterInit:"afterInit",afterLanguageChange:"afterLanguageChange",afterListen:"afterListen",afterLoadData:"afterLoadData",afterMergeCells:"afterMergeCells",afterModifyTransformEnd:"afterModifyTransformEnd",afterModifyTransformFocus:"afterModifyTransformFocus",afterModifyTransformStart:"afterModifyTransformStart",afterMomentumScroll:"afterMomentumScroll",afterNamedExpressionAdded:"afterNamedExpressionAdded",afterNamedExpressionRemoved:"afterNamedExpressionRemoved",afterOnCellContextMenu:"afterOnCellContextMenu",afterOnCellCornerDblClick:"afterOnCellCornerDblClick",afterOnCellCornerMouseDown:"afterOnCellCornerMouseDown",afterOnCellMouseDown:"afterOnCellMouseDown",afterOnCellMouseOut:"afterOnCellMouseOut",afterOnCellMouseOver:"afterOnCellMouseOver",afterOnCellMouseUp:"afterOnCellMouseUp",afterPaste:"afterPaste",afterPluginsInitialized:"afterPluginsInitialized",afterRedo:"afterRedo",afterRedoStackChange:"afterRedoStackChange",afterRefreshDimensions:"afterRefreshDimensions",afterRemoveCellMeta:"afterRemoveCellMeta",afterRemoveCol:"afterRemoveCol",afterRemoveRow:"afterRemoveRow",afterRender:"afterRender",afterRenderer:"afterRenderer",afterRowMove:"afterRowMove",afterRowResize:"afterRowResize",afterRowSequenceChange:"afterRowSequenceChange",afterScrollHorizontally:"afterScrollHorizontally",afterScrollVertically:"afterScrollVertically",afterScroll:"afterScroll",afterSelectColumns:"afterSelectColumns",afterSelection:"afterSelection",afterSelectionByProp:"afterSelectionByProp",afterSelectionEnd:"afterSelectionEnd",afterSelectionEndByProp:"afterSelectionEndByProp",afterSelectionFocusSet:"afterSelectionFocusSet",afterSelectRows:"afterSelectRows",afterSetCellMeta:"afterSetCellMeta",afterSetDataAtCell:"afterSetDataAtCell",afterSetDataAtRowProp:"afterSetDataAtRowProp",afterSetSourceDataAtCell:"afterSetSourceDataAtCell",afterSheetAdded:"afterSheetAdded",afterSheetRenamed:"afterSheetRenamed",afterSheetRemoved:"afterSheetRemoved",afterTrimRow:"afterTrimRow",afterUndo:"afterUndo",afterUndoStackChange:"afterUndoStackChange",afterUnhideColumns:"afterUnhideColumns",afterUnhideRows:"afterUnhideRows",afterUnlisten:"afterUnlisten",afterUnmergeCells:"afterUnmergeCells",afterUntrimRow:"afterUntrimRow",afterUpdateData:"afterUpdateData",afterUpdateSettings:"afterUpdateSettings",afterValidate:"afterValidate",afterViewportColumnCalculatorOverride:"afterViewportColumnCalculatorOverride",afterViewportRowCalculatorOverride:"afterViewportRowCalculatorOverride",afterViewRender:"afterViewRender",beforeAddChild:"beforeAddChild",beforeAutofill:"beforeAutofill",beforeBeginEditing:"beforeBeginEditing",beforeCellAlignment:"beforeCellAlignment",beforeChange:"beforeChange",beforeChangeRender:"beforeChangeRender",beforeColumnCollapse:"beforeColumnCollapse",beforeColumnExpand:"beforeColumnExpand",beforeColumnFreeze:"beforeColumnFreeze",beforeColumnMove:"beforeColumnMove",beforeColumnResize:"beforeColumnResize",beforeColumnSort:"beforeColumnSort",beforeColumnWrap:"beforeColumnWrap",beforeColumnUnfreeze:"beforeColumnUnfreeze",beforeContextMenuSetItems:"beforeContextMenuSetItems",beforeContextMenuShow:"beforeContextMenuShow",beforeCopy:"beforeCopy",beforeCreateCol:"beforeCreateCol",beforeCreateRow:"beforeCreateRow",beforeCut:"beforeCut",beforeDetachChild:"beforeDetachChild",beforeDrawBorders:"beforeDrawBorders",beforeDropdownMenuSetItems:"beforeDropdownMenuSetItems",beforeDropdownMenuShow:"beforeDropdownMenuShow",beforeFilter:"beforeFilter",beforeGetCellMeta:"beforeGetCellMeta",beforeHideColumns:"beforeHideColumns",beforeHideRows:"beforeHideRows",beforeHighlightingColumnHeader:"beforeHighlightingColumnHeader",beforeHighlightingRowHeader:"beforeHighlightingRowHeader",beforeInit:"beforeInit",beforeInitWalkontable:"beforeInitWalkontable",beforeKeyDown:"beforeKeyDown",beforeLanguageChange:"beforeLanguageChange",beforeLoadData:"beforeLoadData",beforeMergeCells:"beforeMergeCells",beforeOnCellContextMenu:"beforeOnCellContextMenu",beforeOnCellMouseDown:"beforeOnCellMouseDown",beforeOnCellMouseOut:"beforeOnCellMouseOut",beforeOnCellMouseOver:"beforeOnCellMouseOver",beforeOnCellMouseUp:"beforeOnCellMouseUp",beforePaste:"beforePaste",beforeRedo:"beforeRedo",beforeRedoStackChange:"beforeRedoStackChange",beforeRefreshDimensions:"beforeRefreshDimensions",beforeRemoveCellClassNames:"beforeRemoveCellClassNames",beforeRemoveCellMeta:"beforeRemoveCellMeta",beforeRemoveCol:"beforeRemoveCol",beforeRemoveRow:"beforeRemoveRow",beforeRender:"beforeRender",beforeRenderer:"beforeRenderer",beforeRowMove:"beforeRowMove",beforeRowResize:"beforeRowResize",beforeRowWrap:"beforeRowWrap",beforeSelectColumns:"beforeSelectColumns",beforeSelectionFocusSet:"beforeSelectionFocusSet",beforeSelectionHighlightSet:"beforeSelectionHighlightSet",beforeSelectRows:"beforeSelectRows",beforeSetCellMeta:"beforeSetCellMeta",beforeSetRangeEnd:"beforeSetRangeEnd",beforeSetRangeStart:"beforeSetRangeStart",beforeSetRangeStartOnly:"beforeSetRangeStartOnly",beforeStretchingColumnWidth:"beforeStretchingColumnWidth",beforeTouchScroll:"beforeTouchScroll",beforeTrimRow:"beforeTrimRow",beforeUndo:"beforeUndo",beforeUndoStackChange:"beforeUndoStackChange",beforeUnhideColumns:"beforeUnhideColumns",beforeUnhideRows:"beforeUnhideRows",beforeUnmergeCells:"beforeUnmergeCells",beforeUntrimRow:"beforeUntrimRow",beforeUpdateData:"beforeUpdateData",beforeValidate:"beforeValidate",beforeValueRender:"beforeValueRender",beforeViewportScroll:"beforeViewportScroll",beforeViewportScrollHorizontally:"beforeViewportScrollHorizontally",beforeViewportScrollVertically:"beforeViewportScrollVertically",beforeViewRender:"beforeViewRender",construct:"construct",init:"init",modifyAutoColumnSizeSeed:"modifyAutoColumnSizeSeed",modifyAutofillRange:"modifyAutofillRange",modifyColHeader:"modifyColHeader",modifyColumnHeaderHeight:"modifyColumnHeaderHeight",modifyColumnHeaderValue:"modifyColumnHeaderValue",modifyColWidth:"modifyColWidth",modifyCopyableRange:"modifyCopyableRange",modifyFiltersMultiSelectValue:"modifyFiltersMultiSelectValue",modifyFocusedElement:"modifyFocusedElement",modifyData:"modifyData",modifyFocusOnTabNavigation:"modifyFocusOnTabNavigation",modifyGetCellCoords:"modifyGetCellCoords",modifyRowData:"modifyRowData",modifyRowHeader:"modifyRowHeader",modifyRowHeaderWidth:"modifyRowHeaderWidth",modifyRowHeight:"modifyRowHeight",modifyRowHeightByOverlayName:"modifyRowHeightByOverlayName",modifySourceData:"modifySourceData",modifyTransformEnd:"modifyTransformEnd",modifyTransformFocus:"modifyTransformFocus",modifyTransformStart:"modifyTransformStart",persistentStateLoad:"persistentStateLoad",persistentStateReset:"persistentStateReset",persistentStateSave:"persistentStateSave"},features:[Ho([mw,A_]),ri],decls:2,vars:1,consts:[["container",""],[3,"id"]],template:function(o,n){o&1&&zt(0,"div",1,0),o&2&&Le("id",n.hotId)},encapsulation:2})}return r})();var P_=(()=>{class r{static version="14.6.0";static forRoot(){return{ngModule:r,providers:[mw]}}static \u0275fac=function(o){return new(o||r)};static \u0275mod=Oi({type:r});static \u0275inj=Ei({})}return r})();var qB=["hotTableRef"],pw=(r,e)=>e.name;function GB(r,e){r&1&&(ce(0,"p"),lt(1,"Formulario no encontrado"),we())}function $B(r,e){if(r&1){let t=ii();ce(0,"textarea",11),Nr("input",function(n){wr(t);let i=Ve(2);return br(i.valueChangedStates(n))})("input",function(n){wr(t);let i=Ve(2);return br(i.setSelect(n))}),lt(1,"    "),we(),ce(2,"mat-hint",12),lt(3,"Debe ingresar los datos separados por comas (,)"),we()}if(r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)("value",t.value)}}function KB(r,e){if(r&1&&(zt(0,"input",13),ce(1,"mat-hint",12),lt(2),we()),r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)("value",t.value),Ee(2),Hi(t.hint)}}function XB(r,e){if(r&1&&(zt(0,"input",13),ce(1,"ul")(2,"li")(3,"mat-hint",12),lt(4," - Debe ingresar los datos separados por comas (,)"),we()(),ce(5,"li")(6,"mat-hint",12),lt(7," - Q0 no cuenta como estado final"),we()()()),r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)("value",t.value)}}function QB(r,e){if(r&1){let t=ii();ce(0,"textarea",14),Nr("input",function(n){wr(t);let i=Ve(2);return br(i.valueChangedAlphabet(n))}),we(),ce(1,"mat-hint",12),lt(2,"Debe ingresar los datos separados por comas (,)"),we()}if(r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)}}function ZB(r,e){if(r&1&&(zt(0,"textarea",15),ce(1,"ol")(2,"li")(3,"mat-hint",12),lt(4),we()(),ce(5,"li")(6,"mat-hint",12),lt(7),we()(),ce(8,"li")(9,"mat-hint",12),lt(10),we()()()),r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1),Ee(4),Hi(t.hint[0]),Ee(3),Hi(t.hint[1]),Ee(3),Hi(t.hint[2])}}function JB(r,e){if(r&1){let t=ii();ce(0,"textarea",16),Nr("input",function(n){wr(t);let i=Ve(2);return br(i.onInputTextTape(n))}),we()}if(r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)("value",t.value)}}function eU(r,e){if(r&1&&zt(0,"input",8),r&2){let t=Ve().$implicit;Ii("title",t.title),Le("formControlName",t.name)("placeholder",t.placeholder)("readonly",t.readOnly||!1)("min",t.min)("max",t.max)("step",t.step||1)}}function tU(r,e){if(r&1&&(ce(0,"option",17),lt(1),we()),r&2){let t=e.$implicit;Le("value",t),Ee(),cs(" ",t," ")}}function rU(r,e){if(r&1&&(ce(0,"select",9),Ca(1,tU,2,2,"option",17,tb),we()),r&2){let t=Ve().$implicit,o=Ve();Le("formControlName",t.name),Ee(),va(o.optionState)}}function oU(r,e){if(r&1&&(ce(0,"li")(1,"mat-checkbox",19),lt(2),we()()),r&2){let t=e.$implicit;Ee(),Le("formControlName",t.name),Ee(),cs(" ",t.label," ")}}function iU(r,e){if(r&1&&(ce(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),lt(3),ce(4,"mat-icon"),lt(5,"check_box"),we()()(),ce(6,"div",18)(7,"ol"),Ca(8,oU,3,2,"li",null,pw),we()()()),r&2){let t=Ve(2).$implicit,o=Ve();Ee(3),cs("",t.name," "),Ee(3),Le("formGroupName",t.name),Ee(2),va(o.optionState)}}function nU(r,e){if(r&1&&oi(0,iU,10,2,"mat-expansion-panel"),r&2){let t=Ve().$implicit,o=Ve();Mi(o.form.get(t.name)?0:-1)}}function sU(r,e){if(r&1&&(ce(0,"li")(1,"mat-checkbox",20)(2,"i",21),lt(3),we()()()),r&2){let t=e.$implicit;Ee(),Le("formControlName",t.name)("title",t.label),Ee(2),Hi(t.label)}}function aU(r,e){if(r&1&&(ce(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),lt(3),ce(4,"mat-icon"),lt(5,"check_box"),we()()(),ce(6,"div",18)(7,"ol"),Ca(8,sU,4,3,"li",null,pw),we()()()),r&2){let t=Ve(2).$implicit;Ee(3),cs("",t.name," "),Ee(3),Le("formGroupName",t.name),Ee(2),va(t.checkboxes)}}function lU(r,e){if(r&1&&oi(0,aU,10,2,"mat-expansion-panel"),r&2){let t=Ve().$implicit,o=Ve();Mi(o.form.get(t.name)?0:-1)}}function cU(r,e){if(r&1){let t=ii();ce(0,"div",10)(1,"form",22),Nr("submit",function(n){wr(t);let i=Ve(2);return br(i.onTableChange(n))}),zt(2,"hot-table",23,0),we()()}if(r&2){let t=Ve(2);Ee(2),Le("settings",t.settings)("hotId","my-handsontable")("data",t.generateData())("rowHeaders",t.customRowHeaders)("colHeaders",t.customColumnHeaders)}}function uU(r,e){if(r&1&&(ce(0,"mat-error"),lt(1),we()),r&2){let t=Ve().$implicit,o=Ve();Ee(),Hi(o.getErrorMessage(t.name))}}function dU(r,e){if(r&1&&(ce(0,"label",6),lt(1),we(),oi(2,$B,4,5)(3,KB,3,6)(4,XB,8,5)(5,QB,3,4)(6,ZB,11,7)(7,JB,1,5,"textarea",7)(8,eU,1,7,"input",8)(9,rU,3,1,"select",9)(10,nU,1,1)(11,lU,1,1)(12,cU,4,5,"div",10),zt(13,"hr"),oi(14,uU,2,1,"mat-error")),r&2){let t,o,n=e.$implicit,i=Ve();Le("for",n.name),Ee(),Hi(n.label),Ee(),Mi((t=n.type)==="textarea"?2:t==="text"?3:t==="text-finals"?4:t==="text-alphabet"?5:t==="text-transitions"?6:t==="text-tape"?7:t==="number"?8:t==="select"?9:t==="checkboxes"?10:t==="checkboxList"?11:t==="table"?12:-1),Ee(12),Mi((o=i.form.get(n.name))!=null&&o.invalid&&((o=i.form.get(n.name))!=null&&o.dirty||(o=i.form.get(n.name))!=null&&o.touched)?14:-1)}}function hU(r,e){r&1&&(ce(0,"p"),lt(1,"Sin campos"),we())}var D_=class r{turingMachineService=kh(Dh);form=new bb({});submit_text;formName;formSubmit=new Tr;value=new Tr;formConfig;estados=[];entradas=[];tableData;optionState=[];hotTableRef;TRANSICIONES=[];MAQUINA_TURING={datos:{Estados:"","Estados Finales":"","Alfabeto de Entrada":"","Alfabeto Cinta":"",Transiciones:""},transiciones:this.TRANSICIONES};fb=kh(Fh);ngOnInit(){this.formConfig=Uh.find(e=>e.formName===this.formName),this.formConfig||(this.formConfig=Uh[0]),this.initializeForm()}ngAfterViewInit(){this.updateHotTableSettings()}ngOnChanges(e){(e.estados||e.entradas)&&this.updateHotTableSettings()}updateHotTableSettings(){if(this.hotTableRef){let e=je(pe({},this.settings),{data:this.generateData(),rowHeaders:this.customRowHeaders,colHeaders:this.customColumnHeaders});this.hotTableRef.updateHotTable(e)}}valueChangedStates(e){let t=e.target.value;this.estados=t.split(","),this.updateHotTableSettings()}valueChangedAlphabet(e){let t=e.target.value;this.entradas=t.split(","),this.updateHotTableSettings()}onInputTextTape(e){let t=e.target.value;this.MAQUINA_TURING.datos["Alfabeto Cinta"]=t,console.log(this.MAQUINA_TURING.datos["Alfabeto Cinta"])}onSubmit(){if(this.form.valid){let e=pe({},this.form.value);e["Estados Finales"]&&(e["Estados Finales"]=Object.keys(e["Estados Finales"]).filter(a=>e["Estados Finales"][a]).join(",")),this.MAQUINA_TURING.datos=e;let t=localStorage.getItem("turingMachines"),o=t?JSON.parse(t):[],i={id:o.length+1,estados:this.MAQUINA_TURING.datos.Estados,estadosFinales:this.MAQUINA_TURING.datos["Estados Finales"],alfabetoEntrada:this.MAQUINA_TURING.datos["Alfabeto de Entrada"],alfabetoCinta:this.MAQUINA_TURING.datos["Alfabeto Cinta"],transiciones:this.MAQUINA_TURING.datos.Transiciones};console.log(i),o.push(i),localStorage.setItem("turingMachines",JSON.stringify(o)),this.submitTuringMachine(this.MAQUINA_TURING.datos)}else console.error("Formulario inv\xE1lido"),Object.keys(this.form.controls).forEach(e=>{let t=this.form.get(e);t?.invalid&&t.markAsTouched()})}submitTuringMachine(e){return zw(this,null,function*(){let t={estados:e.Estados,estadosFinales:e["Estados Finales"],alfabetoCinta:e["Alfabeto Cinta"],alfabetoEntrada:e["Alfabeto de Entrada"],transiciones:e.Transiciones};console.log(e.Transiciones);let o=yield this.turingMachineService.createTuringMachine(t).subscribe({next:n=>{console.log("Maquina de turing creada exitosamente!",n)},error:n=>{console.error("Error al crear la Maquina de Turing:",n)}})})}submitTransitions(e,t){let o=e.map(n=>(t&&(n.idDatosAutomata=t),n));localStorage.setItem("transitions",JSON.stringify(o)),console.log("Transiciones almacenadas en localStorage:",o)}initializeForm(){let e={};this.formConfig.fields.forEach(t=>{let o=this.getValidators(t);if(t.name==="Alfabeto de la Cinta")e[t.name]=new si("",this.getValidators(t));else if(t.name==="Estados")e[t.name]=new si({value:"q0",disabled:!1});else if(t.name==="Estado Inicial Q0")e[t.name]=new si({value:"q0",disabled:!0});else if(t.name==="Simbolo Blanco")e[t.name]=new si({value:"null",disabled:!0});else if(t.name==="Estados Finales"){let n=this.fb.group({});this.optionState.forEach(i=>{n.addControl(i.name,new si(i.value))}),e[t.name]=n}else if(t.type==="checkboxList"){let n=this.fb.group({});t.checkboxes.forEach(i=>{n.addControl(i.name,new si(i.value))}),e[t.name]=n}else e[t.name]=new si("",o)}),this.form=this.fb.group(e)}setSelect(e){let t=e.target.value.split(",");this.optionState=t.map(n=>({name:n,label:n,value:!1}));let o=this.form.get("Estados Finales");o&&(Object.keys(o.controls).forEach(n=>{this.optionState.some(i=>i.name===n)||o.removeControl(n)}),this.optionState.forEach(n=>{o.contains(n.name)||o.addControl(n.name,new si(!1))}))}getValidators(e){let t=[];return e.required&&t.push(us.required),e.min!==void 0&&t.push(us.min(e.min)),e.max!==void 0&&t.push(us.max(e.max)),e.pattern&&t.push(us.pattern(e.pattern)),t}getErrorMessage(e){let t=this.form.get(e);if(t?.errors){if(t.errors.required)return"Este campo es requerido";if(t.errors.min)return`El valor m\xEDnimo es ${t.errors.min.min}`;if(t.errors.max)return`El valor m\xE1ximo es ${t.errors.max.max}`;if(t.errors.pattern)return"El formato no es v\xE1lido"}return""}customRowHeaders=e=>this.entradas[e]||e+1;customColumnHeaders=e=>this.estados[e]||e+1;generateData=(e=this.entradas.length,t=this.estados.length)=>[...new Array(e)].map(n=>[...new Array(t)].map(i=>null));onTableChange=e=>{e.preventDefault(),this.tableData=this.hotTableRef.data,this.TRANSICIONES=this.tableData.flatMap((t,o)=>t.map((n,i)=>n?{nuevoEstado:n.nuevoEstado||"",nuevoSimbolo:n.nuevoSimbolo||"",movimiento:n.movimiento||""}:null).filter(n=>n!==null)),console.log("Transiciones:",this.TRANSICIONES)};settings={height:"auto",contextMenu:!0,manualRowMove:!0,bindRowsWithHeaders:"strict",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",colHeaders:this.customColumnHeaders};static \u0275fac=function(t){return new(t||r)};static \u0275cmp=ti({type:r,selectors:[["app-dynamic-form"]],viewQuery:function(t,o){if(t&1&&Io(qB,5),t&2){let n;so(n=ao())&&(o.hotTableRef=n.first)}},inputs:{submit_text:"submit_text",formName:"formName"},outputs:{formSubmit:"formSubmit",value:"value"},standalone:!0,features:[Ho([Fh,us,Dh]),ri,mn],decls:11,vars:5,consts:[["hotTableRef",""],[1,"flex","w-[50rem]"],[1,"w-full",3,"ngSubmit","formGroup"],["src","img_turing.jpg","alt","imagen de referencia turing"],[1,"flex","justify-end"],["type","submit",1,"mt-4","align-middle",3,"disabled"],[1,"mt-2",3,"for"],["type","textarea",3,"formControlName","placeholder","readonly","title","value"],["type","number",3,"formControlName","placeholder","readonly","title","min","max","step"],["title","field.title",3,"formControlName"],[1,""],[3,"input","formControlName","placeholder","readonly","title","value"],[1,"txt-hint"],["type","text",3,"formControlName","placeholder","readonly","title","value"],["type","textarea",3,"input","formControlName","placeholder","readonly","title"],["type","textarea",3,"formControlName","placeholder","readonly","title"],["type","textarea",3,"input","formControlName","placeholder","readonly","title","value"],[3,"value"],[3,"formGroupName"],[3,"formControlName"],[1,"",3,"formControlName","title"],[1,"text-neutral-400"],[3,"submit"],[3,"settings","hotId","data","rowHeaders","colHeaders"]],template:function(t,o){t&1&&(ce(0,"section",1)(1,"form",2),Nr("ngSubmit",function(){return o.onSubmit()}),ce(2,"picture"),zt(3,"img",3),we(),oi(4,GB,2,0,"p"),Ca(5,dU,15,4,null,null,pw,!1,hU,2,0,"p"),ce(8,"div",4)(9,"button",5),lt(10),we()()()()),t&2&&(Ee(),Le("formGroup",o.form),Ee(3),Mi(o.formConfig=="404Form"?4:-1),Ee(),va(o.formConfig.fields),Ee(4),Le("disabled",!o.form.valid),Ee(),cs(" ",o.submit_text," "))},dependencies:[Ib,vb,Eb,_b,mb,yb,xb,gb,wb,Mb,Ob,Cb,Hb,Sb,Tb,Rb,Bb,_c,Jb,zh,Qb,Zb,hb,db,kb,Nb,Ab,P_,k_,sb,Pb,ab],styles:["form[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:8px;padding:20px;box-shadow:0 2px 4px #0000001a;font-family:Victor Mono;transition:background-color .3s ease}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#495057;font-weight:700}form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:1rem;border:1px solid #ced4da;border-radius:8px;transition:border-color .3s ease,background-color .3s ease}form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 5px #007bff80;background-color:#fff}form[_ngcontent-%COMP%]   .txt-hint[_ngcontent-%COMP%]{font-size:.8rem;color:#6c757d}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#000;color:#fff;border:none;border-radius:8px;padding:10px 15px;cursor:pointer;font-size:16px;transition:background-color .3s ease,color .3s ease}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#333}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:active{background-color:#000;cursor:not-allowed}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#646262}form[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{color:#f44336;font-size:1rem;margin-top:4px}"]})};export{D_ as a};
